window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.Gimme=function(){var n=function(){function n(n){Array.prototype.push.apply(this,n)}function t(i,r){var u=!i&&[]||(r||typeof i=="string")&&t.query(i,r)||i instanceof Array&&i||[i];return new n(u)}function i(n,t){var i;for(i in t)t.hasOwnProperty(i)&&(n.prototype[i]=t[i])}return i(n,{length:Array.prototype.length,entities:function(){return Array.prototype.slice.apply(this)},sort:function(n){return Array.prototype.sort.call(this,n),this},reverse:function(){return Array.prototype.reverse.call(this),this},push:function(){return Array.prototype.push.apply(this,arguments),this},pop:function(){var t=Array.prototype.pop.call(this);return new n([t])},shift:function(){var t=Array.prototype.shift.call(this);return new n([t])},unshift:function(){return Array.prototype.unshift.apply(this,arguments),this},slice:function(){return new n(Array.prototype.slice.apply(this,arguments))},splice:function(){return new n(Array.prototype.splice.apply(this,arguments))},concat:function(t){return new n(Array.prototype.concat.apply(this.entities(),t.entities&&t.entities()||arguments))}}),t.Helper={get_guid:function(){var n=0;return function(t){if(!t)return"";if(t===window)return"win";if(t===document)return"doc";if(t.uniqueID)return t.uniqueID;var i="__$gimme$_guid__";return typeof t[i]=="undefined"&&(t[i]=i+n++),t[i]}}()},t.Browser=function(){var n=navigator.userAgent.toLowerCase();return{is_ie:typeof ActiveXObject!="undefined",is_opera:typeof window.opera!="undefined",is_khtml:n.indexOf("khtml")!==-1,is_gecko:n.indexOf("khtml")===-1&&n.indexOf("gecko")!==-1,is_in_quirks_mode:document.compatMode==="BackCompat"}}(),t.undefined={}._$gimme$_undefined,t.ext=n.prototype,t}();return n.ext.select=function(t){return n(t,this[0])},typeof g=="undefined"&&(window.g=n),n.Internals=new function(){function n(n){return function(t,i,r){this[n](t,i,r)}}return{addEventListener:n("addEventListener"),removeEventListener:n("removeEventListener"),attachEvent:n("attachEvent"),detachEvent:n("detachEvent"),parseJSON:function(n){return JSON.parse(n)}}},n.query=function(){return function(){function d(n,t,i){return u[t](n,i)}function k(n,t){var r=[],u=t.length,i;do i=p(n,t[--u]||t),i&&r.push(i);while(u);return r}function p(n,t){if(n===document||!t)return t;var i=t;while((i=i.parentNode)&&i!==n);return i===n&&t||null}function g(n,t){return p(n,document.getElementById(t))}function w(n,t){var u,f,i,e;t=t||document;if(n.id)return o([g(t,n.id)],n);delete n.id,u=t.getElementsByTagName(n.tag||"*");if((!n.classes||n.classes.length<1)&&(!n.attributes||n.attributes.length<1)&&(!n.pseudos||n.pseudos.length<1))return a(u);for(f=[],e=u.length,i=0;i<e;i++)r(n,u[i])&&f.push(u[i]);return f}function r(n,t){if(!t)return!1;for(var r=n.propNames,f=r.length,i=0;i<f;i++)if(!u[r[i]](t,n[r[i]]))return!1;return!0}function a(n){for(var i=[],r=n.length,t=0;t<r;t++)i[t]=n[t];return i}function o(n,t){for(var u=[],f=n.length,i=0;i<f;i++)n[i]&&n[i].nodeType===1&&r(t,n[i])&&u.push(n[i]);return u}function l(n,t){return h(n,t)!==-1}function c(n){var r;i.inc();for(var f=i.name,u=[],e=n.length,t=0;t<e;t++)r=n[t],r[f]!==i.t&&(r[f]=i.t,u.push(r));return u}function e(n){this.name=n,this.f=0,this.t=1,this.inc=function(){this.f=(this.t+=2)-1}}function b(n){this.parse=function(t){var f,i,e,o=n.preprocessInput,r,u;t=o&&o(t)||t,n.reset(),r=0,u=t.length;while(r<u){f=t.charAt(r),i=i||n[f]||n["default"];if(i){e=i(t.substring(r,u));if(!e)throw'No valid match found for "'+i.name+'" rule';r+=e}else throw'No suitable rule found to handle character "'+f+'"';i=null}return n.finish()}}function s(t,i){var b=i,e,r,h,o,c,l,s;i=i||document,n.inc();if(typeof t!="string")return k(i||document,t);r=[];try{r=a(i.querySelectorAll(t))}catch(p){for(h=y.parse(t),c=h.length,o=0;o<c;o++){var u=h[o],v=u.length,f=v%2-1;e=f===0?w(u[f],i):[i||document];while(u[++f])l=u[f++],s=u[f],s.root=i,e=d(e,l,s);r=c>1?r.concat(e):e}}return r}var i,t,n,u,v,y,h=function(){function t(n,t){return n.indexOf(t)}function n(n,t){for(var r=n.length,i=0;i<r;i++)if(n[i]===t)return i;return-1}return typeof Array.prototype.indexOf!="undefined"?t:n}(),f=function(){function t(n,t){return n.getAttribute(t)}function n(n,t){switch(t.toLowerCase()){case"class":return n.className||null;case"id":return n.id||null;case"href":case"src":if(typeof n.getAttribute!="undefined")return n.getAttribute(t,2)}return n.attributes&&n.attributes[t]&&n.attributes[t].nodeValue||n.getAttribute(t)}return function(){var r=document.createElement("div"),i;return r.innerHTML='<a href="#test">test</a>',i=r.firstChild,i.getAttribute("href")==="#test"?t:n}()}();return i=new e("__$gimme$_unique__"),t=new e("__$gimme$_genSib__"),n=new e("__$gimme$_nth__"),u={id:function(n,t){return n.id===t},tag:function(n,t){return n.tagName===t||t==="*"},classes:function(n,t){var i=n.className,u,r;typeof i!="string"&&(i=f(n,"class"));if(!i)return!1;u=" "+i+" ",r=t.length;while(r--)if(u.indexOf(" "+t[r]+" ")===-1)return!1;return!0},attributes:function(){var t={},n={parse:function(n){var i=n.match(/^\[([\w-_]+)?(\=|\^=|\$=|\*=|\|=|~=|!=)?(.*)\]$/);return t[n]={name:i&&i[1],delim:i&&i[2],val:i&&i[3].replace(/^['"]|["']$/g,"")}},"=":function(n,t){return n===t},"^=":function(n,t){return n.indexOf(t)===0},"$=":function(n,t){var i=n.lastIndexOf(t);return i!==-1&&i+t.length===n.length},"*=":function(n,t){return n.indexOf(t)!==-1},"|=":function(n,t){return n===t||n.indexOf(t+"-")===0},"~=":function(n,t){return n===t||l(n.split(" "),t)},"!=":function(n,t){return n!==t},unknown:function(){return!1}};return function(i,r){var o=r.length,u,e;while(o--){u=t[r[o]]||n.parse(r[o]),e=f(i,u.name);if(!e)return!1;if(!u.delim)continue;if(!n[u.delim||"unknown"](e,u.val))return!1}return!0}}(),pseudos:function(){function i(n){var t=n+"Sibling";return function(n){var i=n[t];while(i&&i.nodeType!==1)i=i[t];return!i}}var r={},t={parse:function(n){var t=n.match(/([\w-_]+)\b(\((((-?\d*)n)?([+-]?\d+)?|.*)\))?/),i={name:t&&t[1],param:{wholeValue:t&&t[3],a:t&&t[5]||0,b:t&&t[6]||0}};return i.param.wholeValue==="even"?(i.param.a=2,i.param.b=0):i.param.wholeValue==="odd"&&(i.param.a=2,i.param.b=1),r[n]=i},"first-child":i("previous"),"last-child":i("next"),"only-child":function(n){return t["first-child"](n)&&t["last-child"](n)},"nth-child":function(t,i){var l=1e4,s=n.t*l,u=n.name,r=t.parentNode,h=0,f;if(r){if(r[u+":parent"]!==n.t){r[u+":parent"]=n.t;var h=0,a,e=r.children||r.childNodes,o=-1,c=e.length;while(++o<c)e[o].nodeType===1&&(h++,e[o][u]=s+h)}return f=t[u]-s-i.param.b,!i.param.a&&i.param.b?f===0:i.param.a*f>=0&&f%(i.param.a||1)==0}return!1},contains:function(n,t){return(n.textContent||n.innerText||n.innerHTML).indexOf(t.param.wholeValue)!==-1},not:function(){return!1}};return function(n,i){var f=i.length,u;while(f--){u=r[i[f]]||t.parse(i[f]);if(!t[u.name](n,u))return!1}return!0}}()," ":function(n,t){for(var u=[],f=n.length,r,i=0;i<f;i++){r=w(t,n[i]),u=u.concat(r);if(t.id&&r.length===1)break}return c(u)},">":function(n,t){for(var r=[],u=n.length,i=0;i<u;i++)r=r.concat(o(n[i].childNodes,t));return r},"+":function(n,t){for(var e=[],o=n.length,f,i,u=0;u<o;u++){f=n[u],i=f.nextSibling;while(i&&i.nodeType!==1)i=i.nextSibling;r(t,i)&&e.push(i)}return e},"~":function(n,i){var e,u;t.inc();for(var s=t.name,o=[],h=n.length,f=0;f<h;f++){e=n[f],u=e.nextSibling;while(u&&u[s]!==t.t)u.nodeType===1&&(u[s]=t.t,r(i,u)&&o.push(u)),u=u.nextSibling}return o}},v=new function(){function i(){this.propNames=[]}var r,t,n,u;return i.prototype.propNames=[],i.prototype.storePropertyValue=function(n,t){this[n]=t,this.propNames[n]||(this.propNames.push(n),this.propNames[n]=!0)},i.prototype.storeArrayValue=function(n,t){this[n]||(this[n]=[]),this[n].push(t),this.propNames[n]||(this.propNames.push(n),this.propNames[n]=!0)},u={preprocessInput:function(n){return n.replace(/\s*([ >+~,])\s*/g,"$1")},reset:function(){r=[],t=[],n=new i},finish:function(){return n&&n.propNames.length>0&&t.push(n),t.length>0&&r.push(t),r},"default":function(t){var u="tag",r=t.match(/(\w+|\*)/),i;return r?(i=r[0].toUpperCase(),n.storePropertyValue(u,i),i.length):null},"#":function(t){var u="id",i=t.match(/#([_\-\w]+)/),r;return i?(r=i[1],n.storePropertyValue(u,r),i[0].length):null},".":function(t){var u="classes",i=t.match(/\.([_\-\w\d]+)/),r;if(i)return r=i[1],n.storeArrayValue(u,r),i[0].length},"[":function(t){var u="attributes",r=t.match(/(\[.*"\]|.*?\])/),i;return r?(i=r[0],n.storeArrayValue(u,i),i.length):null},":":function(t){var u="pseudos",r=t.match(/:[\w-_]+\b(\(.*\))?/),i;return r?(i=r[0],n.storeArrayValue(u,i),i.length):null}," ":function(){return t.push(n," "),n=new i,1},">":function(){return n.propNames.length>0&&t.push(n),t.push(">"),n=new i,1},"~":function(){return t.push(n,"~"),n=new i,1},"+":function(){return t.push(n,"+"),n=new i,1},",":function(){return t.push(n),r.push(t),t=[],n=new i,1}}},y=new b(v),s.Internal={unique:c,index_of:h,contains:l,has_class:u.classes,get_attr:f},s}()}(),n.Helper.index_of=n.query.Internal.index_of,n.Helper.contains=n.query.Internal.contains,n.Helper.unique=n.query.Internal.unique,n.Helper.has_class=n.query.Internal.has_class,n.Helper.get_attr=n.query.Internal.get_attr,n.Effects={Animation:function(n){function s(n){var h=e(n),o=t.length,r,s;while(o--){s={};for(r in u)s[r]=i[r][o]+u[r][o]*h;f(t[o],s,n)}}var t=n.elements||[],o=n.duration||1,i=n.from||{},r=n.to||{},u={},f,e;(function(){var f,n,h,e={},o={},s={};for(n in i){e[n]=[],o[n]=[],s[n]=[],f=t.length;while(f--)h=t[f],e[n][f]=typeof i[n]=="function"?i[n](h,n):i[n],o[n][f]=typeof r[n]=="function"?r[n](h,n):r[n],s[n][f]=o[n][f]-e[n][f]}i=e,r=o,u=s})(),f=n.animate,e=n.easing||function(n){return n},this.startTime=n.startTime||0,this.duration=o,this.add_element=function(n){t.push(n)},this.remove_element=function(n){var i=t.length;while(i--)if(t[i]===n){t.splice(i,1);break}},this.tick=s},Storyboard:function(n){function r(){f||(f=!0,e=+new Date,l=setInterval(b,1))}function nt(){t=0,i=1,r()}function w(){s(),a&&a(t)}function s(){clearInterval(l),f=!1}function g(){r()}function d(){i=1,r()}function rt(){i=-1,r()}function it(){i*=-1,r()}function tt(n){t=n,h()}function p(){return f}function y(){return i}function v(){return u}function k(){return o}function b(){var n=+new Date;t+=(n-e)/o*i,e=n,t=t<0?0:t>1?1:t,h(),(i===-1&&t===0||i===1&&t===1)&&(s(),c&&c(t))}function h(){var r=u.length,n;while(r--)n=(o*t-u[r].startTime)/u[r].duration,n=i===-1&&n<0?0:i===1&&n>1?1:n,n<0||n>1||u[r].tick(n)}var l,e,t=0,i=1,f=!1,u=n.animations,o=n.duration||0,c=n.completed,a=n.aborted;this.begin=nt,this.abort=w,this.pause=s,this.resume=g,this.forward=d,this.backward=rt,this.reverse=it,this.seek=tt,this.is_running=p,this.get_direction=y,this.get_animations=v,this.get_duration=k},Easing:{Back:new function(){function i(n,t,i,r){return t=.5,i=0,r=.5,Math.pow(1-n,i)*r*Math.sin(2*Math.PI*n*t)*-1+n}function t(){}function n(){}this.ease_in=i,this.ease_out=t,this.ease_in_out=n},Bounce:new function(){function r(n,t,i){return t=t||1.5,i=i||4,Math.abs(Math.pow(n,t)*Math.cos(Math.PI*n*i))}function i(t,i,r){return 1-n.Effects.Easing.Bounce.ease_in(1-t,i,r)}function t(t,i,r){var e=1,f=0,u=n.Effects.Easing.Bounce.ease_in;return t>.5&&(u=n.Effects.Easing.Bounce.ease_out,t-=.5,f=e/2),u(t,i,r)-f}this.ease_in=r,this.ease_out=i,this.ease_in_out=t},Elastic:new function(){function i(){}function t(n,t,i){return t=t||3.5,i=i||5,1-Math.pow(1-n,t)*Math.cos(2*Math.PI*n*i)}function n(){}this.ease_in=i,this.ease_out=t,this.ease_in_out=n},Exponential:new function(){function t(n,t){return Math.pow(n,t)}function n(n,t){return Math.pow(n,1/t)}function i(i,r){return i<=.5?t(i*2,r)*.5:n((i-.5)*2,r)*.5+.5}this.ease_in=t,this.ease_out=n,this.ease_in_out=i}},Enums:{Directions:{vertically:1,horizontally:2,both:3},Speeds:{quickly:500,slowly:1e3}},RunningAnimations:function(){var t={};return{add:function(n,i){t[n]=i},remove:function(n){delete t[n]},get:function(i){return t[i]||new n.Effects.Storyboard({animations:[]})},contains:function(n){return!!t[n]}}}()},n.Effects.Storyboard.create=function(t,i,r,u,f,e,o,s){f=Math.floor(f)||n.Effects.Enums.Speeds[f]||n.Effects.Enums.Speeds.quickly;var h=new n.Effects.Storyboard({duration:f,completed:function(){o&&o.call(this),n.Effects.RunningAnimations.remove(e),h=null},aborted:function(){n.Effects.RunningAnimations.remove(e),h=null},animations:[new n.Effects.Animation({from:i,to:r,duration:f,animate:u,easing:s,elements:t})]});return e&&n.Effects.RunningAnimations.add(e,h),h},function(){var t=0,i={};n.Effects.Animation.requestAnimationFrame=function(){function r(n,t){return function(){i[t]&&n(+new Date),delete i[t]}}function e(n,f){var e=i[++t]=r(n,t);return u(e,f),t}function f(u){var f=i[++t]=r(u,t);return n.setTimeout(f,o),t}var o=16,n=window,u=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame;return u?e:f}(),n.Effects.Animation.cancelAnimationFrame=function(n){delete i[n]}}(),n.Ajax=new function(){function i(n,i){t(n,i,!0)}function u(n,i){t(n,i,!1)}function r(){if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){throw new Error("Error invoking XMLHTTP");}else throw new Error("XMLHttp is not supported");}function t(t,i,u){var f=r();f.onreadystatechange=function(){if(f.readyState===4){var t=f.responseText;u&&t&&(t=n.Internals.parseJSON(t)),i.call(f,t,f.status),f=null,i=null}},f.open("GET",t,!0),f.send("")}this.request_json=i,this.request_ahah=u},n.Screen=new function(){function r(){var n={width:0,height:0};return n=typeof window.innerWidth!="undefined"?{width:window.innerWidth,height:window.innerHeight}:typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0?{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}:{width:document.getElementsByTagName("body")[0].clientWidth,height:document.getElementsByTagName("body")[0].clientHeight}}function i(n){var t,i;return n=n||window.event,t={x:0,y:0},typeof n.pageX!="undefined"?(t.x=n.pageX,t.y=n.pageY):(i=this.get_scroll_pos(),t.x=n.clientX+i.x,t.y=n.clientY+i.y),t}function t(){return n(window).get_scroll_pos()}this.get_viewport_size=r,this.get_mouse_pos=i,this.get_scroll_pos=t},n.Util=new function(){function t(){return n(arguments,!1)}function i(){return n(arguments,!0)}function n(n,t){function i(){u.apply(this,Array.prototype.slice.call(n,2)),t||(u=null)}var u=n[0],r=n[1];return t===!0?window.setInterval(i,r):window.setTimeout(i,r)}this.set_timeout=t,this.set_interval=i},n.Style=new function(){function o(i){var f=i.scrollTop&&i!==document.documentElement&&i!==document.body&&i.tagName!=="TEXTAREA"&&i.tagName!=="INPUT"?-1:0,r={x:i.scrollLeft*f,y:i.scrollTop*f},u;return n.Browser.is_ie&&t(i,"position")==="static"?(u=i.style.position,i.style.position="relative",r.x+=i.offsetLeft,r.y+=i.offsetTop,i.style.position=u):(r.x+=i.offsetLeft,r.y+=i.offsetTop),r}function a(i){var r={x:0,y:0},u;if(i.getBoundingClientRect){var f=i.getBoundingClientRect(),c=s(),e=n(window).get_scroll_pos();r.x=f.left-c.x+e.x,r.y=f.top-c.y+e.y}else while(i!==null)u=o(i),r.x+=u.x,r.y+=u.y,i=i.offsetParent,i&&!h()&&(r.x+=parseFloat(t(i,"borderLeftWidth"))||0,r.y+=parseFloat(t(i,"borderTopWidth"))||0);return r}function h(){var n,t;return typeof arguments.callee.constantValue=="undefined"&&(n=document.createElement("div"),n.style.cssText="position:absolute;visibility:hidden;top:0;left:0;border:1px solid #000;",t=document.createElement("div"),n.appendChild(t),document.body.appendChild(n),arguments.callee.constantValue=t.offsetTop===1,document.body.removeChild(n),n=t=null),arguments.callee.constantValue}function s(){var i,r;if(typeof arguments.callee.constantValue=="undefined"){var t=document.body,f=t.style.position,u=t.style.margin,e=t.style.border;t.style.position="static",t.style.margin="0",t.style.border="1px solid transparent",i=t.getBoundingClientRect(),r=n(window).get_scroll_pos(),arguments.callee.constantValue={x:i.left+r.x,y:i.top+r.y},t.style.position=f,t.style.margin=u,t.style.border=e,document.documentElement.className=document.documentElement.className}return arguments.callee.constantValue}function t(n,t){var i="",f,e,r;return n.currentStyle&&(t==="right"||t==="bottom")?i=u(t,"auto","auto",n)+"px":(f=document.defaultView&&document.defaultView.getComputedStyle&&document.defaultView.getComputedStyle(n,null)||n.currentStyle,f&&(i=f[t]||"",e=i.match(/px$/),e||(r=i.match(/(em|ex|%|in|cm|mm|pt|pc|small|medium|large|thin|thick|auto)$/),r&&(i=u(t,i,r[0],n)+"px")))),i}function u(i,r,u,f){var s,a,y,o,l,h,p,w,c,e,v;if(r){if(u==="px")return parseFloat(r);if(r==="auto")switch(i){case"top":case"left":return 0;case"bottom":case"right":s={bottom:["top","offsetTop","height","offsetHeight"],right:["left","offsetLeft","width","offsetWidth"]},a=n(f);if(a.get_style("position")==="relative")return y=s[i][0],-parseInt(a.get_style(y));o=f.parentNode;while(o!==document&&n(o).get_style("position")==="static")o=o.parentNode;return l=s[i][2],h=o===document?n.Screen.get_viewport_size()[l]:parseInt(n(o).get_style(l)),p=s[i][1],w=s[i][3],h-f[p]-f[w];case"height":return f.clientHeight||f.offsetHeight&&f.offsetHeight-parseFloat(t(f,"borderTopWidth"))-parseFloat(t(f,"borderBottomWidth"))||0;case"width":return f.clientWidth||f.offsetWidth&&f.offsetWidth-parseFloat(t(f,"borderLeftWidth"))-parseFloat(t(f,"borderRightWidth"))||0;default:return 0}else{switch(i){case"borderLeftWidth":case"borderRightWidth":case"borderTopWidth":case"borderBottomWidth":return i=i.replace("Width","Style"),c=t(f,i),c==="none"?0:parseFloat(c)}f=f||document.body,e=document.createElement("div"),e.style.visbility="hidden",e.style.position="absolute",e.style.lineHeight="0",u==="%"?(f=f.parentNode,i==="height"||i==="top"?e.style.height=r:(i==="width"||i==="left")&&(e.style.width=r)):(e.style.borderStyle="solid",e.style.borderBottomWidth="0",e.style.borderTopWidth=r);try{f.appendChild(e)}catch(b){f=f.parentNode,f.appendChild(e)}return f.offsetWidth,f.offsetHeight,v=e.offsetHeight||e.offsetWidth,f.removeChild(e),v}}else return 0}function v(n,t){var i=f(n,t);return i.camelizedName||n}function y(n,t){var i=f(n,t);return i.nonCamelizedName||n}function f(n,t){var u,s,f,o,h;t=t||document.body||document.createElement("div"),u=r[n];if(!u){u={},s=i.length;while(s--){f=i[s],o=e(f+n);if(t.style[o]!==undefined){h=(f&&"-"||"")+f.toLowerCase()+n,u.camelizedName=o,u.nonCamelizedName=h;break}}r[n]=u}return u}function e(n){return n.replace(/-(\w)/g,function(n,t){return t.toUpperCase()})}var l,c,r,i;this.get_relative_pos=o,this.get_absolute_pos=a,this.offset_includes_borders=h,this.get_bounding_client_rect_offsets=s,l=function(){function t(n,t){n.style.opacity=t}function i(n,t){t*=100;var i;try{i=n.filters.item("DXImageTransform.Microsoft.Alpha"),t<100?(i.Opacity=t,i.enabled||(i.enabled=!0)):i.enabled=!1}catch(r){t<100&&(n.style.filter=(n.currentStyle||n.runtimeStyle).filter+" progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")")}}var n=document.createElement("div");return typeof n.style.opacity!="undefined"&&t||typeof n.style.filter!="undefined"&&i||function(){}}(),this.set_opacity=l,c=function(){function i(n){return parseFloat(n.style.opacity)||t(n,"opacity")}function r(n){var t=n.filters["DXIMageTransform.Microsoft.Alpha"];return t?t.Opacity/100:1}var n=document.createElement("div");return typeof n.style.opacity!="undefined"&&i||typeof n.style.filter!="undefined"&&r||function(){}}(),this.get_opacity=c,this.get_rendered_style=t,this.normalize_style=u,r={},i=["O-","ms-","Moz-","webkit-",""],this.get_camelized_style_name=v,this.get_css_style_name=y,this.camelize=e},n.Events=new function(){var r=n.Helper,i=null,t=null;this.capture_mouse=function(r,u){return n.Events.release_mouse(),i=r,u!==!1&&(u=!0),r.setCapture!==undefined?r.setCapture(u):(t=function(r){var s=r.target,f=document.createEvent("MouseEvents"),o,e;f.initMouseEvent(r.type,r.bubbles,r.cancelable,window,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget),f.__defineGetter__&&(o=n.Screen.get_scroll_pos(),f.__defineGetter__("pageX",function(){return this.clientX+o.x}),f.__defineGetter__("pageY",function(){return this.clientY+o.y})),document.removeEventListener(r.type,t,!0),f.captureTarget=s,e=i,u||n(i).has(s)&&(e=s),e.dispatchEvent(f),t!==null&&document.addEventListener(r.type,t,!0),delete f.captureTarget,r.stopPropagation()},document.addEventListener("mouseover",t,!0),document.addEventListener("mouseout",t,!0),document.addEventListener("mousemove",t,!0),document.addEventListener("mouseup",t,!0),document.addEventListener("mousedown",t,!0),document.addEventListener("click",t,!0),document.addEventListener("dblclick",t,!0)),this},this.release_mouse=function(){return i!==null&&(i.releaseCapture!==undefined?i.releaseCapture():(document.removeEventListener("mouseover",t,!0),document.removeEventListener("mouseout",t,!0),document.removeEventListener("mousemove",t,!0),document.removeEventListener("mouseup",t,!0),document.removeEventListener("mousedown",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("dblclick",t,!0)),i=t=null),this},this.get_capture_target=function(n){return n.captureTarget||n.srcElement||n.target},this.Pseudo=new function(){function t(n,t,i){this.pseudoName=n,this.getNativeName=t,this.getProxiedHandler=i}function v(n,t,i){if(n===t)return!1;var r=0;while(t&&t!=n)r++,t=t.parentNode;return i=i||r,t===n&&i===r}function a(n){var i=r.get_guid(n),t=u[i];return t||(t=u[i]=function(t){var i=t.relatedTarget;if(!i||this===i||v(this,i))return;n.call(this,t)}),t}function p(t){if(!n.Browser.is_gecko)return t;var f=r.get_guid(t),i=u[f];return i||(i=u[f]=function(n){n.wheelDelta=-40*n.detail,t.call(this,n),n.wheelDelta=null}),i}function e(t){if(!n.Browser.is_ie)return t;var e=r.get_guid(t),f=u[e];return f||(f=u[e]=function(u){var o,e,h,s,f;if(u.pointerType===2){u.type==="MSPointerUp"||u.type==="MSPointerCancel"?delete i[u.pointerId]:(o=n.Screen.get_mouse_pos(u),i[u.pointerId]={_$targetId:r.get_guid(u.target),identifier:u.pointerId,pageX:o.x,pageY:o.y}),h=[],s=[];for(e in i)i.hasOwnProperty(e)&&i[e]&&(f=i[e],h.push(f),f._$targetId===r.get_guid(u.target)&&s.push(f));u.touches=h,u.targetTouches=s,u.type==="MSPointerDown"&&(u.preventDefault=y),t.call(this,u),u.touches=u.targetTouches=null}}),f}function y(){return f[this.pointerId]=!0,document.addEventListener("MSPointerUp",c,!0),document.addEventListener("click",h,!0),MSPointerEvent.prototype.preventDefault.call(this)}function c(n){o=n.pointerId,f[o]&&(f[o]=!1)}function h(n){var t,i=0;for(t in f)t=parseInt(t),f[t]===!1&&delete f[t]||i++,t===o&&(n.stopPropagation()||n.preventDefault());i===0&&(document.removeEventListener("MSPointerUp",c,!0),document.removeEventListener("click",h,!0))}function l(){}var o=null,f={},u={},i={},s={touchstart:"MSPointerDown",touchend:"MSPointerUp",touchmove:"MSPointerMove",touchcancel:"MSPointerCancel"};return t.prototype.add=function(n,t,i){n.add_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,n),i,!0)},t.prototype.remove=function(n,t,i){n.remove_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,n),i,!0)},{mouseenter:new t("mouseenter",function(){return"mouseover"},function(n){return a(n)}),mouseleave:new t("mouseleave",function(){return"mouseout"},function(n){return a(n)}),mousewheel:new t("mousewheel",function(t){return n.Browser.is_gecko?"DOMMouseScroll":t},function(n){return p(n)}),touchstart:new t("touchstart",function(t){return n.Browser.is_ie?s[t]:t},function(t){return n(document).add_event("touchend",l,!0).add_event("touchcancel",l,!0),e(t)}),touchend:new t("touchend",function(t){return n.Browser.is_ie?s[t]:t},function(n){return e(n)}),touchmove:new t("touchmove",function(t){return n.Browser.is_ie?s[t]:t},function(n){return e(n)}),touchcancel:new t("touchcancel",function(t){return n.Browser.is_ie?s[t]:t},function(n){return e(n)})}}},function(){var f=n.Helper,e=n.Internals,r,t,o={},u={},i={load:!1,unload:!1,focus:!1,blur:!1,beforeunload:!1,stop:!1,beforeprint:!1,afterprint:!1,propertychange:!1,filterchange:!1,readystatechange:!1,losecapture:!1};n.ext.add_event=function(){function h(t,i,r,u){return!u&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].add(this,i,r):this.for_each(function(n){e.addEventListener.call(n,t,i,r)}),this}function s(s,h,c,l){function y(i,r){t=t||1,r.eventPhase=t,r.target=r.srcElement,r.currentTarget=i;var u=n.Screen.get_mouse_pos(r);r.pageX=u.x,r.pageY=u.y;switch(r.type){case"keyup":case"keydown":case"keypress":i.type!=="file"&&(r.keyCode===186?r.keyCode=59:r.keyCode===187?r.keyCode=61:r.keyCode===189?r.keyCode=109:null),r.which=r.keyCode,r.charCode=r.keyCode;break;case"mousedown":case"mouseup":case"click":case"dblclick":case"contextmenu":r.which=[1,1,3,r.button,2][r.button];break;case"mouseover":r.relatedTarget=r.fromElement;break;case"mouseout":r.relatedTarget=r.toElement}return r.preventDefault=function(){r.returnValue=!1},r.stopPropagation=function(){r.cancelBubble=!0},r}function p(n,t,r){var u=i[n],f;return u===!1?!1:(u||(u=i[n]={}),f=u[t],f||(f=u[t]=[]),f.push(r),!0)}function a(n,t){var r=u[n],i;r||(r=u[n]={}),i=r[t],i||(i=r[t]={handlerCount:0,remainingHandlers:0}),i.handlerCount++,i.remainingHandlers=i.handlerCount}function v(n,u){var a=[],l=n,h,e,o,v,c;while(l)a.push(l),l=l.parentNode;while(h=a.pop()){e=f.get_guid(h);if(i[s][e])for(r||(r=h),v=i[s][e].length,o=0;o<v;o++)u.cancelBubble||(h===u.target&&(u.eventPhase=t=2),c=i[s],c[e]&&c[e][o]&&c[e][o].call(h,u))}return r}return!l&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[s]?n.Events.Pseudo[s].add(this,h,c):this.for_each(function(n){var w=f.get_guid(n),k=f.get_guid(h)+(c||!1).toString(),b="{"+w+" / "+s+" / "+k+"}",l;c&&(c=p(s,w,h)),l=o[b],l||(l=function(f){var e=u[s][w];e.remainingHandlers--,f=y(n,f),i[s]&&t===1&&(r=v(n,f)),t=n===f.target?2:3,f.eventPhase=t,!c&&!f.cancelBubble&&h.call(n,f),(!r||f.cancelBubble||n==r&&e.remainingHandlers===0)&&(t=1,r=undefined,e.remainingHandlers=e.handlerCount),f.eventPhase=f.target=f.currentTarget=f.relatedTarget=f.which=f.preventDefault=f.stopPropagation=f.pageX=f.pageY=undefined},o[b]=l,e.attachEvent.call(n,"on"+s,l),a(s,w)),b=null,l=null}),this}return document.addEventListener?h:document.attachEvent?s:function(){}}(),n.ext.remove_event=function(){function r(t,i,r,u){return!u&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].remove(this,i,r):this.for_each(function(n){e.removeEventListener.call(n,t,i,r)}),this}function t(t,r,s,h){function l(t,r,u){var o=i[t],f,e;o&&(f=o[r],f&&(e=n(f).index_of(u),e!==-1&&f.splice(e,1),f.length===0&&delete o[r]))}function c(n,t){var i=u[n]&&u[n][t];i&&(i.handlerCount>0&&i.handlerCount--,i.remainingHandlers=i.handlerCount)}return!h&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].remove(this,r,s):this.for_each(function(n){var h=f.get_guid(n),a=f.get_guid(r)+(s||!1).toString(),u="{"+h+" / "+t+" / "+a+"}",i;s&&l(t,h,r),i=o[u],i&&(e.detachEvent.call(n,"on"+t,i),delete o[u],c(t,h)),u=null,i=null}),this}return document.addEventListener?r:document.attachEvent?t:function(){}}()}(),function(){var t=n.Helper;n.ext.add_class=function(i){var r=i.split(/\s+/);return this.for_each(function(i){n(r).for_each(function(n){t.has_class(i,[n])||(i.className===""?i.className=n:i.className+=" "+n)})}),this}}(),n.ext.remove_class=function(n){return this.swap_class(n,"$1")},n.ext.swap_class=function(t,i){i!=="$1"&&(i=" "+i+" ");var r=t.split(/\s+/);return this.for_each(function(t){var u=t.className;n(r).for_each(function(n){var t=new RegExp("(^| )"+n+"( |$)");u=u.replace(t,i)}),t.className=u.replace(/^\s+|\s+$/g,"")}),this},function(){var t=n.Helper;n.ext.has_class=function(n,i){var r=this[i||0];return r&&t.has_class(r,[n])||!1}}(),n.ext.get_html=function(n){var t=this[n||0];return t&&t.innerHTML||""},n.ext.set_html=function(n){return this.for_each(function(t){t.innerHTML=n}),this},n.ext.get_val=function(n){var t=this[n||0];return t&&t.value||""},n.ext.set_val=function(n){return this.for_each(function(t){typeof t.value!="undefined"&&(t.value=n)}),this},function(){var t=n.Helper.get_attr;n.ext.get_attr=function(n,i){var r=this[i||0];return r&&t(r,n)||""}}(),n.ext.set_attr=function(n,t){return this.for_each(function(i){i.setAttribute(n,t)}),this},function(){var r=n.Style.get_rendered_style,i=n.Style.get_opacity,t=n.Style.get_camelized_style_name;n.ext.get_style=function(n,u){var f=this[u||0];return f?n==="opacity"?i(f):r(f,t(n)):""}}(),function(){var i=n.Style.set_opacity,t=n.Style.get_camelized_style_name;n.ext.set_style=function(n){return this.for_each(function(r){var e,u,f;for(e in n){u=n[e],f=t(e);switch(f){case"height":case"maxHeight":case"minHeight":case"width":case"maxWidth":case"minWidth":case"top":case"right":case"bottom":case"left":case"marginTop":case"marginRight":case"marginBottom":case"marginLeft":case"paddingTop":case"paddingRight":case"paddingBottom":case"paddingLeft":r.style[f]=typeof u=="number"&&u+"px"||u;break;case"opacity":i(r,u);break;default:r.style[f]=u}}}),this}}(),n.ext.get_native_prop=function(n,t){var i=this[t||0];return i?i[n]:""},n.ext.parent=function(t){var i=this[t||0];return n(i&&i.parentNode)},n.ext.element=function(n){return this[n||0]},n.ext.get_ancestor=function(t,i){var r=this[i||0],u=t;while(u-->0)if(r)r=r.parentNode;else break;return n(r)},n.ext.get_sibling=function(t,i){var f=this[i||0],r=f;if(t!==0){var o=t>0?"nextSibling":"previousSibling",e=Math.abs(t),u=0;while(u<e){r=r[o];if(!r)break;r.nodeType===1&&u++}}return n(r)},n.ext.for_each=function(){function t(n,t){return this.entities().forEach(n,t),this}function n(n,t){for(var r=this.entities(),u=r.length,i=0;i<u;i++)n.call(t,r[i],i,r);return this}return typeof Array.prototype.forEach!="undefined"?t:n}(),n.ext.iterate=function(t){for(var u=this.length,r,i=0;i<u;i++)r=n(this[i]),t.call(r,i);return t=null,this},n.ext.filter=function(t){var r=n(),i=this.length;while(i--)t(this[i])&&r.unshift(this[i]);return r},n.ext.map=function(){function i(t,i){return n(this.entities().map(t,i))}function t(t,i){var u=n(),r=this.length;while(r--)u.unshift(t.call(i,this[r]));return u}return typeof Array.prototype.map!="undefined"?i:t}(),function(){var t=n.Helper;n.ext.contains=function(n){return t.contains(this.entities(),n)}}(),function(){var t=n.Helper;n.ext.index_of=function(n){return t.index_of(this.entities(),n)}}(),n.ext.select=function(t){return n(t,this[0])},n.ext.has=function(t,i){var r=this[i||0];return n(t,r).length>0},function(){var t=n.Helper;n.ext.unique=function(){return n(t.unique(this.entities()))}}(),function(){var t=n.Style.get_rendered_style;n.ext.get_style_pos=function(n){var i=this[n||0];return{x:parseFloat(t(i,"left")),y:parseFloat(t(i,"top"))}}}(),function(){var t=n.Style.get_absolute_pos;n.ext.get_absolute_pos=function(n){var i=this[n||0];return i&&t(i)||{x:0,y:0}}}(),function(){var t=n.Style.get_relative_pos;n.ext.get_relative_pos=function(n){var i=this[n||0];return i&&t(i)||{x:0,y:0}}}(),function(){n.ext.get_scroll_pos=function(t){var r=this[t||0],i={x:0,y:0};return r===window?typeof window.pageYOffset!="undefined"?(i.x=window.pageXOffset,i.y=window.pageYOffset):n.Browser.is_in_quirks_mode||typeof document.documentElement.scrollTop=="undefined"?typeof document.body.scrollTop!="undefined"&&(i.x=document.body.scrollLeft,i.y=document.body.scrollTop):(i.x=document.documentElement.scrollLeft,i.y=document.documentElement.scrollTop):(i.x=r.scrollLeft,i.y=r.scrollTop),i}}(),n.ext.animate=function(t,i,r,u,f){function l(n,t,i){switch(n){case"+":return t+i;case"-":return t-i;case"*":return t*i;case"/":return t/i;default:return i}}function c(t,i){var u=n(t).get_style(i)+"",r=parseFloat(u);return e.units[i]=u.replace(r,""),r}function a(n,i){var e=c(n,i),r=t[i]+"",u=r.match(/^[+\-*\/]/),f=u&&u[0]||"noOp";return r=Number(r.replace(f,"")),l(f,e,r)}var e={units:{},ops:{}},s={},o,h;for(o in t)e[o]=c,s[o]=a;return h=n.Effects.Storyboard.create(this,e,s,function(t,i){var f=n(t),r,u;for(r in i){if(r==="units")continue;u={},u[r]=i[r]+e.units[r],f.set_style(u)}},i,r,u,f),h.begin(),this},n.ext.bounce=function(t,i,r,u,f){function o(t){return n(t).get_style_pos().y}t===null&&(t=o);var e=n.Effects.Storyboard.create(this,{top:t},{top:i},function(n,t){n.style.top=Math.ceil(t.top)+"px"},r,u,f,n.Effects.Easing.Bounce.ease_out);return e.begin(),this},function(){function t(t,i,r,u,f){this.set_style({zoom:1}),t===null&&(t=function(t,i){return Number(n(t).get_style(i))});var o=n.Effects.Storyboard.create(this,{opacity:t},{opacity:i},function(t,i){n(t).set_style({opacity:i.opacity})},r,u,f,null);return o.begin(),this}n.ext.fade_to=t,n.ext.fade_in=function(n,i,r,u){return t.call(this,0,1,n,i,r,u)},n.ext.fade_out=function(n,i,r,u){return t.call(this,1,0,n,i,r,u)}}(),n.ext.slide=function(t,i,r,u,f,e){function s(t,i){i=i==="left"?"x":"y";var r=t.__pos;return r||(r=t.__pos=n(t).get_style_pos()),i==="y"&&(t.__pos=n.undefined),r[i]}t===null&&(t={x:s,y:s});var o=Math.round,c=n.Effects.Easing.Exponential.ease_in_out,h=n.Effects.Storyboard.create(this,{left:t.x,top:t.y},{left:i.x,top:i.y},function(n,t){n.style.top=o(t.top)+"px",n.style.left=o(t.left)+"px"},r,u,f,e||function(n){return c(n,4)});return h.begin(),this},n.ext.scroll_to=function(t,i,r,u){var o=n.Screen.get_scroll_pos(),e=n(this[0]).get_absolute_pos(),f=Math.round,h=n.Effects.Easing.Exponential.ease_out,s=n.Effects.Storyboard.create([window],{scrollX:o.x,scrollY:o.y},{scrollX:e.x,scrollY:e.y},function(n,t){n.scrollTo(f(t.scrollX),f(t.scrollY))},t,i,r,u||function(n){return h(n,4)});return s.begin(),this},n.ext.veil=function(t,i,r,u,f){function l(t,i){var r=parseInt(n(t).get_style(i),10);return t[c]=t[c]||{},t[c][i]=r}var e=n.Effects.Enums.Directions,c,s,o,h;return t=Math.floor(t)||e[t]||e.vertically,c="_$gimme$_veil",s={},o={},(t&e.vertically)===e.vertically&&(o.height=o.paddingTop=o.paddingBottom=l,s.height=s.paddingTop=s.paddingBottom=0),(t&e.horizontally)===e.horizontally&&(o.width=o.paddingLeft=o.paddingRight=l,s.width=s.paddingLeft=s.paddingRight=0),h=n.Effects.Storyboard.create(this.filter(function(t){var i=t.style.display||n(t).get_style("display");return i!=="none"}),o,s,function(n,i){var r=n.style;(t&e.vertically)===e.vertically&&(r.height=i.height+"px",r.paddingTop=i.paddingTop+"px",r.paddingBottom=i.paddingBottom+"px"),(t&e.horizontally)===e.horizontally&&(r.width=i.width+"px",r.paddingRight=i.paddingRight+"px",r.paddingLeft=i.paddingLeft+"px")},i,r,u,f||function(t){return n.Effects.Easing.Exponential.ease_in_out(t,4)}),h.get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(n){n.style.overflow="hidden"}}),new n.Effects.Animation({startTime:h.get_duration(),elements:this,animate:function(n){n.style.display="none"}})),h.begin(),this},n.ext.unveil=function(t,i,r,u,f){function c(t,i){var r=t._$gimme$_veil;return r||(r=r||function(){var i=t.cloneNode(!0),f,u,r;return i.style.cssText="position:absolute;top:0;left:0;visibility:hidden;margin:0;padding:0;border:0;height:;width:;",i.style.display="block",t.parentNode.appendChild(i),i=n(i),f=parseInt(n(t).get_style("height"),10)||parseInt(i.get_style("height"),10),u=parseInt(n(t).get_style("width"),10)||parseInt(i.get_style("width"),10),i[0].style.padding=t.style.padding,r={height:f,width:u,paddingTop:parseInt(i.get_style("paddingTop"),10),paddingBottom:parseInt(i.get_style("paddingBottom"),10),paddingRight:parseInt(i.get_style("paddingRight"),10),paddingLeft:parseInt(i.get_style("paddingLeft"),10)},t.parentNode.removeChild(i[0]),t.style.overflow="hidden",r}()),r[i]}var e=n.Effects.Enums.Directions,s,o,h;return t=Math.floor(t)||e[t]||e.vertically,e=n.Effects.Enums.Directions,t=Math.floor(t)||e[t]||e.vertically,s={},o={},(t&e.vertically)===e.vertically&&(o.height=o.paddingTop=o.paddingBottom=0,s.height=s.paddingTop=s.paddingBottom=c),(t&e.horizontally)===e.horizontally&&(o.width=o.paddingLeft=o.paddingRight=0,s.width=s.paddingLeft=s.paddingRight=c),h=n.Effects.Storyboard.create(this.filter(function(t){var i=t.style.display||n(t).get_style("display");return i==="none"||i===null}),o,s,function(n,i){(t&e.vertically)===e.vertically&&(n.style.height=i.height+"px",n.style.paddingTop=i.paddingTop+"px",n.style.paddingBottom=i.paddingBottom+"px"),(t&e.horizontally)===e.horizontally&&(n.style.width=i.width+"px",n.style.paddingRight=i.paddingRight+"px",n.style.paddingLeft=i.paddingLeft+"px")},i,r,u,f||function(t){return n.Effects.Easing.Exponential.ease_in_out(t,4)}),h.get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(n){n.style.overflow="hidden",n.style.display="block"}}),new n.Effects.Animation({startTime:h.get_duration(),elements:this,animate:function(n){n.style.overflow=""}})),h.begin(),this},n.toString=function(){return"Gimme v2.7.0 (Edmund) :: Friday, September 14, 2012 3:02:22 PM"},n.Internals.parseJSON=function(n){var t=JSON&&JSON.parse||(n="("+n+")")&&eval;return t(n)},n}(),window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.initMapCode=function(){function i(n,t){this.x=n,this.y=t}function p(n,t,i,r){this.latitude=parseFloat(n),this.longitude=parseFloat(t),dt.isValid(r)&&(this.altitude=parseFloat(i),this.altitudeReference=r)}function ct(n,t,i){this.center=n,this.width=t,this.height=i}function lu(t){function i(){var i=e.getWidth(),t=e.getHeight();(i!==f||t!==o)&&(f=i,o=t,n.invoke(e,"resize",{width:i,height:t}))}var e=this,l=t.onresize!==h,r,f,o,c=v(t),s=v(window);this.getWidth=function(){return t.offsetWidth},this.getHeight=function(){return t.offsetHeight},this.startMonitoring=function(){l?(c.add_event("resize",i),u.useOnResize&&(t.onresize=i)):(r||(r=window.setInterval(i,1e3)),s.add_event("resize",i))},this.stopMonitoring=function(){c.remove_event("resize",i),u.useOnResize&&t.onresize===i&&(t.onresize=null),r&&(window.clearInterval(r),_timeoutId=null),s.remove_event("resize",i)},this.poll=function(){f=null,o=null,i()}}function or(r,f){function fr(){function w(){var i=e.getImageryId(),n="dark",t=v("~.InfoboxExtension",s);switch(i){case"Aerial":case"EnhancedBirdseye":case"NativeBirdseye":p.add_class(n),t.add_class(n);break;default:p.remove_class(n),t.remove_class(n)}}var o,a,nt,i,r,h;f=f||{},s=k(),s.className="MicrosoftMap",u.allowFocus&&(l=k("button","position:fixed;width:1px;height:1px;left:0;top:0;padding:0;font-size:0;line-height:0;border:0;background:transparent;",s),l.tabIndex=-1,u.useXHR&&v(l).set_style({display:"none"})),ht=fi(),gt=fi(),ot.appendChild(s);if(t.versionNotSupported===!0){i=k("div","position:absolute; width:100%; top:50%; text-align:center"),r=k("div","background: #f8f7f5; padding:10px; color: #000;"),r.innerHTML=ar.getString("L_VersionNotSupportedMessage_Text"),i.appendChild(r),e.getRootElement().appendChild(i);return}if(t.killSwitchEngaged===!0){i=k("img","position:absolute; height:100%; margin:auto"),i.src=t.killSwitchImageUrl,e.getRootElement().appendChild(i);return}ti=v(document),ri=v(ht),p=v(s),pt=f.restrictKeyboardListeningToMapContainer?v(ot):ti,f.theme&&(ut=f.theme,ut._attachToMap&&ut._attachToMap(e,f)),f.showHotRegions===!0&&(t.onDemandRoadUriFormat&&(t.roadUriFormat=t.onDemandRoadUriFormat),t.onDemandAerialWithLabelsUriFormat&&(t.aerialWithLabelsUriFormat=t.onDemandAerialWithLabelsUriFormat)),n.invoke(or,"mapcreationstart",{map:e,options:f}),gi=f.credentials,c.authenticate(f.credentials),typeof ft!="undefined"&&ft.authenticate(e.getCredentials),g=new lu(s),n.addHandler(g,"resize",cr),hi(f.width,f.height),(t.ddCoreStylesDownloaded||ut)&&!u.useXHR||(ei.downloadStyles(t.cssPath+"mapcontrol.css"),t.ddCoreStylesDownloaded=!0),o=uu(f),o.mapTypeId=o.mapTypeId||wt.auto||wt.road,o.animate=!1,e.setView(o),tr&&e.focus(),p.add_event("mousedown",e.focus).add_event("touchstart",e.focus),b.dispatch(function(){if(c){var n={showDashboard:f.showDashboard,showMapTypeSelector:f.showMapTypeSelector,showDualMapTypeSelector:f.showDualMapTypeSelector,disableBirdseye:f.disableBirdseye,showBreadcrumb:f.showBreadcrumb,showScalebar:f.showScalebar,scalebarPosition:f.scalebarPosition||"bottomRight",showLogo:f.showLogo,logoPosition:f.logoPosition||"bottomLeft",clickable:f.enableClickableLogo,enableSearch:f.enableSearchLogo,showCopyright:f.showCopyright,copyrightPosition:f.copyrightPosition||"bottomRight",copyrightStacked:f.copyrightStacked||!1};c.showOverlays(n)}}),f.showHotRegions===!0&&(b.dispatch(function(){c&&c.showHotRegions(f.disableLabels)}),f.showVenueMapsExplorer===!0&&b.dispatch(function(){c&&c.showVenueMapsExplorer()})),t.disableAnalytics||f.disableAnalytics||(a=new wu(e),e.addComponent("analyticsProxy",a),!t.frontdoorLogUrl&&t.biciLoggingService&&e.getCredentials(function(n){a.enable({sessionKey:n})})),f.fixedMapPosition===!0&&(nr=!1),nt=n.addHandler(e,"imagerychanged",w),w(),u.useXHR&&t.message&&(i=k("div","position:absolute; width:100%; top:50%; text-Align:center"),r=k("div","background: #f8f7f5; padding:10px; color: #000;"),r.innerHTML=t.message,i.appendChild(r),e.getRootElement().appendChild(i)),t.updateAvailable===!0;if(t&&t.allowOrdnanceSurvey&&t.logOSServiceUriFormat){function y(){e.getCredentials(function(n){ei.getObjectAsyncWithNoJsonso(t.logOSServiceUriFormat.replace(/{credentials}/,n),function(){})})}if(e.getImageryId()==="OrdnanceSurvey")b.dispatch(y);else{function d(){e.getImageryId()==="OrdnanceSurvey"&&(h&&(n.removeHandler(h),h=null),b.dispatch(y))}h=n.addHandler(e,"imagerychanged",d)}}}function er(t){var i=w.length;while(i--)w[i][1]=n.addHandler(t,w[i][0],function(){var t=w[i][0];return function(i){n.invoke(e,t,i)}}());v(s).add_event("mouseenter",function(t){n.invoke(e,"mouseover",new vi(e,ui.map,e,"mouseover",t.clientX,t.clientX,0,!1,t))}),v(s).add_event("mouseleave",function(t){n.invoke(e,"mouseout",new vi(e,ui.map,e,"mouseout",t.clientX,t.clientX,0,!1,t))})}function ur(){var i,t=w.length;while(t--)i=w[t][1],i&&n.removeHandler(i),w[t][1]=null;v(s).remove_event("mouseenter",function(t){n.invoke(e,"mouseover",new vi(e,ui.map,e,"mouseover",t.clientX,t.clientX,0,!1,t))}),v(s).remove_event("mouseleave",function(t){n.invoke(e,"mouseout",new vi(e,ui.map,e,"mouseout",t.clientX,t.clientX,0,!1,t))})}function fi(){return k("div","z-index:0;position:absolute;left:50%;top:50%;"+u.safariRenderHack,s)}function hi(n,t){n>0&&t>0?(g.stopMonitoring(),kt=!1,s.style.cssText=sr.replace("{width}",n).replace("{height}",t),oi(n,t)):(s.style.cssText=pr,kt=!0,g.startMonitoring(),g.poll())}function oi(t,i){t=Math.round(Math.max(1,t)),i=Math.round(Math.max(1,i)),(t!==ii||i!==dt)&&(ii=t,dt=i,hr(t,i),n.invoke(e,"resize"))}function hr(n,t){setTimeout(function(){var i=v(s);t<100||n<240?i.add_class("miniscule"):(n>=240&&n<320?i.remove_class("medium large").add_class("verySmall"):n>=320&&n<600?i.remove_class("verySmall large").add_class("medium"):i.remove_class("verySmall medium").add_class("large"),i.remove_class("miniscule"))},1)}function cr(n){kt&&oi(n.width,n.height)}function d(){var t,n;ni&&(t=p.get_absolute_pos(),lt=t.x,vt=t.y,n=ri.get_absolute_pos(),nt=n.x,tt=n.y,ni=!1,nr&&b.dispatch(ai))}function ai(){ni=!0}function ci(n){for(var t in y)if(y.hasOwnProperty(t)&&y[t].getMode()===n)return y[t];return null}function lr(t){if(o!=t){var i=o,f=ci(i),u=ci(t),r="MapTypeId_";t.activating&&t.activating(e,{credentials:gi}),i&&i.deactivating&&i.deactivating(),ur(),o=t,rt=null,f&&p.remove_class(r+f.getMapTypeId()),i&&i.deactivated&&i.deactivated(),u&&p.add_class(r+u.getMapTypeId()),er(t),t.activated&&t.activated(),n.invoke(e,"modechanged"),n.invoke(e,"imagerychanged"),n.invoke(e,"copyrightchanged")}}function bt(n){var t,i;if(wi!==e)return!1;t=n.target;if(t){i=t.tagName;if(i==="INPUT"&&(t.type==="text"||t.type==="search")||i==="TEXTAREA"||i==="SELECT")return!1}return!0}function yt(t,i){if(n.hasHandler(e,t)){var r=new vr(t,i.keyCode,i.altKey,i.ctrlKey,i.shiftKey,i.charCode);r.originalEvent=i,n.invoke(e,t,r)}}function li(n){bt(n)&&yt("keydown",n)}function yi(n){bt(n)&&yt("keyup",n)}function rr(n){bt(n)&&yt("keypress",n)}var w;PRF.start("mapobj");var e=this,c=new nu(this),ot=r,s,kt=!0,tr=window.top==window.self,ii,dt,lt,vt,nt,tt,g,ct="z-index:0;overflow:hidden;direction: ltr !important;background-color:";ct+=f&&f.backgroundColor?at.clone(f.backgroundColor).toHex()+";":"#F4F2EE;";var pr=ct+(v.Browser.is_in_quirks_mode?"position:absolute;top:0;left:0;width:100%;height:100%":"position:absolute;left:0;top:0;right:0;bottom:0"),sr=ct+"position:relative;width:{width}px;height:{height}px",nr=!0,ni=!0,ht,gt,et={min:t.minMercatorZoom,max:t.maxMercatorZoom},rt=null,l,ti,ri,p,pt,o=null,gi,y=[],st=null,ut=null,a={width:null,height:null,disableUserInput:!1,disableKeyboardInput:!1,disableMouseInput:!1,disableTouchInput:!1,disableZooming:!1,disablePanning:!1,labelOverlay:it.visible,useInertia:!0,inertiaIntensity:-1,tileBuffer:0,showBackground:null,pinFocusBehavior:yr.highlight},pi=new di,bi={};this.addComponent=function(t,i){bi[t]=i,n.invoke(e,"componentadded",{componentName:t,component:i})},this.getComponent=function(n){return bi[n]},this.getCredentials=function(n){c?c.getCredentials(n):typeof n=="function"&&n(null)},this.getWidth=function(){return ii},this.getHeight=function(){return dt},this.getPageX=function(){return d(),lt},this.getPageY=function(){return d(),vt},this.getViewportX=function(){return d(),nt},this.getViewportY=function(){return d(),tt},this.getTheme=function(){return ut},this.focus=function(){a.disableUserInput||a.disableKeyboardInput||(l&&(l.offsetWidth>0||l.offsetHeight>0)&&tr?l.focus():window.focus(),wi!==e&&(wi&&wi.blur(),l&&pt.add_event("keydown",li).add_event("keypress",rr).add_event("keyup",yi),wi=e,n.invoke(e,"focus")))},this.blur=function(){if(l){try{l.blur()}catch(t){}pt.remove_event("keydown",li).remove_event("keypress",rr).remove_event("keyup",yi)}wi===e&&(n.invoke(e,"blur"),wi=null)},this.getRootElement=function(){return s},this.getModeLayer=function(){return ht},this.getUserLayer=function(){return gt},this.updateMapPosition=ai,this.dispose=function(){if(e){n.invoke(e,"ondispose",null),c.dispose(),e.blur(),e.entities.clear(),o&&o.deactivating&&o.deactivating(),ur(),o&&o.deactivated&&o.deactivated(),o=null,y.length=0,g.stopMonitoring(),g=null,p.remove_event("mousedown",e.focus).remove_event("touchstart",e.focus),ot.removeChild(s),s=null,ot=null,ht=null,gt=null,ti=null,ri=null,p=null,c=null;var t=ki.length;while(t--)ki[t]===e&&ki.splice(t,1);e=null}},this.setView=function(t){var i,u,r;e.setOptions(t),t.mapTypeId&&(i=y[t.mapTypeId],i!==st&&(this.entities=pi,u=o,r=null,u&&(r=u.getCenter()),i.activating(),st=i,lr(i.getMode()),i.activated(),n.invoke(e,"maptypechanged"),t.center||t.bounds||!r||u===o||(t.center=r,t.animate==null&&(t.animate=!1)))),o.setView(t)},this.setOptions=function(t){var i,r=!1;for(i in t)a[i]!==h&&t[i]!==h&&a[i]!==t[i]&&(a[i]=t[i],r=!0);r&&(a.width!==h&&a.height!==h&&hi(a.width,a.height),n.invoke(e,"optionschanged"))},this.getOptions=function(){return uu(a)},this.getCenter=function(){return o.getCenter()},this.getZoom=function(){return o.getZoom()},this.getZoomRange=function(){return rt||(rt={min:Math.max(t.minMercatorZoom,o.getInternalMinZoom(),et.min),max:Math.min(t.maxMercatorZoom,o.getInternalMaxZoom(),et.max)}),rt},this.restrictZoom=function(n,i){if(n>i)throw"min zoom cannot be greater than max zoom";et.min=n||t.minMercatorZoom,et.max=i||t.maxMercatorZoom,rt=null},this.getHeading=function(){return o.getHeading()},this.getBounds=function(){return o&&o.getBounds()},this.getMetersPerPixel=function(){return o.getMetersPerPixel()},this.getTargetCenter=function(){return o.getTargetCenter()},this.getTargetZoom=function(){return o.getTargetZoom()},this.getTargetHeading=function(){return o.getTargetHeading()},this.getTargetBounds=function(){return o.getTargetBounds()},this.getTargetMetersPerPixel=function(){return o.getTargetMetersPerPixel()},this.tryLocationToPixel=function(n,t,i){var r,f,u,e,s;if(!o.tryLocationToViewport)return null;r=o.tryLocationToViewport(n,i);if(r&&t){f=0,u=0;switch(t){case si.page:d(),f=nt,u=tt;break;case si.control:d(),f=nt-lt,u=tt-vt}if(f||u)if(ir(r)){s=r.length;while(s--)e=r[s],e&&(e.x+=f,e.y+=u)}else r.x+=f,r.y+=u}return r},this.tryPixelToLocation=function(n,t,r){var s,f,u,e;if(!o.tryViewportToLocation)return null;s=n;if(t){f=0,u=0;switch(t){case si.page:d(),f=nt,u=tt;break;case si.control:d(),f=nt-lt,u=tt-vt}if(f||u)if(ir(n)){e=n.length,s=new Array(e);while(e--)s[e]=new i(n[e].x-f,n[e].y-u)}else s=new i(n.x-f,n.y-u)}return o.tryViewportToLocation(s,r)},this.isDownloadingTiles=function(){return o&&o.isDownloadingTiles?o.isDownloadingTiles():!1},this.getTileDownloadMetrics=function(){return o&&o.getTileDownloadMetrics?o.getTileDownloadMetrics():0},this.getImageryId=function(){return o&&o.getImageryId?o.getImageryId():""},this.isMercator=function(){return o.isMercator?o.isMercator():!1},this.isRotationEnabled=function(){return o.isRotationEnabled()},this.getCopyrights=function(n){return o&&o.getCopyrights&&o.getCopyrights(n),[]},this.getMode=function(){return o.getPublicApi?o.getPublicApi():{}},this.setMapType=function(n){this.setView({mapTypeId:n})},this.getMapTypeId=function(){return st?st.getMapTypeId():""},this.registerMapType=function(n){var t=n.getMapTypeId();if(y[t])throw"InvalidOperation: already registered";y.push(n),y[t]=n},this.entities=pi,w=[["viewchangestart",null],["viewchange",null],["viewchangeend",null],["targetviewchanged",null],["imagerychanged",null],["copyrightchanged",null],["tiledownloadcomplete",null],["click",null],["dblclick",null],["rightclick",null],["mousedown",null],["mouseup",null],["mousemove",null],["mousewheel",null]],fr(),ki.push(e),PRF.end("MapObject instantiated","mapobj")}function ci(n,t){var r=n,i=t;this.getMapTypeId=function(){return r},this.getMode=function(){return i},this.activating=function(){},this.activated=function(){}}function vi(n,t,i,r,u,f,e,o,s){var h=n;this.pageX=u,this.pageY=f,this.eventName=r,this.targetType=t,this.target=i,this.wheelDelta=e,this.isTouchEvent=o,this.originalEvent=s,this.isPrimary=s.which===1,this.isSecondary=s.which===3,this.getX=function(){return this.pageX-h.getViewportX()},this.getY=function(){return this.pageY-h.getViewportY()}}function vr(n,t,i,r,u,f){this.eventName=n,this.keyCode=t,this.charCode=f,this.altKey=i,this.ctrlKey=r,this.shiftKey=u,this.originalEvent={}}function at(n,t,i,r){this.a=n,this.r=t,this.g=i,this.b=r}function di(t){function s(t){t.collection||(t.collection=r),n.invoke(r,"entitychanged",t)}function h(t){n.invoke(r,"entityadded",t)}function c(t){n.invoke(r,"entityremoved",t)}function e(t,i){var e=u.length;if(!t[f]){t[f]=[];while(e--)t[f].push(n.addHandler(t,u[e][0],u[e][1]))}n.invoke(r,"entityadded",{collection:r,entity:t,index:i})}function o(t){if(t){var i=u.length;while(i--)n.removeHandler(t[f][i]);delete t[f],n.invoke(r,"entityremoved",{collection:r,entity:t})}}var r=this,f="_ech"+li.getNext(),u=[["entityadded",h],["entityremoved",c],["entitychanged",s]],i;this._eventsHandlers=u,i=[],this.get=function(n){return i[n]},this.getLength=function(){return i.length},this.push=function(n){i.push(n),e(n,i.length)},this.insert=function(n,t){i.splice(t,0,n),e(n,t)},this.pop=function(){var n=i.pop();return o(n),n},this.removeAt=function(n){var t=i[n];return i.splice(n,1),o(t),t},this.remove=function(n){var r=null,t=i.length;while(t--)if(i[t]===n){r=this.removeAt(t);break}return r},this.clear=function(){while(i.length>0)this.pop()},this.indexOf=function(n){var t=i.length;while(t--)if(i[t]===n)break;return t},this.setOptions(t)}function cu(n,t){this._location=n,this.setOptions(t,!1)}function g(n,t){g.baseConstructor.call(this,n,t),this.setOptions(t)}function nr(n,i){this._location=n,i&&typeof i.useTransform3d=="boolean"&&(this._useTransform3d=i.useTransform3d),this._icon=t.pushpinImageUrl,this.setOptions(i)}function gi(n,t){this._locations=n,this.setOptions(t)}function tr(n,t){this._locations=n,this.setOptions(t)}function sr(t){var u=this,a=!0,c=0,s=1,e={},l=br.auto,f=!0,i=1e4,o,r;this.setOptions=function(t){if(t){var r=!1;typeof t.visible=="boolean"&&(a=t.visible,r=!0),typeof t.reproject=="boolean"&&(f=t.reproject,r=!0),ai(t.zIndex)&&(c=t.zIndex,r=!0),ai(t.opacity)&&(s=t.opacity,r=!0),t.animationDisplay&&(l=t.animationDisplay,r=!0),t.downloadTimeout!==h&&(i=t.downloadTimeout,typeof i=="number"&&i>0||(i=1e4),r=!0),r&&n.invoke(u,"entitychanged",{entity:u})}},o=typeof ut!="undefined"?ut:{mercator:{}};for(r in o)t[r]instanceof tu&&(e[r]=t[r]);this.getVisible=function(){return a},this.getZIndex=function(){return c},this.getOpacity=function(){return s},this.getAnimation=function(){return l},this.getReproject=function(){return f},this.getDownloadTimeout=function(){return i},this.getTileSource=function(n){return e[n]},this.setOptions(t)}function tu(n){var f=t.defaultTileSize,u=t.defaultTileSize,i,r;isFinite(n.width)&&(f=n.width),isFinite(n.height)&&(u=n.height),typeof n.uriConstructor=="string"?(i=n.uriConstructor,r=n.uriConstructor):(typeof n.uriConstructor=="function"&&(i=n.uriConstructor),typeof n.uriFormat=="string"&&(r=n.uriFormat)),this.getWidth=function(){return f},this.getHeight=function(){return u},this.getUriConstructor=function(){return i},this.getUriFormat=function(){return r}}function nu(n){this._map=n,this.dispose=function(){this._map=null}}function wu(t){function c(){f=n.addHandler(r,"ondispose",e),nt.load(h,{callback:function(){s.Analytics&&s.Analytics.AnalyticsManager&&r&&(o=!0,u=new s.Analytics.AnalyticsManager(r))}})}function i(n,t){u?u[n].apply(u,t):!o&&r&&nt.add(h,l,n,t)}function e(){i("dispose",arguments),u=r=null,n.removeHandler(f),f=null}var l=this,h="Microsoft.Maps.Analytics",r=t,f=null,u=null,o=!1;this.logClientAction=function(){i("logClientAction",arguments)},this.addPreProcessor=function(){i("addPreProcessor",arguments)},this.removePreProcessor=function(){i("removePreProcessor",arguments)},this.registerAction=function(){i("registerAction",arguments)},this.registerChildActions=function(){i("registerChildActions",arguments)},this.enable=function(){i("enable",arguments)},this.dispose=e,c()}function r(n,t,i){this.x=n,this.y=t,this.z=i}function lt(n,t){this.width=n,this.height=t}function pt(n,t,i,r){this.x=n,this.y=t,this.width=i,this.height=r}function yt(n,t,i,r,u,f){this.m11=n,this.m12=t,this.m21=i,this.m22=r,this.offsetX=u,this.offsetY=f}function e(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.m11=n,this.m12=t,this.m13=i,this.m14=r,this.m21=u,this.m22=f,this.m23=e,this.m24=o,this.m31=s,this.m32=h,this.m33=c,this.m34=l,this.offsetX=a,this.offsetY=v,this.offsetZ=y,this.m44=p}function ri(n,t,i,r){this.a=n,this.b=t,this.c=i,this.d=r}function gt(n,t){this.x=n,this.y=t}function rt(n,t,i){this.levelOfDetail=n,this.x=t,this.y=i}function f(n,u,o,s,c,l,v,y,p,w){function k(){var c,o,w,v;if(!gt){ut=s===0&&et===-90&&l===0,ft=ut||st<=bt,lt=ft&&ut?f.simpleGround:ri.fromNormal(nt,rt.getUpVector(nt));var n=f.simpleWorldToFrustumNoZ,u=1/g,i=g*1e3;tt=rt.getNadirMatrix(nt),ut||(tt=e.multiply(tt,e.rotationZ(-vt),e.rotationX(-(et+90)),e.rotationZ(-ct)));if(ft)ut?(n.m22=n.m11=u,n.m33=u*-.001,n.offsetX=tt.offsetX*u,n.offsetY=tt.offsetY*u):n=e.multiply(tt,e.scaling(u,u,1/i));else{var y=Math.pow(2,kt)*g,h=1/st,p=h/y;i=Math.min(h*.99,i),c=h-i,o=h+i,n=e.multiply(tt,e.translation(wt),e.translation(0,0,h),new e(p,0,0,0,0,p,0,0,0,0,o/(o-c),1,0,0,c*o/(c-o),0),e.scaling(y/g,y/g,1)),w=n.transform(nt),n.multiplyBy(e.translation(r.multiply(w,-1)))}ut?ot=n.clone():(ht=n.invert().projectOnPlane(lt),ot=ht.invert()),ut?(d=ot.clone(),d.m11*=b,d.m22*=b,d.m33*=b,d.offsetX*=b,d.offsetY*=b,v=g/b,it=tt.clone(),it.m11*=v,it.m22*=v,it.m33*=i/b,it.offsetX*=-1,it.offsetY*=-1):(d=e.multiply(ot,e.scaling(b)),it=d.invert()),dt=rt.toLocation(nt),pt=f.widthToMercatorZoom(g,rt,nt),at=rt.unitsToMeters(nt,g)/t.zoomOriginWidth,yt=!ft||Math.abs(et+90)>bt||rt!==a,gt=!0}}var ni=this;var rt=n,nt=u,g=o,vt=s||0,et=c===h?-90:c,ct=l||0,st=v||0,kt=y||0,wt=p||new r(0,0,0),ut,ft,lt,tt,ot,ht,d,it,dt,pt,at,yt,b=w||t.zoomOriginWidth,gt=!1;this.getCrs=function(){return rt},this.getLookAt=function(){return nt},this.getWidth=function(){return g},this.getHeading=function(){return vt},this.getPitch=function(){return et},this.getRoll=function(){return ct},this.getDistanceInverse=function(){return st},this.getZoomDelta=function(){return kt},this.getPerspectiveOrigin=function(){return wt},this.getZoomOriginWidth=function(){return b},this.getGroundPlane=function(){return k(),this.getGroundPlane=function(){return lt},lt},this.getWorldToViewport=function(){return k(),this.getWorldToViewport=function(){return d},d},this.getViewportToWorld=function(){return k(),this.getViewportToWorld=function(){return it},it},this.getWorldToFrustum=function(){return k(),this.getWorldToFrustum=function(){return ot},ot},this.getFrustumToWorld=function(){return k(),this.getFrustumToWorld=function(){return ht},ht},this.getCenter=function(){return k(),this.getCenter=function(){return dt},dt},this.getMercatorZoom=function(){return k(),this.getMercatorZoom=function(){return pt},pt},this.getMetersPerPixel=function(){return k(),this.getMetersPerPixel=function(){return at},at},this.getNeedsElevation=function(){return k(),this.getNeedsElevation=function(){return yt},yt},this.getAlignedCamera=function(n,t,r,u){var s,h;k();var v=g/Math.pow(2,n),o,l=null,c=0,a=null;return t?(o=t,ft||(a=e.multiply(tt,e.translation(wt)),l=a.transform(o),c=n+kt)):o=nt,s=vt,u&&(s=s+u),c=0,h=new f(rt,o,v,s,et,ct,st,c,l,b),r&&(o=h.getViewportToWorld().transform(new i(-r.x,-r.y)),ft||(l=a.transform(o)),h=new f(rt,o,v,s,et,ct,st,c,l,b)),h}}function yi(n){var u=this,e=n,f=2,i=y+"count",t=[{}],r;t[0][i]=0,this.get=function(n,i){var r,e=t.length,f=!0;while(e--){r=t[e][n];if(r!==h)return i&&!f&&u.insert(n,r),r;f=!1}},this.insert=function(n,o){var v,s,l,c,a;v=!1,s=t[t.length-1];if(s[n]===h)if(s[i]<e)s[i]++;else{s={},s[i]=0,t.push(s);if(t.length>f){l=t.shift();if(r)for(c in l)c!==i&&l.hasOwnProperty(c)&&(a=l[c],a!==u.get(c)&&r(a))}}else v=!0;return s[n]=o,v},this.useDisposer=function(n){r=n}}function ht(n,t,i,r,u){this.nativeCamera=n,this.maxLocalZoom=i,this.minLocalZoom=0,this.tilePyramid=t,this.imageryId=r,this.copyrightProvider=u,this.needsElevation=n.getNeedsElevation()||t&&t.projectingCamera&&t.projectingCamera.getNeedsElevation()}function vt(){function hu(){var n=y.getOptions();return!(n.disablePanning||n.disableMouseInput||n.disableUserInput)}function cu(){n.invoke(s,"copyrightchanged")}function pi(n,i){var c;if(i&&f.areEqual(e,n))return;fi&&(n=ft.adjustCameraElevation(n)),e=n,ut=n,c=!1,wi<1/t.maxFPS&&(i=!1);if(i){ut=f.snapSmallDifferences(ft.adjustCameraElevation(l),e),f.areEqual(ut,e)&&(i=!1);if(i){var r=new lt(o.width*1.2,o.height*1.2),h=pt.union(tt.getMercatorFootprint(ut,r)),u=pt.union(tt.getMercatorFootprint(e,r));pt.intersect(h,u)||(i=!1)}}i?(et=new Date(new Date-(s.usingCssAnimation()?0:yu)),rt(),i!=!0&&(vt=i)):(et=new Date(0),g=null,vi())}function ui(t,i,u,o,h,c,l){var v,k,b,et=y.getZoomRange(),tt=i,w=f.widthToMercatorZoom(o,t,i),ot,a,nt,ht,g,p,ut,it;w=Math.max(w,et.min),w=Math.min(w,et.max),ot=2,fi=!1;while(ot--){k=t.toLocation(tt),a=null,nt=st.length;while(nt--){a=st[nt].getScene(d,k.latitude,k.longitude,w,h,tr),a&&a.needsElevation&&(ht=ft.isElevationAvailableAtLatLon(k.latitude,k.longitude,w),fi=!0,ht||(a=null));if(a)break}a=a||gr,a=ri?d:a;if(b&&v===a)break;v=a,g=v.nativeCamera,p=w-f.widthToMercatorZoom(g.getWidth(),g.getCrs(),g.getLookAt()),dr&&(p=l?Math.floor(p):Math.round(p)),p=Math.min(p,v.maxLocalZoom),p=Math.max(p,v.minLocalZoom),b=v.nativeCamera.getAlignedCamera(p,i,u);if(r.areAlmostEqual(tt,b.getLookAt()))break;tt=b.getLookAt()}gi(fi);if(c&&f.areEqual(e,b)&&v===d)return;ut=v.imageryId!==d.imageryId,it=v!==d,d=v,pi(b,c),rt(),it&&(n.invoke(s,"scenechanged"),cu()),ut&&n.invoke(s,"imagerychanged")}function gt(){var n=ft.adjustCameraElevation(e);ui(n.getCrs(),n.getLookAt(),null,n.getWidth(),ni!=null?ni:n.getHeading(),!0)}function vi(){var nt,h,t,p;b.cancelDispatch(vi);if(!yi||hi)return;hi=!0;var c=!1,y=!0,v=!0,i,a;ot.processPendingUserInput(),lt.areEqual(tu,o)||(i=!0,a=!0),tu=o,fr&&(i=!0,a=!0,v=!1,fr=!1),et&&(nt=l,h=pr(),e.getMercatorZoom()>ut.getMercatorZoom()?h<wu&&(y=!1):h<vu&&(y=!1),h>1?(t=e.getLookAt(),kt&&(t=e.getCrs().wrap(t)),t.y<0?t.y=0:t.y>1&&(t.y=1),r.areAlmostEqual(e.getLookAt(),t)||(v=!1,e=e.getAlignedCamera(0,t)),l=e,ut=e,et=null):(l=wr(h),c=!0),f.areAligned(nt,e)||(v=!1),i=!0),w.allowTileGridSwitch=y;var tt=!sr&&i,u=sr&&!i,k=new Date;u&&k-ou<=fu&&(u=!1,c=!0),sr=i||c,i&&(ou=k,c=!0),f.areEqual(kr,e)||(a=!0),(a||u)&&((u||!w.canCssAnimate())&&(g=null),!s.usingCssAnimation()&&ci&&(ur(),ci=!1),w.enableOrDisableCssAnimation(g,u),yt.enableOrDisableCssAnimation(g)),kr=e,w.render(o,l,d.tilePyramid,e),p=tt?0:u?2:1,yt.update(o,l,e,v,p),a&&n.invoke(s,"targetviewchanged"),tt&&n.invoke(s,"viewchangestart"),i&&n.invoke(s,"viewchange",{linear:v,userInitiated:si}),u&&(n.invoke(s,"viewchangeend",{userInitiated:si}),si=!0,cu()),hi=!1,c&&rt()}function pr(){var n=0,t;return s.usingCssAnimation()?n=g.getStartTime()<et?0:g.getElapsedTimeAsPercentage():(t=new Date,n=vt>0?Math.min(1,(t-et)/vt):(t-et)/1e3/wi),n}function wr(n){var i=l,t=0;return s.usingCssAnimation()?t=g.getProgress(n):vt>0?(n<1||(vt=0),t=1-Math.pow(1-n,4)):t=n<=.5?Math.pow(n*2,2)*.5:Math.pow((1-n)*2,2)*-.5+1,t<0||t>1||(i=f.lerp(ut,e,t)),i}function hr(){if(y){var t=y.getWidth(),n=y.getHeight();(o.width!==t||o.height!==n)&&(o=new lt(y.getWidth(),y.getHeight()),rt())}}function rt(){b.dispatch(vi)}function cr(n){n&&w.suspendGettingNewTiles(),ri=!0}function ur(){w.allowGettingNewTiles(),ri&&(ri=!1,gt(),rt())}function ar(n){var u=n.getViewportToWorld(),r=n.getCrs(),t=yr(r.toLocation(u.transform(new i(-o.width/2,-o.height/2))),r.toLocation(u.transform(new i(o.width/2,-o.height/2))),r.toLocation(u.transform(new i(o.width/2,o.height/2))),r.toLocation(u.transform(new i(-o.width/2,o.height/2))));return t.center=new p(t.center.latitude,t.center.longitude),t}function yr(){var o=arguments,r,u,t,i,s,e,n,f=o.length;while(f--)n=o[f],isFinite(n.latitude)&&isFinite(n.longitude)&&(r=r===h||isNaN(r)?n.latitude:Math.max(r,n.latitude),u=u===h||isNaN(u)?n.latitude:Math.min(u,n.latitude),i=i===h||isNaN(i)?n.longitude:Math.max(i,n.longitude),t=t===h||isNaN(t)?n.longitude:Math.min(t,n.longitude),isFinite(n.altitude)&&dt.isValid(n.altitudeReference)&&(e=n.altitude,s=n.altitudeReference));return ct.fromEdges(r,t,u,i,e,s)}function pu(n){return f.areEqual(n.nativeCamera,ht.nativeMercatorCamera)}function vr(){var t,n;nt=y.getOptions(),ot.enableOrDisableUserInput(!0,nt),t=.9,nt.inertiaIntensity!==h&&nt.inertiaIntensity!==-1&&(t=nt.inertiaIntensity),ot.enableOrDisableInertialScrolling(nt.useInertia,t),n=nt.labelOverlay,n!==tr&&it.isValid(n)&&(tr=n,gt()),nt.showBackground!==h&&w.showBackground(nt.showBackground),w.setBufferSize(nt.tileBuffer)}function gi(t){t?wt||(wt=n.addThrottledHandler(s,"targetviewchanged",br,500),b.dispatch(br)):(lr(),n.removeHandler(wt),wt=null)}function br(){wt&&(lr(),ei=ft.downloadElevationData(e,o),ei&&(di=n.addHandler(ei,"downloaded",lu)))}function lr(){n.removeHandler(di),di=null,ft.cancelDownload(ei)}function lu(n){fr=!n.cacheHit,gt(),rt()}var s=this,yi=!1,au="cm"+li.getNext(),y=null,at=null,ki=null,nr=null,ot=null,gr=ht.createMercatorScene(null,"Mercator",null),d=gr,l=d.nativeCamera,e=l,ut,ni,ri,ci,bu=k(null,u.safariRenderHack),st=[],oi=[],tr=it.visible,et,vt=0,rr=!1,g=null,o=new lt(800,600),tu,w=new iu,hi;n.addHandler(w,"tiledownloadcomplete",function(){n.invoke(s,"tiledownloadcomplete")});var ru,yt=new er,uu=!1,nu=!1,sr=!1,kr,fr=!1,or,nt,kt=!0,dr=!0,wt,ei,di,fi,ii,bi={Grab:"url("+t.cursorPath+"grab.cur)"+u.cursorHotspot+", move",Grabbing:"url("+t.cursorPath+"grabbing.cur)"+u.cursorHotspot+", move",SEResize:"se-resize"},yu=1e3/30,wi=.3,vu=.1,wu=.4,ou=new Date(0),fu=200,si=!0;this.activating=function(t){y=t,or=n.addHandler(t,"resize",hr),hr()},this.activated=function(){at=y.getModeLayer(),ki=y.getRootElement(),nr=v(ki),at.appendChild(w.getRootElement()),ru=k("div","position:absolute;z-index:0;left:0;top:0;"+u.safariRenderHack,at),yt.activate(y,s,w,ru,au+"_er"),ot=new su(s,y,new eu(s,y),nr,yt,!0),vr(),n.removeHandler(ii),ii=n.addHandler(y,"optionschanged",vr),gi(d.needsElevation),yi=!0,rt()},this.deactivating=function(){n.removeHandler(ii),ii=null,gi(!1),n.removeHandler(or),or=null,ot.enableOrDisableUserInput(!1,nt),pi(e,!1),yt.deactivate(),at.removeChild(w.getRootElement()),w.disposeTiles(),ot=null,nr=null,ki=null,at=null,y=null,yi=!1},this.getInternalMaxZoom=function(){return t.maxMercatorZoom},this.getInternalMinZoom=function(){return t.minMercatorZoom},this.setView=function(n){var y=e.getCrs(),w,t,nt=null,i=n.bounds,rt=!1,it;n.userInitiated===!1&&(si=n.userInitiated);if(i instanceof ct){if(n.center){t=n.center;var r=i.getNorthwest(),ut=new p(t.latitude*2-r.latitude,t.longitude*2-r.longitude,r.altitude,r.altitudeReference),v=i.getSoutheast(),et=new p(t.latitude*2-v.latitude,t.longitude*2-v.longitude,v.altitude,v.altitudeReference);i=yr(r,v,ut,et)}else t=y===a?tt.getMercatorCenter(i):i.center.clone();it=ai(n.padding)?new lt(Math.max(1,o.width-n.padding),Math.max(1,o.height-n.padding)):o,w=tt.locationRectToMercatorZoom(it,i),rt=!0}else n.center&&(t=n.center,nt=n.centerOffset),ai(n.zoom)&&(w=n.zoom);var l=!1,k=e.getLookAt(),g=e.getWidth(),b=e.getHeading(),d=!0;t&&(k=y.fromLocation(ft.toEllipsoid(t)),l=!0),ai(w)&&(g=f.mercatorZoomToWidth(w,y,k),l=!0),ai(n.heading)?(b=c.normalizeDegrees(n.heading),ni=b,l=!0):ni=null,n.animate===!1&&(d=n.animate,l=!0),n.suspend!==h&&(n.suspend?cr(!0):ur()),n.useCssAnimations!==h&&(rr=u.allowCssAnimations&&n.useCssAnimations),l&&(d&&s.requestCssAnimation(),ui(y,k,nt,g,b,d,rt))},this.setWrapping=function(n){kt=n},this.getCenter=function(){var n=l.getCenter();return new p(n.latitude,n.longitude)},this.getZoom=function(){return l.getMercatorZoom()},this.getHeading=function(){return l.getHeading()},this.getBounds=function(){return ar(l)},this.getMetersPerPixel=function(){return l.getMetersPerPixel()},this.getTargetCenter=function(){var n=e.getCenter();return new p(n.latitude,n.longitude)},this.getTargetZoom=function(){return e.getMercatorZoom()},this.getTargetHeading=function(){return e.getHeading()},this.getTargetBounds=function(){return ar(e)},this.getTargetMetersPerPixel=function(){return e.getMetersPerPixel()},this.tryLocationToViewport=function(n,t){return this.internalTryLocationToViewport(l,n,t&&t.referenceLocation)},this.tryViewportToLocation=function(n,t){return this.internalTryViewportToLocation(l,n,!0,!t||t.normalizeLongitude!==!1)},this.internalTryLocationToViewport=function(n,t,i){var u,f,o=n.getCrs(),s=n.getWorldToViewport(),y=n.getDistanceInverse()<bt,v=!n.getNeedsElevation(),c=n.getLookAt();if(t.latitude!==h)return u=o.fromLocation(ft.toEllipsoid(t,v)),kt&&(u=o.wrap(u,c)),f=s.transform(u),y||f.z>=-1&&f.z<=1?f:null;var e=t.length,l=new Array(e),p=null;if(!n.getPerspectiveOrigin().isZero()){var b=n.getViewportToWorld(),k=new r(0,n.getZoomOriginWidth()*6,0),a=b.transform(k),w=a.x*s.m14+a.y*s.m24+a.z*s.m34+s.m44;p=w}i&&(u=o.fromLocation(ft.toEllipsoid(i,v)),kt&&(c=i=o.wrap(u,c)));while(e--)u=o.fromLocation(ft.toEllipsoid(t[e],v)),kt&&(u=o.wrap(u,c)),c=i||u,f=s.transform(u,p),l[e]=y||f.z>=-1&&f.z<=1?f.toPoint():null,l[e]&&(l[e].shouldUseMoveTo=t[e].shouldUseMoveTo);return l},this.internalTryViewportToLocation=function(n,t,i,u){var s=n.getCrs(),h=n.getViewportToWorld(),e,f,o,c;if(ir(t)){o=t.length,c=new Array(o);while(o--)e=h.transform(t[o]),i&&(e=ft.rayToGround(s,e,h.transform(new r(t[o].x,t[o].y,1)))),f=s.toLocation(e),f=new p(f.latitude,u!==!1?p.normalizeLongitude(f.longitude):f.longitude),c[o]=s.toLocation(e);return c}return e=h.transform(t),i&&(e=ft.rayToGround(s,e,h.transform(new r(t.x,t.y,1)))),f=s.toLocation(e),f=new p(f.latitude,u!==!1?p.normalizeLongitude(f.longitude):f.longitude)},this.isDownloadingTiles=function(){return w.isDownloadingTiles()},this.getTileDownloadMetrics=function(){return w.getTileDownloadMetrics()},this.getImageryId=function(){return d.imageryId?d.imageryId:""},this.isRotationEnabled=function(){return d.imageryId==="EnhancedBirdseye"||d.imageryId==="NativeBirdseye"},this.isMercator=function(){return pu(d)},this.getCopyrights=function(n){return n&&d.copyrightProvider?d.copyrightProvider.getCopyrights(s.getBounds(),l.getMercatorZoom(),l.getHeading(),n):n&&n([]),[]},this.setSceneContributors=function(t){var i=oi.length;while(i--)n.removeHandler(oi[i]);oi.length=0,i=t.length,st.length=i;while(i--)st[i]=t[i],oi.push(n.addHandler(st[i],"newsceneavailable",gt));st.sort(function(n,t){return n.priority-t.priority}),rt(),gt()},hi=!1,this.ensureUpdateDispatched=function(n){n?vi():rt()},this.getTargetCamera=function(){return e},this.getCurrentCamera=function(){return l},this.getCameraAnimationDuration=function(){return wi},this.setAlignedCamera=function(n,t,i,r,u,f,e){ni=null,ui(n,t,i,r,u,f,e)},this.setCamera=function(n,t){pi(n,t)},this.allowSceneChanges=function(){ur()},this.suspendSceneChanges=function(n){cr(n)},this.requestCssAnimation=function(n){return rr&&(ci=n,g=n?ti.Flicker:ti.Transformer,g=g.duplicate(),g.isFlick=n),g},this.canUseCssAnimations=function(){return rr},this.usingCssAnimation=function(){return g!=null},this.haltCssAnimation=function(){if(s.usingCssAnimation()){var t=pr(),n=wr(t);ci=!1,ui(n.getCrs(),n.getLookAt(),null,n.getWidth(),n.getHeading(),!1)}},this.getCursors=function(){var n="default";return{Grab:hu()?bi.Grab:n,Grabbing:hu()?bi.Grabbing:n,SEResize:bi.SEResize}},this.getPublicApi=function(){return{tryPixelToMercatorPoint:function(n){return s.getTargetCamera().getViewportToWorld().transform(n)},setViewChangeEndDelay:function(n){var n=parseInt(n);n<0||(fu=n)},canReprojectTileLayers:function(){return u.animateOverlayLayers},enableOrDisableZoomLevelSnap:function(n){dr=n===!0,ot.setTouchZoomThreshold(n===!0?.1:0)},setPartialZoomBias:function(n){w&&w.setPartialZoomBias(Math.min(.5,Math.max(-.5,n)))},setOptions:function(t){var i=!1;t&&(typeof t.shouldClipPolygons=="boolean"&&(nu=t.shouldClipPolygons,i=!0),typeof t.drawShapesInSingleLayer=="boolean"&&(uu=t.drawShapesInSingleLayer,i=!0),i&&n.invoke(y,"modeoptionschanged"))},setDrawShapesInSingleLayer:function(n){this.setOptions({drawShapesInSingleLayer:n})},getDrawShapesInSingleLayer:function(){return uu},getShouldClipPolygons:function(){return nu}}}}function ot(n,t,i,r){function l(n){return((o*n+f)*n+u)*n}function h(n){return((a*n+s)*n+e)*n}function c(n){return(3*o*n+2*f)*n+u}function v(n,t){for(var f,u,i=n,r=0;r<9;r++){f=l(i)-n,u=c(i);if(Math.abs(f)<t||Math.abs(u)<1e-6)break;i=i-f/u}return i}var y=this;this.cssText="cubic-bezier("+n+","+t+","+i+","+r+")";var u=3*n,e=3*t,f=3*(i-n)-u,s=3*(r-t)-e,o=1-u-f,a=1-e-s;this.getProgress=function(n,t){return h(v(n,t))}}function pu(n,t,i,r){this.animationSequence=n,this.node=t,this.isComplete=i,this.nodeHasPendingAnimations=r}function au(n,t){this.url=n,this.timeout=t}function kt(n,t,i,r,u,f,e,o,s,h,l){var v=c.ceilLog2(Math.max(n,t)),a;this.getWidth=function(){return n},this.getHeight=function(){return t},this.getTileWidth=function(){return i},this.getTileHeight=function(){return r},this.getTileOverlap=function(){return u},this.getTileBorder=function(){return f},this.getOffsetX=function(){return e},this.getOffsetY=function(){return o},this.getMaxLevelOfDetail=function(){return v},this.getUrl=s,this.getReplacementTileId=h,a=l?l:5e3,this.getDownloadTimeout=function(){return a}}function rr(r,o,s){function wi(){if(d&&d.length){var t=d.length;while(t--)n.removeHandler(d[t]),bi.removeDownloadBasket(d[t]);d=null}}function ki(){var yr=Math.round((h.x+v.x)/2),pr=Math.round((h.y+v.y)/2),lt=[],ii=k(),yi,i,yt,e,b,sr,pt,oi,ur,r,f,s,pi,o,or,ai,vi,hr,ki,vr;for(bt=0,gt=0,it=[],kt=[],wt={},wi(),d=[],pt=0,oi=0,r=h.y;r<=v.y;r++){pt=0,ur=!1;var ar=ot&&ot.y<=r&&ht&&ht.y>=r,dr=r>=vt.y&&r<=at.y,kr=r>=ut.y&&r<=et.y;for(f=h.x;f<=v.x;f++){yi=new rt(h.levelOfDetail,f,r),i=null;var br=ot&&ot.x<=f&&ht&&ht.x>=f,gr=f>=vt.x&&f<=at.x,wr=f>=ut.x&&f<=et.x,li=!1,lr=!1;!hi||br&&ar||wr&&kr||(lr=!0),e=c.getUrl(yi,dt),e&&!lr&&(b=bi.getState(e),b!=st.failed||ui?(s=rr,pi=0,f===0&&(s-=nt,s+=tt,pi=-tt),f===fr&&(s-=nt,s+=tt),o=nr,or=0,r===0&&(o-=nt,o+=tt,or=-tt),r===er&&(o-=nt,o+=tt),i=k("img"),yt="width:"+s+"px;height:"+o+"px;border:0px;",ni.requireFlowLayout?(pt&&(yt+="margin-left:"+pt*g+"px;"),oi&&(yt+="margin-top:"+oi*p+"px;")):(ai=(f-h.x)*g+pi,vi=(r-h.y)*p+or,i[y+"leftOffset"]=ai,i[y+"topOffset"]=vi,yt+="position:absolute;",yt+=u.useTransform3d?w.Attributes.transform+":translate3d("+ai+"px,"+vi+"px,0px);":"left:"+ai+"px;top:"+vi+"px"),i.style.cssText=yt,i[y+"tileId"]=yi,i[y+"tileUrl"]=e,i[y+"tileHeight"]=o,i[y+"tileWidth"]=s,i.width=s,i.height=o,i.border=0,ui&&b==st.failed&&(i=di(i),li=i!=!1,i&&(e=i[y+"tileUrl"],b=bi.getState(e))),i&&(b===st.ready||b===st.cacheExpired&&(br&&ar||li)?(hr=wr&&!gr&&kr&&!dr,!hr||hi||li?i.src=e:(i.style.visibility="hidden",kt.push(i))):(i.style.visibility="hidden",it.push(i)),b!=st.ready&&(sr=new au(e,ir),sr.priority=(yr-f)*(yr-f)+(pr-r)*(pr-r),lt.push(sr)),ci.push(i))):a.isOverlay||gt++,bt++),i||li?(pt=0,ur=!0,i&&(li?tr(i,ii):ii.appendChild(i))):pt++}ur?(oi=0,ni.requireFlowLayout&&k("br",null,ii)):oi++}if(u.useImageDisposer){ki=ct.length;while(ki--)ct[ki].src=t.spacerImageUrl}ct.length=0,vr=ct,ct=ci,ci=vr,(u.useTransform3d||u.useTransform2d)&&(ri=this.hideWhileAnimating?ni.setExactTransformOrHide(ft,ti,a.opacity):ni.setTransformAndOpacity(ft,ti,a.opacity,{explicitOpacity:!0})),ii.style.cssText=ri,l.parentNode&&l.parentNode.replaceChild(ii,l),l=ii,fi(),si&&lt.length&&(lt.basketId=a,lt.sort(ku),cr+=lt.length,d.push(n.addHandler(lt,"hasnewtiles",gi)),bi.setDownloadBasket(lt,dt)),ei()}function ei(){kt.length&&b.dispatch(pi),n.invoke(a,"tilesrendered")}function pi(){var t,n;b.cancelDispatch(pi);if(a.allowTileRender){t=Math.min(kt.length,lr);while(t--)n=kt.shift(),n.style.visibility="visible",n.src=n[y+"tileUrl"]}ei()}function gi(){var r;if(si){var u=it.length,f=!0,t=[];while(u--&&f){var e=!0,i=it[u],o=i[y+"tileUrl"],s=bi.getState(o);switch(s){case st.ready:kt.push(i);break;case st.failed:ni.requireFlowLayout?f=!1:(l.removeChild(i),ar(i,t));break;default:e=!1}e&&it.splice(u,1)}f?(ei(),t.length&&(r=n.addHandler(t,"hasnewtiles",gi),d.push(r),t.basketId=r,bi.setDownloadBasket(t,dt))):ki()}}function ar(n,t){if(!ui){gt++;return}var i=di(n);i&&(i.style.visibility="hidden",it.push(i),ct.push(i),t.push(new au(i[y+"tileUrl"],ir)),tr(i,l))}function di(n){var e=n[y+"tileId"],b=e.toString(),v=wt[b]?wt[b]:1,i=c.getReplacementTileId(n[y+"tileId"]),p=c.getUrl(i,dt),t=!1,r;if(p){r=i.toString();if(wt[r])t=null;else{var f=Math.pow(2,e.levelOfDetail-i.levelOfDetail),w=n[y+"tileWidth"],a=n[y+"tileHeight"],o=w*f,s=a*f,l=(i.x*f-e.x)*w+n[y+"leftOffset"],h=(i.y*f-e.y)*a+n[y+"topOffset"];t=k("img"),t[y+"leftOffset"]=l,t[y+"topOffset"]=h,t[y+"tileHeight"]=s,t[y+"tileWidth"]=o,t[y+"tileId"]=i,t[y+"tileUrl"]=p,t[y+"lod"]=i.levelOfDetail,t.style.cssText="position:absolute;left:"+l+"px;top:"+h+"px;width:"+o+"px;height:"+s+"px;border:0px;"+u.safariRenderHack,t.width=o,t.height=s,t.border=0,wt[r]=0}wt[r]+=v}else gt+=v;return t}function tr(n,t){var i=t.firstChild,u=n[y+"tileId"],r;while(i){r=i[y+"lod"];if(!r||r>=u.levelOfDetail){t.insertBefore(n,i);break}i=i.nextSibling}i||t.appendChild(n)}var a=this,ii,fi;var l=k(),h,v,ut,et,vt,at,ot,ht,hi=!1,oi=0,sr,ti,ri="",cr=0,bt=0,gt=0,ui=!1,si=!0,c=r,g,p,nt,tt,rr,nr,yt,ai,li,ur,fr,er,vi,yi,ft=e.identity(),or,hr,ct=[],ci=[],it=[],kt=[],wt={},d,lr=3,dt,ir=c.getDownloadTimeout();this.levelOfDetail=o,this.opacity=1,this.isOverlay=!1,this.hideWhileAnimating=!1,this.allowTileRender=!0,g=c.getTileWidth(),p=c.getTileHeight(),nt=c.getTileOverlap(),tt=c.getTileBorder(),rr=g+2*nt,nr=p+2*nt,ii=Math.pow(2,c.getMaxLevelOfDetail()-o),yt=Math.ceil(c.getWidth()/ii),ai=Math.ceil(c.getHeight()/ii),yt=Math.ceil(yt),fr=Math.ceil(yt/g)-1,er=Math.ceil(ai/p)-1,li=e.multiply(c.projectingCamera.getWorldToFrustum(),e.scaling(yt),e.translation(yt/2+c.getOffsetX()/ii,ai/2+c.getOffsetY()/ii,0)),ur=li.invert(),s&&(dt=!0),this.populate=function(n,t,r,u){var s,c,k,b;if(f.areEqual(n,or)&&lt.areEqual(t,hr)&&oi==r)return;or=n,hr=t;var a=e.multiply(n.getViewportToWorld(),li),y=Math.ceil(t.width/2),w=Math.ceil(t.height/2),l=pt.union(a.transform(new i(-y,-w)),a.transform(new i(y,-w)),a.transform(new i(y,w)),a.transform(new i(-y,w)));s=new rt(o,Math.floor(l.x/g),Math.floor(l.y/p)),c=new rt(o,Math.floor(l.getRight()/g),Math.floor(l.getBottom()/p)),(!vt||!at||r>oi||vt.x>s.x||vt.y>s.y||at.x<c.x||at.y<c.y)&&(vi=null,hi=u,oi=r,vt=s,at=c,ot=ut,ht=et,ut=s.clone(),ut.x-=r,ut.y-=r,et=c.clone(),et.x+=r,et.y+=r,h=ut.clone(),v=et.clone(),u&&(h.x=Math.min(ot.x,h.x),h.y=Math.min(ot.y,h.y),v.x=Math.max(ht.x,v.x),v.y=Math.max(ht.y,v.y)),sr=e.multiply(e.translation(h.x*g,h.y*p,0),ur),k=v.x-h.x+1,b=v.y-h.y+1,ti=new lt(k*g,b*p),ki())},this.render=function(n,t){var i,r,o;f.areEqual(n,vi)&&yi===a.opacity||(ft=e.multiply(sr.projectOnPlane(n.getGroundPlane()),n.getWorldToViewport()),t&&(ft.offsetX+=t,ft.offsetY+=t),i={explicitOpacity:!this.hideWhiteAnimating},r=this.hideWhileAnimating?ni.setExactTransformOrHide:ni.setTransformAndOpacity,u.useTransform3d||u.useTransform2d?(i.includeCommonCss=!1,i.returnStyleObject=!0,o=r(ft,ti,a.opacity,i),l.style[w.Properties.transform]=o[w.Properties.transform],a.opacity!=yi&&(l.style.opacity=a.opacity)):(ri=r(ft,ti,a.opacity,i),l.style.cssText=ri),fi()),yi=a.opacity,vi=n},this.getRootElement=function(){return l},this.getTilePyramid=function(){return c},this.getDownloadProgress=function(){return bt>0&&it?1-it.length/bt:1},this.getTileDownloadMetrics=function(){return cr},this.getNoImageTileRatio=function(){return bt>0?gt/bt:0},this.enableOrDisableScaledTiles=function(n){ui=n&&!ni.requireFlowLayout&&!tt&&!nt&&typeof c.getReplacementTileId=="function"},this.stopDownloading=function(){si=!1,bi.removeDownloadBasket(a)},this.dispose=function(){a.stopDownloading(),wi(),l&&l.parentNode&&l.parentNode.removeChild(l)},fi=function(){},u.useFilterReflowWorkaround&&ni.usingIEFilters&&(fi=function(){l.offsetWidth})}function iu(){function st(n,t,i){return n&&n.getTilePyramid()===t&&n.levelOfDetail===i}function s(t){if(t){if(d!=null){var i=t.getRootElement();d.removeAnimations(i)}n.removeHandler(t.rendererHandler),t.dispose()}}function fi(){s(r),r=null,s(h),h=null,e=o.none}function tt(){var st,t,f,lt,dt,k;b.cancelDispatch(tt);var c,gt=!1,ni=!1,ct=!1,ui=e>o.none,ti=!1,w=e===o.readyForTarget?a:it;g?ft&&(ot||(st=hi(),gt=st.keepGoing,ct=st.gridsAdded,ti=st.shouldSwapTileGrids),ei&&si()):(s(i),i=null,s(h),h=null,s(nt),nt=null,s(p),p=null,s(y),y=null),e<o.started&&(i&&(i.getDownloadProgress()<1&&(ni=!0),i.render(w)),h&&h.render(w),nt&&nt.render(w),r&&ui&&(r.render(w),bt(r)),p&&p.render(w,1),y&&y.render(w,1)),e===o.readyForTarget&&(r&&d.addToGroup(r.getRootElement()),i&&d.addToGroup(i.getRootElement()),p&&d.addToGroup(p.getRootElement()),y&&d.addToGroup(p.getRootElement()),i&&r&&rt.addToGroup(r.mercatorZoom>i.mercatorZoom?r.getRootElement():i.getRootElement())),ti&&(ii(r),kt(),i.mercatorZoom>h.mercatorZoom?(v(i.getRootElement()).set_style({opacity:1}),i.opacity=1):(v(h.getRootElement()).set_style({opacity:0}),h.opacity=0),rt.applyAllAnimations()),c=l.length;while(c--)t=l[c],t.havePendingDownloads=!1,f=t.tileGrid,lt=rr.getBestLevelOfDetail(a,t.tilePyramid,ht),k=t.tilePyramid.projectingCamera,dt=a.getHeading()!==k.getHeading()||a.getPitch()!==k.getPitch()||a.getRoll()!==k.getRoll()||a.getDistanceInverse()!==k.getDistanceInverse(),f&&(f.levelOfDetail!==lt||dt&&!u.animateOverlayLayers)&&(!t.tempDisplayGrid&&u.animateOverlayLayers?(t.tempDisplayGrid=f,t.swapping=null):f.dispose(),f=null),ft&&(!dt||u.animateOverlayLayers)&&e<o.readyForTarget&&(f||(f=yt(t.tilePyramid,lt),f.isOverlay=!0,f.hideWhileAnimating=t.animation==="s"?!1:t.animation==="h"?!0:u.animateOverlayLayers?!1:!0,f.opacity=t.opacity,ct=!0),f.populate(a,ut,et)),(f||t.tempDisplayGrid)&&(t.tempDisplayGrid?t.swapping&&f?((t.swapping!=f||ct||at)&&vt(f,c),t.tempDisplayGrid.dispose(),t.tempDisplayGrid=null,t.swapping=null):(f&&e===o.allowed&&vt(f,c),ri(f,t.tempDisplayGrid,.85)&&(e===o.none&&vt(f,c),t.swapping=f,gt=!0)):(ct||at)&&vt(f,c)),f&&(e<o.started&&f.render(w),e===o.readyForTarget&&d.addToGroup(f.getRootElement()),e>o.allowed&&(t.tempDisplayGrid?bt(f):ii(f)),f.getDownloadProgress()<1&&(t.havePendingDownloads=!0)),t.tempDisplayGrid&&(e<o.started&&t.tempDisplayGrid.render(w),e===o.readyForTarget&&d.addToGroup(t.tempDisplayGrid.getRootElement())),t.tileGrid=f;at=!1,!ni&&pt&&n.invoke(wt,"tiledownloadcomplete"),pt=ni,c=l.length;while(c--)t=l[c],!t.havePendingDownloads&&t.hadPendingDownloadsLastUpdate&&t.tileLayer&&n.invoke(t.tileLayer,"tiledownloadcomplete"),t.hadPendingDownloadsLastUpdate=t.havePendingDownloads;gt&&b.dispatch(tt,10),nt&&a.getWidth()/it.getWidth()>.95&&(s(nt),nt=null)}function hi(){var u=!1,y=!1,p=!1,b=f.areAligned(a,it)&&a.getWidth()===it.getWidth(),l=rr.getBestLevelOfDetail(a,g,ht),n=e>o.none,v;return st(i,g,l)?e<o.readyForTarget&&(s(r),r=null,v=b&&!n,i.populate(v?it:a,ut,et,n),h&&!n&&(y=oi())):(e<o.readyForTarget&&(st(r,g,l)||(s(r),r=yt(g,l),r.enableOrDisableScaledTiles(!0),r.mercatorZoom=g.projectingCamera.getMercatorZoom()+c.log2(g.projectingCamera.getWidth()/a.getWidth())),r.populate(a,ut,et)),i==null?(i=r,r=null,w.appendChild(i.getRootElement()),u=!0):r!=null&&(s(h),h=null,i.opacity=1,s(nt),nt=null,e===o.allowed&&(dt(),u=!0),wt.allowTileGridSwitch&&(!ct||r.getDownloadProgress()>.7)&&(!n||e>o.allowed)&&(r.getNoImageTileRatio()>.5?(s(r),r=null,ot=!0):n?p=!0:ct&&ni>1/t.maxFPS?(dt(),kt(),u=!0):(w.insertBefore(r.getRootElement(),i.getRootElement()),s(i),i=r,r=null,u=!0),h&&h.stopDownloading(),_lastTileGridBlendOn=new Date))),{keepGoing:y,gridsAdded:u,shouldSwapTileGrids:p}}function si(){var i=e>o.none,n=ci[rr.getBestLevelOfDetail(a,g,ht)],t=new lt(ut.width*ui,ut.height*ui);st(p,g,n)?e<o.readyForTarget&&p.populate(a,t,0):(y||(y=yt(g,n,!0),y.populate(a,t,0),w.childNodes[0]?w.insertBefore(y.getRootElement(),w.childNodes[0]):w.appendChild(y.getRootElement())),p?ri(y,p,.9)&&(s(p),p=y,y=null,st(p,g,n)||b.dispatch(tt)):(p=y,y=null))}function oi(){var t=!1,r=(_lastTileGridBlendOn?new Date-_lastTileGridBlendOn:0)/1e3,n=r/ni;return i.mercatorZoom>h.mercatorZoom?(i.opacity+=n,h.opacity=1,i.opacity<1&&n<.5?t=!0:(i.opacity=1,s(h),h=null)):(h.opacity-=n,i.opacity=1,h.opacity>0&&n<.5?t=!0:(s(h),h=null)),_lastTileGridBlendOn=new Date,t}function dt(){if(!r||!i)return;r.mercatorZoom>i.mercatorZoom?(i.getRootElement().nextSibling==null?w.appendChild(r.getRootElement()):w.insertBefore(r.getRootElement(),i.getRootElement().nextSibling),r.opacity=0):(w.insertBefore(r.getRootElement(),i.getRootElement()),r.opacity=1)}function kt(){h=i,i=r,r=null}function yt(t,i,r){var u=new rr(t,i,r);return u.rendererHandler=n.addHandler(u,"tilesrendered",ai),u}function ai(){b.dispatch(tt,10)}function bt(n){if(n){var t=n.getRootElement();t.style.left="-10000px",t.style.top="-10000px"}}function ii(n){if(n){var t=n.getRootElement();t.style.left="0px",t.style.top="0px"}}function vt(n,t){if(l[t].tempDisplayGrid){w.insertBefore(n.getRootElement(),l[t].tempDisplayGrid.getRootElement());return}var i=t+1;while(i<l.length){if(l[i].tempDisplayGrid){w.insertBefore(n.getRootElement(),l[i].tempDisplayGrid.getRootElement());break}else if(l[i].tileGrid){w.insertBefore(n.getRootElement(),l[i].tileGrid.getRootElement());break}i++}i<l.length||w.appendChild(n.getRootElement())}function gt(){at=!0,l.sort(function(n,t){return n.zIndex-t.zIndex})}function ri(n,t,i){return n&&n.getDownloadProgress()>i&&(n.mercatorZoom<=t.mercatorZoom||a.getWidth()/it.getWidth()>.9)}var wt=this,ni=.5,ct=!0,i=null,h=null,r=null,p=null,y=null,ci=[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11,11,11,14,14,14,17,17,17,20,20,20,23,23,23,23],ei=u.animateOverlayLayers,ui=u.isIOSBrowser?2:4,vi,w=k();w.style.cssText="position:absolute;z-index:0;left:0;top:0;"+u.safariRenderHack;var g,a,it,ut,l=[],at=!0,pt=!1,ft=!0,et=0,ot=!1,nt,ht=0,e=o.none,d=null,rt=null;this.allowTileGridSwitch=!0,this.render=function(n,t,i,r,u){r!=a&&(ot=!1),i!==g&&(pt=!0,ot=!1),ct=u!=null?u:ct,ut=n,g=i,it=t,a=r,tt(),e>o.none&&e<o.started&&(e==o.readyForTarget&&d.applyAllAnimations(),e++)},this.getBaseTilePyramid=function(){return g},this.enableOrDisableCssAnimation=function(t,i){var u=t!=null,r;if(!u&&e===o.none)return;d||(d=new pr,rt=new pr,rt.manageAnimations([ti.TileFader.duplicate()]),r=function(n){n.hasPendingAnimations()?e=o.pendingCompletion:fi()},n.addHandler(d,"animationscomplete",function(){r(rt)}),n.addHandler(rt,"animationscomplete",function(){r(d)})),e>o.none&&(d.removeAllAnimations(),(!i||u)&&(rt.removeAllAnimations(),fi())),u&&wt.canCssAnimate()&&(d.manageAnimations([t]),e=t.isFlick?o.readyForTarget:o.allowed)},this.canCssAnimate=function(){return i&&g?!0:!1},this.addOverlay=function(n,t){var i=li.getNext();return l.push({id:i,tilePyramid:n,zIndex:t.getZIndex(),opacity:t.getOpacity(),animation:t.getAnimation(),tileLayer:t,havePendingDownloads:!1,hadPendingDownloadsLastUpdate:!0}),gt(),b.dispatch(tt,10),i},this.removeOverlay=function(n){var i,t=l.length;while(t--)if(l[t].id===n){i=l[t].tileGrid,i&&i.dispose(),l[t].tempDisplayGrid&&(l[t].tempDisplayGrid.dispose(),l[t].tempDisplayGrid=null),l.splice(t,1),b.dispatch(tt,10);break}},this.updateOverlay=function(n,t,i){var r,u;_overlaysUpdated=!0,r=l.length;while(r--)if(l[r].id===n){u=l[r],u.opacity=i,u.zIndex!==t&&(u.zIndex=t,gt()),l[r].tempDisplayGrid&&(l[r].tempDisplayGrid.dispose(),l[r].tempDisplayGrid=null),b.dispatch(tt,10);break}},this.suspendGettingNewTiles=function(){ft=!1,s(r),r=null,s(h),h=null,s(nt),nt=null,i&&(i.opacity=1,i.allowTileRender=!1)},this.allowGettingNewTiles=function(){i&&(i.allowTileRender=!0),ft||(ft=!0,b.dispatch(tt,10))},this.disposeTiles=function(){b.cancelDispatch(tt),s(r),r=null,s(h),h=null,s(nt),nt=null,s(i),i=null,s(p),p=null,s(y),y=null;var t,n,u=l.length;while(u--)t=l[u],n=t.tileGrid,n&&(n.dispose(),t.tileGrid=null)},this.showBackground=function(n){n!==null&&(ei=n,n||(s(p),p=null,s(y),y=null))},this.setBufferSize=function(n){n=Math.max(0,Math.min(4,n)),n!=et&&(et=n,b.dispatch(tt))},this.getRootElement=function(){return w},this.setPartialZoomBias=function(n){ht=n},this.isDownloadingTiles=function(){return r&&r.getDownloadProgress()<1||i&&i.getDownloadProgress()<1},this.getTileDownloadMetrics=function(){var n=0;return n+=i?i.getTileDownloadMetrics():0,n+=r?r.getTileDownloadMetrics():0}}function er(){function ai(n){ft(n.collection,n.entity,!0,!1,p.last)}function li(n){nt(n.entity,!0,!1),yt(n.entity)}function ci(n){ft(n.collection,n.entity,!0,!1,p.last)}function wi(){ft(null,h,!1,!0,p.last)}function f(t,u,e,o){var s,h,c;t||(t=hi.getEntityForTarget(e.target)),t&&(s=t.entity,s.trueEntity&&f({entity:s.trueEntity,type:t.type},u,e,o),n.hasHandler(s,u)&&(o&&e.touches&&e.touches[0]&&(h=new i(e.touches[0].pageX,e.touches[0].pageY)),h||(h=v.Screen.get_mouse_pos(e)),c=new vi(r,t.type,s,u,h.x,h.y,0,o,e),n.invoke(s,u,c)))}function pi(n,i){var u=i[t],r=u&&u.dom;if(r)try{r.focus()}catch(f){}}function ft(n,i,f,v,y){var vi,wi,tr,ti,ci,ai,hi,dt,g,ui,bi,at,pi,ir,gt,ki,rr,d,gi,ht,et,pt,ot;if(c){vi=!1,wi=r.getTheme(),wi&&(tr=i[it]=i[it]||{},ti=wi._preRenderEntity(i,tr,{updateEntity:f,themeReferenceKey:it}),ti&&ti!==i&&(ti.trueEntity=i,i=ti)),ci=vt.getEntityRenderer(r,i);if(ci)ai={entityCollection:n,rootDom:h[t].shape,rootOffsetLeft:h[t].offsetLeft,rootOffsetTop:h[t].offsetTop,parentDom:n[t].shape,parentOffsetLeft:n[t].offsetLeft,parentOffsetTop:n[t].offsetTop,parentVisible:fi(n),parentRemoved:!1,update:f,linear:v,animationStart:y===p.first,animationEnd:y===p.last,currentBounds:b,actualBounds:ii,viewportSize:c,customRenderer:l},ci.shouldDraw(i,ai)?(hi=ci.update(i,ai),hi&&ri(hi,{entity:i,type:hi.type})):nt(i,!0,f);else if(i instanceof di){d=i[t],d?(dt=d.root,g=d.shape):(dt=k(null,u.safariRenderHack),g=k(null,u.safariRenderHack+";position:absolute;"),dt.appendChild(g),d={root:dt,shape:g,offsetTop:0,offsetLeft:0},i[t]=d,vi=!0,f=!0),f&&(ui="position:absolute;pointer-events:none;",i.getVisible()||(ui+="display:none;"),si(n,i),bi=i.getZIndex(),typeof bi=="number"&&(ui+="z-index:"+bi+";"),dt.style.cssText=ui+u.safariRenderHack);var yt,oi=d.lookAt,li=!1,ei=!1;for(v&&oi?(at=s==o.readyForTarget?bt.getWorldToViewport().transform(oi):st.getWorldToViewport().transform(oi),(!wt||!d.harmony)&&(Math.abs(at.x)>1e4||Math.abs(at.y)>1e4)?(li=!0,ei=!0,v=!1):s<o.started&&(pi=e.translation(at.x,at.y,0),u.useTransform3d&&!u.isIOS3?(ir=ni.setTransformAndOpacity(pi,null,1,{excludeCommonCss:!0,returnStyleObject:!0}),g.style[w.Properties.transform]=ir[w.Properties.transform]):(yt=ni.setTransformAndOpacity(pi,null,1,{excludeCommonCss:!u.isIOS3}),u.isIOS3||(yt="position:absolute;"+yt),g.style.cssText=yt),d.offsetLeft=at.x,d.offsetTop=at.y)):li=!0,li&&s<o.started&&(yt="position:absolute;",d.lookAt=st.getLookAt(),d.offsetLeft=0,d.offsetTop=0,g.style.cssText=yt),v&&oi&&s==o.readyForTarget&&rt.addToGroup(g),g.harmony&&!lt.areEqual(d.previousSize,c)&&(gt=g.harmony,gt.style.width=c.width+"px",gt.style.height=c.height+"px",gt.style.left=-(c.width/2)+"px",gt.style.top=-(c.height/2)+"px",d.previousSize=c),vi&&n[t].root.appendChild(dt),ei&&g.harmony&&g.harmony.style&&(g.harmony.style.display="none"),ki=i.getLength(),ht=0;ht<ki;ht++)ft(i,i.get(ht),f,v&&!ei,y);ei&&setTimeout(function(){g&&g.harmony&&g.harmony.style&&(g.harmony.style.display="block")},1)}else if(i instanceof nr)rr=i.getVisible()&&(l||b.contains(i.getLocation())||i[t]&&i[t].dragging),rr?yi(n,i,f,v):nt(i,!0,f);else if(i instanceof sr)if(n.getVisible()){d=i[t],d||(d={},i[t]=d);if(f||!d.added||a.getBaseTilePyramid()!==ct){d.added=!1,ct=a.getBaseTilePyramid(),gi=ct?ct.projectingCamera:ut.mercator,ht=tt.length;while(ht--)ot=tt[ht][0],d[ot]&&(a.removeOverlay(d[ot]),d[ot]=null),i.getVisible()&&ut[ot]===gi&&(et=i.getTileSource(ot),et&&(pt=kt.createQuadKeyTilePyramid(et.getWidth(),et.getHeight(),et.getUriConstructor(),tt[ht][1],null,i.getDownloadTimeout()),pt.projectingCamera=ut[ot],d[ot]=a.addOverlay(pt,i),d.added=!0));!d.added&&i.getVisible()&&i.getReproject()&&(et=i.getTileSource("mercator"),et&&(pt=kt.createQuadKeyTilePyramid(et.getWidth(),et.getHeight(),et.getUriConstructor(),tt[0][1],null,i.getDownloadTimeout()),pt.projectingCamera=ut.mercator,d[ot]=a.addOverlay(pt,i)),d.added=!0)}}else nt(i,!0,f)}}function yi(i,r,f,h){var c,a,d,dt,ti,ot,b,nt,w,ft,yt,p,ut,pt,it,et,ht,lt,tt,g,ct;if(!i[t])return;a=r[t],a?(f=a.updateEntity||f,a.updateEntity=!1):(c=k("a",u.safariRenderHack),c[y]={entity:r,type:ui.pushpin},a={dom:c,dragAttached:!1,offsetTop:0,offsetLeft:0},r[t]=a,d=r.trueEntity||r,dt=n.getHandlers(r,"focus"),v(dt).for_each(function(n){c.trueEntity=d,v(c).add_event("focus",n.handler)}),ti=n.getHandlers(r,"blur"),v(ti).for_each(function(n){c.trueEntity=d,v(c).add_event("blur",n.handler)}),c.$hasKeyDown||(v(c).add_event("keydown",function(n){if(n.keyCode===9){var t=d.getInfobox();t&&t.getVisible()&&t.receiveFocus({nativeEvent:n,forwardFocus:!n.shiftKey})}}),c.$hasKeyDown=!0),n.hasHandler(d,"focusreceived")||n.addHandler(d,"focusreceived",function(n){pi(n,r)}),f=!0),c=a.dom,c.onclick==null&&(c.onclick=function(){return!1}),c.href||(c.href="#"),f&&(ot=r.getHtmlContent(),ot?(c.innerHTML=ot,a.isHtmlContent=!0,a.icon=a.text=null):(a.isHtmlContent&&(c.innerHTML="",a.isHtmlContent=!1),b=a.icon,nt=r.getIcon(),!b&&nt&&(b=k("img",u.safariRenderHack,c),a.icon=b,b[y]={entity:r,type:ui.pushpin},b.src=nt),b&&b.src!==nt&&(b.src=nt||""),w=a.text,ft=r.getText(),!w&&ft&&(w=k(null,u.safariRenderHack,c),w.appendChild(document.createTextNode("")),a.text=w,w[y]={entity:r,type:ui.pushpin}),w&&(ft?(w.style.cssText="position:absolute;text-align:center;width:100%;font:bold 10pt Arial,Helvetica,Sans-Serif;color:#fff;left:"+r.getTextOffset().x+"px;top:"+r.getTextOffset().y+"px;",w.replaceChild(document.createTextNode(ft),w.firstChild)):(c.removeChild(w),a.text=null)))),yt=r.getHtmlContent(),p="";if(!l&&s<o.started){p=yt?"position:absolute;cursor:inherit;":"position:absolute;cursor:inherit;overflow:hidden;pointer-events:all;"+u.safariRenderHack;if(!h||!a.isDrawn){ut=s===o.readyForTarget?gt.internalTryLocationToViewport(bt,r.getLocation()):gt.internalTryLocationToViewport(st,r.getLocation());if(ut){var kt=r.getAnchor(),vt=ut.x-kt.x-i[t].offsetLeft,wt=ut.y-kt.y-i[t].offsetTop;u.useTransform3d&&r.getUseTransform3d()?(pt=e.translation(vt,wt,0),it={excludeCommonCss:!0},f?p+=ni.setTransformAndOpacity(pt,null,1,it):(it.returnStyleObject=!0,et=ni.setTransformAndOpacity(pt,null,1,it),a.displayHidden&&(et.display=""),v(c).set_style(et))):f?(p+="left:"+vt+"px;",p+="top:"+wt+"px;"):(c.style.left=vt+"px",c.style.top=wt+"px",a.displayHidden&&(c.style.display="")),a.displayHidden=!1}else f?p+="display:none;":c.style.display="none",a.displayHidden=!0;a.displayHidden=!0}}f&&(c.id=r.getId(),ht=r.getTypeName()||"",a.className!=ht&&(a.className=c.className=ht,v(c).add_class("MapPushpinBase")),lt=r.getZIndex(),typeof lt=="number"&&(p+="z-index:"+lt+";"),tt=r.getWidth(),g=r.getHeight(),yt?(tt&&(p+="width:"+tt+"px;"),g&&(p+="height:"+g+"px;")):(p+="width:"+(tt?tt+"px;":"auto;"),p+="height:"+(g?g+"px;":"auto;"),p+="line-height:0px;"),c.style.cssText=p),h||s!==o.readyForTarget||rt.addToGroup(c),(f||!a.isDrawn)&&(ct=r.getDraggable(),ct!=a.dragAttached&&at(r,ct)),l?a.isDrawn?f&&l.updateEntity(r):(l.addEntity(r,c),a.isDrawn=!0):a.isDrawn||(i[t].shape.appendChild(c),a.isDrawn=!0)}function nt(n,i,u){var p,s,e,v,f,o,h,c,b,w;if(n){p=r.getTheme(),p&&(s=n[it]=n[it]||{},s.proxyEntity&&(n=s.proxyEntity),p._unhookFromEntity(n,s));if(n[t]){e=n[t];if(n instanceof di){f=e.root,v=!1,i&&f&&f.parentNode&&(g?(g.push(f),v=!0):f.parentNode.removeChild(f)),o=n.getLength();while(o--)nt(n.get(o),v,u)}else if(n instanceof nr)at(n,!1),ti(n),f=e.dom,f&&(f[y]=null,f.onclick=null,f.removeAttribute("href"),i&&f.parentNode&&f.parentNode.removeChild(f)),e.updateEntity=e.updateEntity||u,e.isDrawn=!1,l&&l.removeEntity(n);else if(n instanceof sr){e.added=!1,o=tt.length;while(o--)h=tt[o][0],e[h]&&a.removeOverlay(e[h])}}else c=vt.getEntityRenderer(r,n),c&&(b={parentRemoved:!i,update:u,customRenderer:l},w=c.remove(n,b),ri(w,null))}}function ri(n,t){if(n&&n.doms){var r=n.doms,i=r.length;while(i--)r[i][y]=t}}function yt(n){var u,i;if(n instanceof di){u=n.getLength();while(u--)yt(n.get(u))}else n instanceof nr?(at(n,!1),ti(n)):(i=vt.getEntityRenderer(r,n),i&&i.dispose(n));delete n[t]}function si(n,i){n&&n[t]&&i&&i[t]&&(i[t].parentVisible=n[t].parentVisible&&n.getVisible())}function fi(n){return n&&n[t]?n[t].parentVisible&&n.getVisible():null}function at(i,r){var u=i[t];u&&(u.dragAttached=r,r?u.dragStartHandler=n.addHandler(i,"mousedown",ei):u.dragStartHandler&&(n.removeHandler(u.dragStartHandler),delete u.dragStartHandler))}function ei(u){var s=u.target,f=s.trueEntity||s,e=s[t],o,c,h;if(e&&(u.isTouchEvent||u.originalEvent.which===1)){e.dragging=!0,o=r.tryLocationToPixel(f.getLocation());if(o){c=o.x-u.getX(),h=o.y-u.getY(),n.invoke(f,"dragstart",{entity:f});function a(t){t.handled=!0,t.originalEvent.preventDefault();var u=r.tryPixelToLocation(new i(t.getX()+c,t.getY()+h));u&&f.setLocation(u),n.invoke(f,"drag",{entity:f})}function l(){ti(s),n.invoke(f,"dragend",{entity:f})}e.dragAttached&&!e.dragEndHandler&&(e.dragMoveHandler=n.addHandler(r,"mousemove",a),e.dragEndHandler=n.addHandler(r,"mouseup",l))}}}function ti(i){var r=i[t];r&&(r.dragging=!1,r.dragMoveHandler&&(n.removeHandler(r.dragMoveHandler),delete r.dragMoveHandler),r.dragEndHandler&&(n.removeHandler(r.dragEndHandler),delete r.dragEndHandler))}er.ensureVmlNamespace();var hi=this,r,gt,dt,l,h,a,ht,y,t,it,c,st,b,ii,bt,wt,ot,g,ct,s=o.none,rt=new pr,p={first:0,middle:1,last:2},d=[["entityadded",ai],["entityremoved",li],["entitychanged",ci]],pt,tt=[["mercator",et.horizontal],["enhancedBirdseyeNorthUp",et.horizontal],["enhancedBirdseyeEastUp",et.vertical],["enhancedBirdseyeSouthUp",et.horizontal],["enhancedBirdseyeWestUp",et.vertical]];this.activate=function(i,f,e,o,s,c){r=i,gt=f,dt=r.getRootElement(),h=r.entities,a=e,l=c,wt=oi.isClipped(),ht=s,y=ht+"_der",t=ht+"_etr",it=ht+"_thr",h[t]={root:o,shape:k(null,u.safariRenderHack+";position:absolute;",o),offsetTop:0,offsetLeft:0,parentVisible:!0};var v=d.length;while(v--)d[v][2]=n.addHandler(h,d[v][0],d[v][1]);pt=n.addHandler(vt,"newEntityRenderer",wi)},this.deactivate=function(){c=null;var t=d.length;while(t--)n.removeHandler(d[t][2]),d[t][2]=null;n.removeHandler(pt),pt=null,nt(h,!0,!1),yt(h),r=null,dt=null,h=null,a=null},this.enableOrDisableCssAnimation=function(n){if(!u.allowCssAnimations)return;var i=n!=null;rt.removeAllAnimations(),s=o.none,i&&(rt.manageAnimations([n]),s=n.isFlick?o.readyForTarget:o.allowed)},this.onMouseDown=function(n){f(null,"mousedown",n)},this.onTouchStart=function(n){g||(g=[]),f(null,"mousedown",n,!0)},this.onMouseUp=function(n){f(this.getEntityForTarget(n.captureTarget),"mouseup",n)},this.onTouchEnd=function(n){var i,r,t;f(this.getEntityForTarget(n.captureTarget),"mouseup",n,!0);if(g){i=g,g=null,r=i.length;while(r--)t=i[r],t&&t.parentNode&&t.parentNode.removeChild(t)}},this.onMouseOver=function(n){f(null,"mouseover",n)},this.onMouseOut=function(n){f(null,"mouseout",n)},this.onMouseClick=function(n){f(null,"click",n)},this.onMouseRightClick=function(n){f(null,"rightclick",n)},this.onMouseDoubleClick=function(n){f(null,"dblclick",n)},this.onTap=function(n){f(null,"click",n,!0)},this.onDoubleTap=function(n){f(null,"dblclick",n,!0)},this.onTapAndHold=function(n){f(null,"rightclick",n,!0)},this.getEntityForTarget=function(n){while(n&&!n[y]&&n!==dt)n=n.parentNode;return n=n&&n[y]||null},this.update=function(n,t,i,u,f){c=n,st=t,bt=i,f!=p.last&&u&&b||(b=r.getBounds(),ii=b.clone(),b.width*=3,b.height*=3),ot=f==p.last&&wt?!1:ot&&u,ft(null,h,!1,ot,f),f==p.last&&(ot=!0),s>o.none&&s<o.started&&(s==o.readyForTarget&&rt.applyAllAnimations(),s++)}}function bu(t){function y(){a=f.getMode().getShouldClipPolygons(),r=f.getMode().getDrawShapesInSingleLayer()}function g(){e&&(n.removeHandler(e),e=null,n.removeHandler(s),s=null)}function d(n){return r?n.rootDom:n.parentDom}function tt(n,t){var u=null,i=n[o],f,r;return i&&(f=i.harmony,f&&(r=i.path,r&&(u=r.nativeShape,f.removePath(r),i.path=null)),i.updateEntity=i.updateEntity||t.update,i.isDrawn=!1),oi.isEventsSupported()&&u?{doms:[u]}:null}function h(n){var t=n[o];return t||(t={},n[o]=t),t}function nt(n){return n instanceof gi||n instanceof tr&&a}function p(n,t){for(var s=n.x,o=n.x+n.width,l=n.y,c=n.y+n.height,e=[],i=[],a=t.length,f=null,r,h,u=0;u<a;u++)r=t[u],r?(h=r.x>=s&&r.y>=l&&r.x<=o&&r.y<=c,h?(!i.length&&u&&t[u-1]&&i.push(t[u-1]),i.push(r),f=null):(i.length&&(i.push(r),e.push(i),i=[]),f&&b(s,o,l,c,f,r)&&(i.push(f),i.push(r),e.push(i),i=[]),f=r)):(e.push(i),i=[]);return i.length&&e.push(i),e}function b(n,t,i,r,u,f){if(f.x-u.x==0)return u.x>=n&&u.x<=t;if(f.y-u.y==0)return u.y>=i&&u.y<=r;var o=(f.y-u.y)/(f.x-u.x),s=u.y-o*u.x,e=o*n+s;if(e>=i&&e<=r)return!0;e=o*t+s;if(e>=i&&e<=r)return!0;return o=(f.x-u.x)/(f.y-u.y),s=u.x-o*u.y,e=o*i+s,e>=n&&e<=t?!0:!1}function l(n,t,r){var h=n.x1,s=n.y1,l=n.x2,c=n.y2,f=t.x,u=t.y,o=r.x,e=r.y,v=((h*c-s*l)*(f-o)-(h-l)*(f*e-u*o))/((h-l)*(u-e)-(s-c)*(f-o)),a=((h*c-s*l)*(u-e)-(s-c)*(f*e-u*o))/((h-l)*(u-e)-(s-c)*(f-o));return new i(v,a)}function w(n,t){for(var e=n.x,a=n.x+n.width,s=n.y,v=n.y+n.height,p=[{x1:e,y1:s,x2:a,y2:s,isInside:function(n,t){return t>this.y1}},{x1:a,y1:s,x2:a,y2:v,isInside:function(n){return n<this.x2}},{x1:a,y1:v,x2:e,y2:v,isInside:function(n,t){return t<this.y2}},{x1:e,y1:v,x2:e,y2:s,isInside:function(n){return n>this.x1}}],u=t,f,o,y,i,h,r,c=0;c<p.length;c++)for(f=p[c],o=u,u=[],y=o.length,i=o[y-1],h=0;h<y;h++)r=o[h],f.isInside(r.x,r.y)?(f.isInside(i.x,i.y)||u.push(l(f,i,r)),u.push(r)):f.isInside(i.x,i.y)&&u.push(l(f,i,r)),i=r;return[u]}var f=t,c="cm"+li.getNext(),o=c+"_etr",v=!0,a,r,s,e;y(),s=n.addHandler(f,"modeoptionschanged",y),e=n.addHandler(f,"ondispose",g),this.shouldDraw=function(n,t){var f,o,i,e;return t.parentVisible!==null&&(v=t.parentVisible),f=n.getVisible()&&(t.linear||t.animationEnd||u.animateShapes)&&(!r||v),f&&(o=h(n),i=o.boundingRect,(t.update||!i)&&(e=n.getLocations(),o.boundingRect=i=e?ct.fromLocations(e):null),f=i&&t.currentBounds.intersects(i)),f},this.update=function(n,t){var o=t.viewportSize,vt=t.currentBounds,i=h(n),y,v,s,e,rt,ht,ot,b,a,st,g,ct,et,it,yt,at,l,tt,ft,ut;t.update=i.updateEntity||t.update,i.updateEntity=!1,y=i.harmony,v=d(t),!y&&v&&(s=v.harmony,s||(s=k("div","position:absolute;width:"+o.width+"px;height:"+o.height+"px;left:"+-(o.width/2)+"px;top:"+-(o.height/2)+"px;"+u.safariRenderHack),v.harmony=s,v.firstChild?v.insertBefore(s,v.firstChild):v.appendChild(s)),y=oi.getContext(s),s.className="MicrosoftMapDrawing",i.harmony=y),e=i.path,rt=!1,e&&lt.areEqual(i.previousSize,o)||(y.setSize(o.width,o.height),i.previousSize=o,rt=!0),e||(e=y.createPath(),e.id=c+"path"+li.getNext(),i.path=e,t.update=!0),t.update&&(ht=n.getStrokeColor(),e.strokeStyle=ht.toHex(),e.strokeOpacity=ht.getOpacity(),e.lineWidth=n.getStrokeThickness(),e.dashArray=n.getStrokeDashArray(),n instanceof tr?(ot=n.getFillColor(),e.fillStyle=ot.toHex(),e.fillOpacity=ot.getOpacity()):e.fillStyle="none");if(!t.linear||!i.points||rt){st=null,g=i.boundingRect,g&&g.width>180&&(st={referenceLocation:g.center}),i.points=f.tryLocationToPixel(n.getLocations(),null,st),i.offsetLeft=r?t.rootOffsetLeft:t.parentOffsetLeft,i.offsetTop=r?t.rootOffsetTop:t.parentOffsetTop,ct=nt(n)&&(g.width>vt.width||g.height>vt.height),i.doClipping=ct;if(!ct){a=i.points,et=a.length,b=a.length;while(b--)a[b]||(et=!1,b=0);et||(i.points=[])}}if(!t.linear||t.animationEnd||t.update||rt){a=i.points;if(i.doClipping){var wt=o.width*3,bt=o.height*3,dt=r?t.rootOffsetLeft:t.parentOffsetLeft,gt=r?t.rootOffsetTop:t.parentOffsetTop,kt=new pt(-dt-wt/2,gt-bt/2,wt,bt);it=n instanceof gi?p(kt,a):w(kt,a)}else it=[a];e.beginPath(),yt=i.offsetLeft-o.width/2,at=i.offsetTop-o.height/2,b=it.length;while(b--){l=it[b];if(l&&l.length)for(l[0].shouldUseMoveTo=!0,tt=0;tt<l.length;tt++)ft=l[tt].x-yt,ut=l[tt].y-at,l[tt].shouldUseMoveTo?e.moveTo(ft,ut):e.lineTo(ft,ut)}e.data||e.moveTo(0,0),e.stroke(),i.isDrawn||(y.renderPath(e),i.isDrawn=!0)}return oi.isEventsSupported()&&n.getShouldFireEvents()?{doms:[e.nativeShape],type:n instanceof gi?ui.polyline:ui.polygon}:null},this.remove=tt,this.dispose=function(n){delete n[o]}}function fu(n,t,i,r,u){function e(n){var u=[],i=n?n.split(";"):[],r=i.length,t;while(r--)t=ct.fromString(i[r]),t&&u.push(t);return u}this.priority=u;var f=e(r);this.getScene=function(r,u,e,o){if(o>=t&&o<i){if(!f||!f.length)return n;var c=new p(u,e),h=f.length;while(h--)if(f[h].contains(c))return n}return null}}function fi(n,t){var i=n;this.getCopyrights=function(n,r,u,f){t(function(t){t?ru.getCopyrights(i,n,r,u,t,f):f([ii.defaultCopyright.text])})}}function su(r,e,o,s,h,c,l){function ot(n){n.stopPropagation(),n.preventDefault()}function fi(n,t){var r,i;r=n.length;if(t&&!n.isWired){while(r--)i=n[r],s.add_event(i[0],i[1],!1);n.isWired=!0}else if(!t&&n.isWired){while(r--)i=n[r],s.remove_event(i[0],i[1],!1);n.isWired=!1}}function ht(){return p!=null&&(p.x!=0||p.y!=0)}function ai(){dt&&ht()&&(p.x*=dt,p.y*=dt,Math.abs(p.x)<5&&Math.abs(p.y)<5&&(p.x=0,p.y=0))}function yi(n,t,i){if(n&&t&&i){var u=i.x-t.x,r=i.y-t.y;u!=0||r!=0?(ct+=n,p?(p.x=.3*p.x+.7*u*1e3/ct,p.y=.3*p.y+.7*r*1e3/ct):p=new gt(u*1e3/ct,r*1e3/ct),ct=0):ct+=n}}function di(n){var t=v.Screen.get_mouse_pos(n);return new i(t.x-e.getViewportX(),t.y-e.getViewportY())}function st(){return new i(0,0)}function d(t,u,f,o){var p=!1,c,w,s,l,y;return n.hasHandler(r,u)&&(o||(f.touches&&f.touches[0]?c=new i(f.touches[0].pageX,f.touches[0].pageY):a&&a[0]&&(c=a[0])),c||(c=v.Screen.get_mouse_pos(f)),w=f.wheelDelta?f.wheelDelta:0,h&&(t&&(s=h.getEntityForTarget(t)),s||(s=h.getEntityForTarget(f.target)),s&&(l=s.type,s=s.entity)),l||(s=e,l=ui.map),y=new vi(e,l,s,u,c.x,c.y,w,!o,f),u==="click"&&(y.mouseMoved=ei&&g&&i.distance(ei,g)>5),n.invoke(r,u,y),p=y.handled),p}function br(n){if(!n.handled){var t=!1;if(n.ctrlKey)switch(n.keyCode){case 37:o.rotate(90);break;case 39:o.rotate(-90)}else switch(n.keyCode){case 37:y.x>-1&&(y.x=-1),t=!0;break;case 39:y.x<1&&(y.x=1),t=!0;break;case 38:y.y>-1&&(y.y=-1),t=!0;break;case 40:y.y<1&&(y.y=1),t=!0;break;case 109:case 189:at=-1;break;case 107:case 187:case 61:at=1}r.ensureUpdateDispatched(),t&&(n.handled=!0,ot(n.originalEvent))}}function kr(n){if(!n.handled){switch(n.keyCode){case 37:case 39:y.x=0;break;case 38:case 40:y.y=0;break;case 109:case 189:case 107:case 187:case 61:at=0}r.ensureUpdateDispatched()}}function si(){y.x=0,y.y=0,at=0}function ki(n){if(!d(null,"dblclick",n,!0)&&!et){if(h)h.onMouseDoubleClick(n);var t=ft?st():di(n);o.zoomCenter(.5,t)}ot(n)}function wr(n){if(!d(null,"click",n,!0)&&h){h.onMouseClick(n);if(u.emulateDblClick){var t=v.Screen.get_mouse_pos(n);new Date-hi<bi&&t.x===kt.x&&t.y===kt.y?(kt={x:0,y:0},hi=new Date(0),ki(n)):(kt=t,hi=new Date)}}}function tu(n){if(!d(null,"rightclick",n,!0)&&h)h.onMouseRightClick(n)}function nu(n){if(!d(null,"mousewheel",n,!0)&&!et){nt.clearInertialScrolling();if(n.wheelDelta){var t=ft?st():di(n);o.zoomPoint(n.wheelDelta,t)}ot(n)}}function dr(n){if(!d(null,"mousedown",n,!0)){si(),r.suspendSceneChanges(!1),r.haltCssAnimation(),o.startUserInput();if(h)h.onMouseDown(n);wt=!et&&c&&(n.shiftKey===!0||n.which===2),g=v.Screen.get_mouse_pos(n),nt.clearInertialScrolling(),ei=tt=g,v.Events.capture_mouse(this,!1),ri=!0,wt?s.set_style({cursor:r.getCursors().SEResize}):s.set_style({cursor:r.getCursors().Grabbing})}ot(n);try{document.focus()}catch(t){}}function gr(n){d(null,"mousemove",n,!0)||tt&&(g=v.Screen.get_mouse_pos(n),r.ensureUpdateDispatched(),ir=new Date,ot(n))}function yr(n){ri&&gi(n)}function gi(n){var l,a;if(!d(n.captureTarget,"mouseup",n,!0)){r.canUseCssAnimations()&&ht()||r.allowSceneChanges(),vt===!0&&(l=new Date,a=l-ir,a<ur?it=g:nt.clearInertialScrolling()),r.ensureUpdateDispatched();if(h)h.onMouseUp(n);if(wt&&tt)if(i.distance(tt,g)>10){var f=e.getViewportX(),u=e.getViewportY(),t=pt.union(new i(tt.x-f,tt.y-u),new i(g.x-f,g.y-u)),p=Math.max(t.width/e.getWidth(),t.height/e.getHeight()),y=ft?st():t.getCenter();o.zoomCenter(p,y)}}c&&(ut.style.display="none",ut.parentNode&&ut.parentNode.removeChild(ut)),s.set_style({cursor:r.getCursors().Grab}),tt=null,ri=!1,v.Events.release_mouse()}function sr(n){if(!d(null,"mouseover",n,!0)&&h)h.onMouseOver(n)}function or(n){if(!d(null,"mouseout",n,!0)&&h)h.onMouseOut(n)}function ci(n){var r=e.getViewportX(),t=e.getViewportY();return n.length>1?new i((n[0].x+n[1].x)/2-r,(n[0].y+n[1].y)/2-t):n.length?new i(n[0].x-r,n[0].y-t):new i(0,0)}function ar(n){n.preventManipulation&&n.preventManipulation(),n.currentTarget&&n.currentTarget.msSetPointerCapture&&n.currentTarget.msSetPointerCapture(n.pointerId),n.preventMouseEvent&&n.preventMouseEvent(),si(),li();if(!d(null,"mousedown",n,!1)){r.suspendSceneChanges(!0),r.haltCssAnimation(),o.startUserInput();if(h)h.onTouchStart(n);nt.clearInertialScrolling();var t=Math.min(2,n.touches.length);lt===0&&t===2&&(lt=r.getCurrentCamera().getMercatorZoom()),b.length===0&&t===1&&(w=new i(n.touches[0].pageX,n.touches[0].pageY),w.target=n.target,w.start=new Date,ti=setTimeout(hr,pr));while(t--)a[t]=new i(n.touches[t].pageX,n.touches[t].pageY),b[t]=a[t],rt[t]=a[t];fr=r.getCurrentCamera().getHeading()}ot(n)}function vr(n){(n.touches.length>1||w&&(Math.abs(n.touches[0].pageX-w.x)>20||Math.abs(n.touches[0].pageY-w.y)>20))&&(oi(),li());if(n.touches.length>1||!d(null,"mousemove",n,!1)){var t=b.length;if(t){t=n.touches.length;while(t--)a[t]=new i(n.touches[t].pageX,n.touches[t].pageY)}}r.ensureUpdateDispatched(),nr=new Date,ot(n)}function pi(n){var l,g,k,p,u,s,c,t,v,y;n.currentTarget.msReleasePointerCapture&&n.currentTarget.msReleasePointerCapture(n.pointerId),li();if(!d(null,"mouseup",n,!1)){if(h)h.onTouchEnd(n);w&&(lr(),navigator.msPointerEnabled||(ni&&new Date-ni.start<bi?(l=new i(w.x-e.getViewportX(),w.y-e.getViewportY()),cr(),oi()):(ni=w,w=null))),b.length===1&&vt===!0&&(g=new Date,k=g-nr,k<ur?it=a[0]:nt.clearInertialScrolling()),b.length=0,n.touches.length&&(nt.clearInertialScrolling(),a[0]=b[0]=new i(n.touches[0].pageX,n.touches[0].pageY)),r.canUseCssAnimations()&&ht()?r.ensureUpdateDispatched():r.allowSceneChanges();if(l&&!et)u=ft?st():l,o.zoomCenter(.5,u,null,!0);else{if(rt.length>1&&r.isRotationEnabled()){var tt=new gt(rt[1].x-rt[0].x,rt[1].y-rt[0].y),ut=new gt(a[1].x-a[0].x,a[1].y-a[0].y),ot=Math.atan2(ut.y,ut.x)-Math.atan2(tt.y,tt.x);Math.abs(ot)>.7&&(lt=0),rt.length=0}lt!==0&&ii>0&&(u=ft?st():ci(a),s=r.getCurrentCamera().getMercatorZoom(),c=s-lt,lt=0,t=Math.abs(c),t-=Math.floor(t),t>=ii&&t<.5&&(v=c>0?Math.ceil(s):Math.floor(s),y=f.mercatorZoomToWidth(v,r.getCurrentCamera().getCrs(),p)/f.mercatorZoomToWidth(s,r.getCurrentCamera().getCrs(),p),o.zoomCenter(y,u,u)))}ht()||o.endUserInput()}}function li(){ti&&(clearInterval(ti),ti=null)}function oi(){ni=null,w=null}function lr(){if(!d(null,"click",w,!1)&&h)h.onTap(w)}function cr(){if(!d(null,"dblclick",w,!1)&&h)h.onDoubleTap(w)}function hr(){if(w){if(!d(null,"rightclick",w,!1)&&h)h.onTapAndHold(w);oi()}}var nt=this,ut;l=l||{},c&&(ut=k("div","display:none;z-index:0;position:absolute;border:1px dashed #000;background:#ccc"),v(ut).set_style({opacity:".5"}));var wi=.15,bi=500,pr=1e3,ni,w,ti,ii=l.touchZoomThreshold!=null?l.touchZoomThreshold:.1,iu=[],ri=!1,vt=!0,dt=.9,p=null,yt=null,it=null,kt={x:0,y:0},hi=new Date(0),ir=new Date(0),nr=new Date(0),ur=100,ct=0,ft=!1,et=!1,er=[["dblclick",ki],["click",wr],["mousewheel",nu],["mousedown",dr],["mousemove",gr],["mouseup",gi],["losecapture",yr],["contextmenu",tu],["mouseover",sr],["mouseout",or]],tr=[["touchstart",ar],["touchmove",vr],["touchend",pi],["touchcancel",pi]],bt=[["keydown",br,null],["keyup",kr,null],["blur",si,null]],ru=null,uu=.003*u.scrollAdjustment,fu=0,y=new i(0,0),at=0,rr=new Date(0),g,tt,ei,wt,a=[],rt=[],fr,b=[],lt=0;nt.enableOrDisableInertialScrolling=function(n,t){n?(vt=!0,typeof t=="number"&&(dt=Math.min(Math.max(t,.01),.99))):vt=!1},nt.enableOrDisableUserInput=function(t,i){if(i){t=t&&!i.disableUserInput,fi(er,t&&!i.disableMouseInput),t&&!i.disableTouchInput?(s.set_style({"-ms-touch-action":"none"}),fi(tr,!0)):(s.set_style({"-ms-touch-action":""}),fi(tr,!1)),t=t&&!i.disableKeyboardInput;var u,f;u=bt.length;if(t)while(u--)f=bt[u],f[2]||(f[2]=n.addHandler(e,f[0],f[1]));else while(u--)n.removeHandler(bt[u][2]),bt[u][2]=null;ft=i.disablePanning?!0:!1,et=i.disableZooming?!0:!1,s.set_style({cursor:r.getCursors().Grab})}},nt.setTouchZoomThreshold=function(n){ii=Math.min(n,.49)},nt.clearInertialScrolling=function(){it=null,p=null},nt.processPendingUserInput=function(){var h=new Date,l=yt?h-yt:null,v,ri,ui,w,c,u,d,ot,bt,k,lt;yt=h,ri=r.getCurrentCamera().getWidth(),ui=r.getCurrentCamera().getLookAt(),at&&!et&&(nt.clearInertialScrolling(),v=at<0?2:.5),(y.x||y.y)&&!ft&&(nt.clearInertialScrolling(),w=y.x*wi*e.getWidth(),c=y.y*wi*e.getHeight(),Math.abs(y.x)>.9&&Math.abs(y.x)<3&&(y.x=y.x*1.01),Math.abs(y.y)>.9&&Math.abs(y.y)<3&&(y.y=y.y*1.01)),(v||w||c)&&(h=new Date,(yt-rr)/1e3>r.getCameraAnimationDuration()/3&&(v&&o.zoom(v),(w||c)&&o.doDragXY(w,c),rr=h));if(tt)if(wt&&!et){var ti=e.getPageX(),ni=e.getPageY(),f=pt.union(new i(tt.x-ti,tt.y-ni),new i(g.x-ti,g.y-ni));ut.style.left=f.x+"px",ut.style.top=f.y+"px",ut.style.width=f.width+"px",ut.style.height=f.height+"px",ut.style.display="block",s.element().appendChild(ut)}else ft||(o.doDrag(tt,g),vt===!0&&yi(l,tt,g),tt=g);else if(b.length>0){u=b.length;if(a.length>=u){switch(u){case 1:ft||(o.doDrag(b[0],a[0]),vt===!0&&yi(l,b[0],a[0]));break;case 2:d=ft?st():ci(b),ot=ft?st():ci(a);if(!a[0]||!a[1]||!b[0]||!b[1])return;bt=1,et||(bt=i.distance(b[0],b[1])/i.distance(a[0],a[1])),k=0;if(rt.length>1&&r.isRotationEnabled()){var dt=new gt(rt[1].x-rt[0].x,rt[1].y-rt[0].y),kt=new gt(a[1].x-a[0].x,a[1].y-a[0].y),fi=Math.atan2(kt.y,kt.x)-Math.atan2(dt.y,dt.x);k=fr-r.getCurrentCamera().getHeading()-fi*180/Math.PI}o.setCamera(bt,d,ot,k)}while(u--)b[u]=a[u]}}else if(ht()){lt=r.requestCssAnimation(!0);if(lt){var n=new i(it.x,it.y),ct=1/t.maxFPS,ii=0;while(ht())n.x+=p.x*ct,n.y+=p.y*ct,ii+=ct,ai();lt.setDuration(ii),r.suspendSceneChanges(!0),o.doDrag(it,n,!0),it=n}else{if(it){var n=new i(it.x+p.x*l/1e3,it.y+p.y*l/1e3),d=new i(Math.round(it.x),Math.round(it.y)),ot=new i(Math.round(n.x),Math.round(n.y));o.doDrag(d,ot),it=n}ai(),ht()?r.ensureUpdateDispatched():o.endUserInput()}}else o.endUserInput()}}function eu(n,t){var e=null,o=.003*u.scrollAdjustment,r=0;this.doDrag=function(r,u,f){if(r&&u&&!i.areEqual(r,u)){var o=t.getViewportX(),e=t.getViewportY(),c=new i(r.x-o,r.y-e),h=new i(u.x-o,u.y-e),s=n.getCurrentCamera().getViewportToWorld().transform(c);n.setAlignedCamera(n.getCurrentCamera().getCrs(),s,h,n.getCurrentCamera().getWidth(),n.getCurrentCamera().getHeading(),f)}},this.doDragXY=function(t,r){var f=n.getCurrentCamera().getWidth(),u=n.getCurrentCamera().getViewportToWorld().transform(new i(t,r));n.setAlignedCamera(n.getCurrentCamera().getCrs(),u,null,f,n.getCurrentCamera().getHeading(),!0)},this.zoom=function(t){var i=n.getCurrentCamera().getWidth()*t,r=n.getCurrentCamera().getLookAt();i!==n.getTargetCamera().getWidth()&&n.setAlignedCamera(n.getCurrentCamera().getCrs(),r,null,i,n.getCurrentCamera().getHeading(),!0)},this.zoomCenter=function(t,i,r,u){var o=n.getTargetCamera(),h=o.getWidth()*t,c=o.getViewportToWorld().transform(i),e,s;u&&(e=f.widthToMercatorZoom(h,o.getCrs(),o.getLookAt()),e!=Math.floor(e)&&(s=e-o.getMercatorZoom()>0?Math.floor(e):Math.ceil(e),e=s+Math.round(e-s),h=f.mercatorZoomToWidth(e,o.getCrs(),o.getLookAt()))),n.requestCssAnimation(),n.setAlignedCamera(o.getCrs(),c,r,h,o.getHeading(),!0)},this.zoomPoint=function(t,i){var y=new Date,h=y-e,l,s,c,u,v,a;e=y,l=n.getCurrentCamera().getViewportToWorld().transform(i),s=o*t*(t>0?1:.75),h>200?(h=200,r=s/h):r=(r+s/h)/2,r=Math.min(.009,r),r=Math.max(-.006,r),c=n.getCurrentCamera().getMercatorZoom(),u=c+r*(r>0?400:250),u=s>0?Math.min(n.getInternalMaxZoom(),Math.ceil(u)):Math.max(n.getInternalMinZoom(),Math.floor(u)),v=f.mercatorZoomToWidth(u,n.getCurrentCamera().getCrs(),l),a=(u-c)/r*1.5,n.setAlignedCamera(n.getCurrentCamera().getCrs(),l,i,v,n.getCurrentCamera().getHeading(),a)},this.rotate=function(t){n.setAlignedCamera(n.getTargetCamera().getCrs(),n.getTargetCamera().getLookAt(),null,n.getTargetCamera().getWidth(),n.getTargetCamera().getHeading()+t,!0)},this.setCamera=function(t,i,r,u){var e=n.getCurrentCamera().getViewportToWorld().transform(i),f=c.log2(1/t);n.setCamera(n.getCurrentCamera().getAlignedCamera(f,e,r,u),!1)},this.startUserInput=function(){},this.endUserInput=function(){}}function yu(i){function et(n,t,i,r,u,f){var it,l,b,w,tt;if(r>=rt){it=ft.toEllipsoid(new p(t,i)),l=a.wrap(a.fromLocation(it));if(y(n,l,r,u,f))return n;var st=1<<g,et=d.mercatorXYToTileId(l,g),v=d.tileIdToCacheKey(et),ut=Math.round(c.normalizeDegrees(u)/s)*s%360,h=e.get(v)||[],nt=h.length,k;while(nt--){k=h[nt];if(y(k,l,r,u,f))return k}b="h"+ut.toFixed(),h[b]||(h[b]=!0,e.insert(v,h),w=d.tileIdToLocation(et),tt=o.replace("{centerpoint}",w.latitude.toFixed(6)+","+w.longitude.toFixed(6)).replace("{heading}",ut.toFixed(0)),ei.getObjectAsync(tt,ot,v))}return null}function ot(t,i){var f=i.userData,r,u;i.success&&t&&t.statusCode===200&&t.resourceSets&&t.resourceSets.length&&(r=t.resourceSets[0],r.resources&&r.resources.length&&(u=e.get(f)||[],nt(r.resources[0],u),e.insert(f,u),n.invoke(h,"newsceneavailable")))}function nt(n,i){var rt;if(n.bes&&n.bes.bec&&n.bes.bei){var s=n.bes,kt=s.s.toString(),o=s.bei,e=s.bec,w=k.get(kt);if(!w){w=[];var ot=2*Math.ceil(o.piw/(2*u)),ct=2*Math.ceil(o.pih/(2*u)),st=ot*u,d=new r(e.qcx,e.qcy,e.qcz),wt=new r(e.qdx,e.qdy,e.qdz),ti=new r(e.qex,e.qey,e.qez),g=fr.toLocation(d),ii=ft.getAltitudeAtLatLon(g.latitude,g.longitude),bt=fr.fromLocation(new p(g.latitude,g.longitude,ii,dt.ellipsoid)),ui=ri.fromNormal(bt,fr.getUpVector(bt)),ni=ui.intersectWithLine(d,r.add(d,wt)),gt=r.subtract(ni,d).getLength(),yt=st/o.piw*(e.ox/(2*e.ol)),si=2*Math.atan(yt),oi=2*gt*yt,ei=f.fromDirectionVector(fr,ni,oi,wt,ti,1/gt),nt=ei.convertCoordinateReferenceSystem(a),at=(o.piw-b)/st,lt=(o.pih-b)/st,vt=new pt(-at/2-e.opx,-lt/2-e.opy,at,lt),h,y,et;y=v(ut.replace("{quadkey}",s.q).replace("{runtimeindex}",s.ri),ot,ct,s.l,e.opx*o.piw,e.opy*o.pih),y.projectingCamera=nt,et=nt.getAlignedCamera(c.log2(y.getWidth()/t.zoomOriginWidth)-1),h=new ht(et,y,1,"NativeBirdseye",new fi("Birdseye",l)),h.nativeBirdseyeFrustumRect=vt,h.labelOverlay=it.hidden,w.push(h),y=v(tt.replace("{quadkey}",s.q).replace("{runtimeindex}",s.ri),ot,ct,s.l,e.opx*o.piw,e.opy*o.pih),y.projectingCamera=nt,h=new ht(et,y,1,"NativeBirdseye",new fi("BirdseyeWithLabels",l)),h.nativeBirdseyeFrustumRect=vt,h.labelOverlay=it.visible,w.push(h)}k.insert(kt,w),rt=w.length;while(rt--)i.push(w[rt])}}function y(n,t,i,r,u){if(n&&n.nativeBirdseyeFrustumRect&&n.labelOverlay===u&&c.distanceDegrees(r,n.nativeCamera.getHeading())<s&&i>=n.nativeCamera.getMercatorZoom()-.5){var f=n.tilePyramid.projectingCamera.getWorldToFrustum().transform(t);if(n.nativeBirdseyeFrustumRect.contains(f))return!0}return!1}function v(n,t,i,r,f,e){var s=Math.ceil(t/2),h=Math.ceil(i/2),o=new kt(t*u,i*u,u,u,0,0,f,e,function(u){var e,f,c;switch(u.levelOfDetail){case o.getMaxLevelOfDetail()-1:f=s,c=h,e=r-1;break;case o.getMaxLevelOfDetail():f=t,c=i,e=r}if(e)if(u.x>=0&&u.x<f&&u.y>=0&&u.y<c)return n.replace("{subdomain}",(u.y&1)*2+(u.x&1)).replace("{level}",e).replace("{index}",f*u.y+u.x);return null});return o}var h=this,l=i.credentialsProvider,ut=i.urlFormat,tt=i.urlWithLabelsFormat,rt=17.1,e=new yi(100),g=19,k=new yi(100),s=45,b=400,u=256,o=t.nativeBirdseyeMetadataUrl.replace("{zoom}","20"),w;this.priority=40,this.getScene=function(){return w||(w=!0,l(function(t){o=o.replace("{credentials}",t),h.getScene=et,n.invoke(h,"newsceneavailable")})),null}}var s=window[$MapsNamespace].Maps,v=s.Gimme,t=s.Globals,ar,h,l,y,li,u,b,hi,dt,wt,it,si,n,cr,ki,wi,ei,ui,ur,lr,yr,br,ou,nt,pi,wr,c,tt,a,fr,ut,d,ft,w,o,ti,et,oi,du,ru,hu,hr;window[$MapsNamespace].Maps.Resources=new function(n){n=n||{},n.strings={},this.init=function(t){var i;for(i in t)n.strings[i]={value:t[i]}},this.getString=function(){function f(n){i.languages=[t.locale];var r="";try{r=e.getValue(n,i).valueAsString}catch(u){}return r}function u(t){return n.strings[t]&&n.strings[t].value||""}if(window.Windows&&Windows.ApplicationModel){var r=Windows.ApplicationModel.Resources.Core,e=r.ResourceManager.current.mainResourceMap.getSubtree("/Bing.Maps.Javascript/Resources"),i=new r.ResourceContext;return f}return u}()}(this),ar=s.Resources,ar.init({L_microsoftcopyright_text:"© {year} Microsoft Corporation",L_VersionMismatchMessage_Text:"A new version of Bing Maps SDK is available",L_VersionNotSupportedMessage_Text:"This version of Bing Maps SDK is not supported"}),l={},y="mm$",typeof PRF=="undefined"&&(PRF={add:function(){},start:function(){},end:function(){}}),l.PRF=PRF,PRF.start("mapcore"),li=new function(){var n=1e3;this.getNext=function(){return n++}},l.IdGenerator=li;var ii=new function(){this.isValidNumber=function(n){return typeof n=="number"&&isFinite(n)},this.cloneObject=function(n){var i={},t;for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i},this.createElement=function(n,t,i){var r=document.createElement(n||"div");return t&&(r.style.cssText=t),i&&i.appendChild(r),r},this.ignoreEvent=function(n){n.stopPropagation(),n.preventDefault()},this.stopPropagation=function(n){n.stopPropagation()},this.prioritySort=function(n,t){return n.priority-t.priority},this.isArray=function(n){return typeof Array.isArray=="function"?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"},this.extend=function(n,t){function i(){}i.prototype=t.prototype,n.prototype=new i,n.prototype.constructor=n,n.baseConstructor=t,n.superClass=t.prototype},this.restrictLongitude=function(n,t){while(t-n>180&&t>n)t-=360;while(n-t>180&&t<n)t+=360;return t};var n=function(){function t(n,t,i){return Object.defineProperty(n,t,i)}function n(n,t,i){return n[t]=i.get(),n}try{return Object.defineProperty({},"test",{}),t}catch(i){return n}}();this.defineGetter=n,this.defaultCopyright=n({},"text",{get:function(){return ar.getString("L_microsoftcopyright_text").replace(/{year}/,(new Date).getFullYear())}})},bt=1e-11,ai=ii.isValidNumber,uu=ii.cloneObject,k=ii.createElement,tf=ii.ignoreEvent,nf=ii.stopPropagation,ku=ii.prioritySort,ir=ii.isArray,gu=ii.extend,vu=ii.restrictLongitude;l.Common=ii,u=new function(){var n=navigator.userAgent,f=n.indexOf("MSIE"),s=n.indexOf("Firefox"),v=n.indexOf("Chrome"),nt=s!==-1,g=v!==-1,i=f!==-1,e=parseInt(n.substring(f+5)),d=i&&e===6,tt=i&&e===9,p=i&&e===10,rt=g&&parseInt(n.substring(v+7))>=11,w=nt&&parseInt(n.substring(s+8))>=4,ut=document.documentMode,it=n.indexOf("Gecko"),l=it!==-1,c=n.indexOf("Trident/"),o=parseInt(n.substring(c+8)),y=c>0,h=n.indexOf("BlackBerry")!==-1,u=n.indexOf("AppleWebKit")!==-1,t=navigator.vendor==="Apple Computer, Inc."&&!h,a=t&&n.indexOf("iPhone OS 3_")!==-1,k=u&&n.indexOf("Android")!==-1,b=typeof WinJS!="undefined"&&p,r;this.isWebkit=u,this.cursorHotspot=u?" 10 9":"",this.allowCssAnimations=t,this.useTransform2d=y&&o>=6&&typeof document.createElement("div").style.msTransform!="undefined",this.useTransform3d=t,this.useTransform3dForTranslate=t,this.useImageDisposer=t,this.isIOSBrowser=n.indexOf("iPhone")!==-1,this.safariRenderHack=t?"-webkit-transform:translate3d(0px,0px,0px);":"",this.isIE6=d,this.isIE9=tt,this.isIE10=p,this.useXHR=b,this.isIOS3=a,r=y&&o>=5,this.useFilterReflowWorkaround=r,this.cssZoomAffectsTopLeft=function(){var n=function(){var n=document.createElement("div"),t,i;return n.style.cssText="position:absolute;top:-1000px;left:-1000px;width:100px;zoom:2;",t=document.createElement("div"),t.style.cssText="position:relative;width:10px;left:50%;",n.appendChild(t),document.body.appendChild(n),i=t.offsetLeft,n.parentNode.removeChild(n),i!==50}();return this.cssZoomAffectsTopLeft=function(){return n},n},this.animateOverlayLayers=r||rt||w||t,this.animateShapes=this.animateOverlayLayers&&!a,this.canRenderOpacityAndRotationOnSemiTransparentPngs=!(i&&!r),this.scrollAdjustment=1,this.useOnResize=r,this.autoSizesElementsTooSmall=l||u,this.opacityGlitchAtBrowserEdges=l,this.isIE8OrEarlier=i&&parseInt(n.substring(f+5))<9,this.isIE7OrEarlier=i&&parseInt(n.substring(f+5))<8,this.emulateDblClick=h,this.isShapeEventsSupported=function(){return typeof oi!="undefined"&&oi.isEventsSupported?oi.isEventsSupported():!0},this.allowFocus=!k},l.Quirks=u,b=new function(){function o(){r=null,n.length&&u();var i=n;n=t,t=i,t.sort(e);while(t.length)t.shift()()}function e(n,t){return n[i]-t[i]}function u(){r||(r=f(o))}var f=v.Effects.Animation.requestAnimationFrame,r,n=[],t=[],i=y+"dispatchOrder";this.dispatch=function(t,r){t[i]=r||0;var f=n.length;while(f--)if(n[f]===t)return;n.push(t),u()},this.cancelDispatch=function(i){var r;r=n.length;while(r--)n[r]===i&&n.splice(r,1);r=t.length;while(r--)t[r]===i&&t.splice(r,1)}},l.Dispatcher=b,i.prototype={clone:function(){return new i(this.x,this.y)},toString:function(){return"[Point "+this.x+","+this.y+"]"}},i.clone=function(n){return new i(n.x,n.y)},i.add=function(n,t){return new i(n.x+t.x,n.y+t.y)},i.distance=function(n,t){var r=n.x-t.x,i=n.y-t.y;return Math.sqrt(r*r+i*i)},i.subtract=function(n,t){return new i(n.x-t.x,n.y-t.y)},i.multiply=function(n,t){return new i(n.x*t,n.y*t)},i.areEqual=function(n,t){return n&&t&&n.x===t.x&&n.y===t.y},s.Point=i,hi={fromTileId:function(n,t){var e=1,i;t&&(e=0);var r="",f=n.x,u=n.y;for(i=0;i<n.levelOfDetail;i++)r=((f&1)+2*(u&1)).toString()+r,f>>=1,u>>=1;return r},toTileId:function(n){var i=0,t=0,u=0,r;if(n!=null&&n.length>0)for(u=n.length,r=0;r<n.length;r++)switch(n.charAt(r)){case"0":i=i*2+0,t=t*2+0;break;case"1":i=i*2+1,t=t*2+0;break;case"2":i=i*2+0,t=t*2+1;break;case"3":i=i*2+1,t=t*2+1}return new rt(u,i,t)},wrapX:function(n){var t=1<<n.levelOfDetail;return new rt(n.levelOfDetail,(n.x%t+t)%t,n.y)},wrapY:function(n){var t=1<<n.levelOfDetail;return new rt(n.levelOfDetail,n.x,(n.y%t+t)%t)},isInBounds:function(n){if(n.x<0||n.y<0)return!1;var t=1<<n.levelOfDetail;return n.x>=t||n.y>=t?!1:!0}},s.QuadKey=hi,dt={ground:0,ellipsoid:1,isValid:function(n){return n===dt.ground||n===dt.ellipsoid}},s.AltitudeReference=dt,p.prototype={clone:function(){return new p(this.latitude,this.longitude,this.altitude,this.altitudeReference)},toString:function(){return"[Location "+this.latitude+","+this.longitude+(this.altitude!==h&&this.altitudeReference!==h?","+this.altitude+","+this.altitudeReference:"")+"]"}},p.normalizeLongitude=function(n){return n<-180||n>180?n-Math.floor((n+180)/360)*360:n},p.areEqual=function(n,t){return n&&t&&n.latitude===t.latitude&&n.longitude===t.longitude&&n.altitude===t.altitude&&n.altitudeReference===t.altitudeReference},s.Location=p,ct.prototype={getNorthwest:function(){return new p(this.getNorth(),this.getWest(),this.center.altitude,this.center.altitudeReference)},getSoutheast:function(){return new p(this.getSouth(),this.getEast(),this.center.altitude,this.center.altitudeReference)},getNorth:function(){return this.center.latitude+this.height/2},getSouth:function(){return this.center.latitude-this.height/2},getWest:function(){return this.width>=360?-180:p.normalizeLongitude(this.center.longitude-this.width/2)},getEast:function(){return this.width>=360?180:p.normalizeLongitude(this.center.longitude+this.width/2)},toString:function(){return"[LocationRect "+this.center.toString()+" "+this.width+","+this.height+"]"},clone:function(){return new ct(this.center.clone(),this.width,this.height)},contains:function(n){var i=Math.abs(this.center.latitude-n.latitude),t=Math.abs(this.center.longitude-n.longitude);return t>180&&(t=360-t),i<=this.height/2&&t<=this.width/2},intersects:function(n){var i=Math.abs(this.center.latitude-n.center.latitude),t=Math.abs(this.center.longitude-n.center.longitude);return t>180&&(t=360-t),i<=this.height/2+n.height/2&&t<=this.width/2+n.width/2}},ct.fromEdges=function(n,t,i,r,u,f){return Math.abs(r-t)>360&&(t=-180,r=180),t=p.normalizeLongitude(t),r=p.normalizeLongitude(r),t>r&&(r+=360),new ct(new p((i+n)/2,(t+r)/2,u,f),r-t,n-i)},ct.fromCorners=function(n,t){return ct.fromEdges(n.latitude,n.longitude,t.latitude,t.longitude,n.altitude,n.altitudeReference)},ct.fromLocations=function(){var i=ir(arguments[0])?arguments[0]:arguments,e,f,r,u,s,c,t,l=i&&i.length?i[0].longitude:0,n,o=i.length;while(o--)n=i[o],isFinite(n.latitude)&&isFinite(n.longitude)&&(e=e===h?n.latitude:Math.max(e,n.latitude),f=f===h?n.latitude:Math.min(f,n.latitude),t=vu(l,n.longitude),u=u===h?t:Math.max(u,t),r=r===h?t:Math.min(r,t),isFinite(n.altitude)&&dt.isValid(n.altitudeReference)&&(c=n.altitude,s=n.altitudeReference));return ct.fromEdges(e,r,f,u,c,s)},ct.fromString=function(n){var f=null,t=n.split(","),e,u,i,r;return t&&t.length==4&&(e=parseFloat(t[0]),u=parseFloat(t[1]),i=parseFloat(t[2]),r=parseFloat(t[3]),f=ct.fromEdges(e,u,i,r)),f},s.LocationRect=ct,wt={road:"r",aerial:"a",birdseye:"be"},s.MapTypeId=wt,it={visible:0,hidden:1,isValid:function(n){return n===it.hidden||n===it.visible}},s.LabelOverlay=it,si={viewport:0,page:1,control:2,isValid:function(n){return n===si.viewport||n===si.page||n===si.control}},s.PixelReference=si,n=new function(){var t=this,n=y+"events";this.addHandler=function(t,i,r){var f=null,u;return t&&typeof i=="string"&&typeof r=="function"&&(t[n]=t[n]||{},u=t[n][i]||[],t[n][i]=u,f={target:t,eventName:i,handler:r},u.push(f)),f},this.addThrottledHandler=function(n,i,r,u){var f=t.addHandler(n,i,r);return f.throttleInterval=u,f},this.removeHandler=function(i){var e,f,r,u;if(i){e=i.target,f=i.eventName;if(t.hasHandler(e,f)){r=e[n][f],u=r.length;while(u--)i===r[u]&&(i.willBeInvokedBy&&window.clearInterval(i.willBeInvokedBy),r.splice(u,1))}}},this.hasHandler=function(n,t){return this.getHandlers(n,t)!==null},this.getHandlers=function(t,i){var r=t&&t[n]&&t[n][i]&&t[n][i];return r&&r.length>0?r:null},this.invoke=function(i,r,u){var e;if(t.hasHandler(i,r)){var o=new Date,s=i[n][r],c=s.length,f;u=u||{},u.eventName===h&&(u.eventName=r);while(c--)f=s[c],f.handler&&(f.throttleInterval?f.willBeInvokedBy?f.willBeInvokedWithArgs=u:(e=f.throttleInterval-(o-(f.lastInvokedAt||new Date(0))),e>0?(f.willBeInvokedWithArgs=u,f.willBeInvokedBy=window.setTimeout(function(){var n=f;return function(){var t=n.willBeInvokedWithArgs;delete n.willBeInvokedBy,delete n.willBeInvokedWithArgs,n.lastInvokedAt=new Date,n.handler&&n.handler(t)}}(),e)):(f.lastInvokedAt=o,f.handler(u))):f.handler(u))}}},s.Events=n,l.ElementSizeHelper=lu,cr={singleByteHex:function(n){var t,i;if(!n)return"";for(t=n.toString(16),i=t.length;i<2;i++)t="0"+t;return t},twoByteHex:function(n){var t,i;if(!n)return"";for(t=n.toString(16),i=t.length;i<4;i++)t="0"+t;return t},encodeHtml:function(n){var t,u,i,r;if(n==null)return"";for(u=n.length,i=new Array(u),r=0;r<u;r++)t=n.charCodeAt(r),t>96&&t<123||t>64&&t<91||t==32||t>47&&t<58||t==46||t==44||t==45||t==95?i.push(String.fromCharCode(t)):i.push("&#"+t+";");return i.join("")},encodeUrl:function(n){var t,u,i,r;if(!n)return"";for(u=n.length,i=new Array(u),r=0;r<u;++r)t=n.charCodeAt(r),t>96&&t<123||t>64&&t<91||t>47&&t<58||t==46||t==45||t==95?i.push(String.fromCharCode(t)):t>127?(i.push("%u"),i.push(cr.twoByteHex(t))):(i.push("%"),i.push(cr.singleByteHex(t)));return i.join("")}},l.IOSec=cr,ki=[],or.getAllInstances=function(){return ki},or.getVersion=function(){return t.version},s.Map=or,l.MapType=ci,ei=new function(){function l(i,r){b.dispatch(function(){i&&!r&&(r=t);if(r){var f=n[r];f&&(delete n[r],f.timeoutId&&window.clearTimeout(f.timeoutId),f.callback(i,{requestId:r,success:!0,userData:f.userData}),u(f.elScript))}})}function o(t){if(t){var i=n[t];i&&(delete n[t],i.callback(null,{requestId:t,success:!1,userData:i.userData}),u(i.elScript))}}function i(n){var u,i;return u=r(),u?(i=document.createElement("script"),i.type="text/javascript",i.language="javascript",i.src=n,u.appendChild(i),i):void 0}function h(n,t,i){var f,u;return f=r(),f?(u=document.createElement("link"),u.rel=t?"alternate stylesheet":"stylesheet",i&&(u.media=i),u.type="text/css",u.rev="stylesheet",u.href=n,f.appendChild(u),u):void 0}function r(){if(!f){var n=document.getElementsByTagName("head");n.length>0&&(f=n[0])}return f}function s(n,t,i){u(i),n&&n(t)}function u(n){n&&(n.src&&(n.src=""),n.parentNode&&n.parentNode.removeChild(n))}var a=this,e=5e3,f,c=1,t,n={};window.microsoftMapsNetworkCallback=l,this.downloadScript=function(n){return i(n)},this.downloadStyles=function(n,t,i){h(n,t,i)},this.getObjectAsync=function(t,r,u,f,s){var h=s;return h||(h="r"+ ++c,t=t.replace("{jsono}",h)),typeof f=="number"&&f>0||(f=e),n[h]={callback:r,userData:u,elScript:i(t,h),timeoutId:window.setTimeout(function(){o(h)},f)},h},this.getObjectAsyncWithNoJsonso=function(r,u,f,s){t="_logCallbackRequest",typeof s=="number"&&s>0||(s=e),n[t]={callback:u,userData:f,elScript:i(r,t),timeoutId:window.setTimeout(function(){o(t)},s)}},this.isRequestCompleted=function(t){return n[t]?!1:!0},this.abortRequest=function(t){n[t]&&delete n[t]},this.getObjectAsyncCacheFriendly=function(n,t,i){var u=document.createElement("script");return u.type="text/javascript",u.language="javascript",u.src=n,navigator.userAgent.indexOf("IE")<0?u.onload=function(){u.onload=null,s(t,i,u)}:u.onreadystatechange=function(){u&&("loaded"==u.readyState||"complete"==u.readyState)&&(u.onreadystatechange=null,s(t,i,u))},r().appendChild(u),u}},l.Network=ei,ui={map:"map",pushpin:"pushpin",polyline:"polyline",polygon:"polygon",infobox:"infobox"},vi.prototype={handled:!1,toString:function(){return"[MouseEventArgs]"}},l.MouseEventArgs=vi,l.EventTargetType=ui,vr.prototype={handled:!1,toString:function(){return"[KeyEventArgs]"}},l.KeyEventArgs=vr,at.prototype={clone:function(){return new at(this.a,this.r,this.g,this.b)},getOpacity:function(){return isFinite(this.a)?this.a/255:1},toHex:function(){var i=this.r,t=this.g,n=this.b;return"#"+(i<16?"0":"")+Number(i).toString(16)+(t<16?"0":"")+Number(t).toString(16)+(n<16?"0":"")+Number(n).toString(16)},toString:function(){return"[Color "+this.toHex()+"]"}},at.clone=function(n){return new at(n.a,n.r,n.g,n.b)},at.fromHex=function(n){var i=null,t=/^#(\w{2})(\w{2})(\w{2})$/.exec(n);return t&&t.length==4&&(i=new at(255,parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16))),i},s.Color=at,di.prototype={_visible:!0,_zIndex:null,setOptions:function(t,i){var r=!1;return t&&(typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.zIndex!="undefined"&&(this._zIndex=t.zIndex,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},toString:function(){return"[EntityCollection]"}},s.EntityCollection=di,ur={standard:"Infobox",mini:"MiniInfobox2",expanded:"Infobox2"},s.InfoboxType=ur,cu.prototype={_width:256,_height:126,_showCloseButton:!0,_offset:new i(0,0),_htmlContent:null,_id:null,_typeName:ur.standard,_visible:!0,_zIndex:null,_options:null,_calculatedSize:null,_clip:!0,_shouldFireEvents:!0,setLocation:function(t){this._location=t,n.invoke(this,"entitychanged",{entity:this})},getLocation:function(){return this._location},setCalculatedSize:function(n){this._calculatedSize=n},measure:function(){return this._calculatedSize||{width:0,height:0}},setOptions:function(t,r){if(t){var u=!1;this._options=t,(t.width>0||t.width===null||t.width==="auto")&&(this._width=t.width===null?"auto":t.width,u=!0),(t.height>0||t.height===null)&&(this._height=t.height,u=!0),typeof t.showCloseButton=="boolean"&&(this._showCloseButton=t.showCloseButton,u=!0),t.offset&&(this._offset=i.clone(t.offset),u=!0),typeof t.htmlContent=="string"&&(this._htmlContent=t.htmlContent,u=!0),typeof t.id=="string"&&(this._id=t.id,u=!0),typeof t.typeName=="string"&&(this._typeName=t.typeName,u=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,u=!0),isFinite(t.zIndex)&&(this._zIndex=t.zIndex,u=!0),typeof t.clip=="boolean"&&(this._clip=t.clip,u=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,u=!0)}return u&&(r===null||!r)&&n.invoke(this,"entitychanged",{entity:this}),u},getWidth:function(){return this._width},getHeight:function(){return this._height},getShowCloseButton:function(){return this._showCloseButton},getOffset:function(){return this._offset},getOptions:function(){return this._options},getShouldFireEvents:function(){return this._shouldFireEvents},setHtmlContent:function(t){var i=this._htmlContent!=t;this._htmlContent=t,this._showPointer=!1,i&&n.invoke(this,"entitychanged",{entity:this})},getHtmlContent:function(){return this._htmlContent},getId:function(){return this._id},getTypeName:function(){return this._typeName},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},getClip:function(){return this._clip},receiveFocus:function(t){n.invoke(this,"focusreceived",{entity:this,nativeEvent:t.nativeEvent,forwardFocus:t.forwardFocus})},toString:function(){return"[InfoboxBase]"}},gu(g,cu),s.Infobox=g,g.prototype._title=null,g.prototype._titleAction=null,g.prototype._description=null,g.prototype._titleClickHandler=null,g.prototype._showPointer=!0,g.prototype._actions=[],g.prototype._pushpin=null,g.prototype._polygon=null,g.prototype.setOptions=function(t,i){if(t){var r=g.superClass.setOptions.call(this,t,!1);(typeof t.title=="string"||t.title===null)&&(this._title=t.title,r=!0),(typeof t.description=="string"||t.description&&t.description.innerHTML)&&(this._description=t.description,r=!0),typeof t.showPointer=="boolean"&&(this._showPointer=t.showPointer,r=!0),(typeof t.actions=="object"||t.actions===null)&&(this._actions=t.actions||[],r=!0),(typeof t.titleAction=="object"||t.titleAction===null)&&(this._titleAction=t.titleAction,r=!0),(typeof t.titleClickHandler=="function"||t.titleClickHandler===null)&&(this._titleClickHandler=t.titleClickHandler,r=!0),t.pushpin&&t.pushpin instanceof s.Pushpin&&(this._pushpin=t.pushpin,this._pushpin.getInfobox()!=this&&this._pushpin.setOptions({infobox:this}),r=!0),t.polygon&&t.polygon instanceof s.Polygon&&(this._polygon=t.polygon,this._polygon.getInfobox()!=this&&this._polygon.setOptions({infobox:this}),r=!0),(this._typeName===ur.mini||typeof this._htmlContent=="string")&&(this._showPointer=!1),r&&(i===null||!i)&&n.invoke(this,"entitychanged",{entity:this})}},g.prototype.getActions=function(){return this._actions},g.prototype.getTitle=function(){return this._title},g.prototype.getTitleAction=function(){return this._titleAction},g.prototype.getTitleClickHandler=function(){return this._titleClickHandler},g.prototype.getDescription=function(){return this._description},g.prototype.getShowPointer=function(){return this._showPointer},g.prototype.getPushpin=function(){return this._pushpin},g.prototype.getPolygon=function(){return this._polygon},g.prototype.getAnchor=function(){var n,t=this._calculatedSize&&this._calculatedSize.height||0,r;return this._showPointer?this._typeName!==ur.standard?(n=10,new i(20+n/2,t)):(n=28,r=38,new i(20+n/2,this.getHeight()+r)):t!==0?new i(0,t):new i(0,this.getHeight()||0)},g.prototype.getOptions=function(){return g.superClass.getOptions.call(this)},g.prototype.toString=function(){return"[Infobox]"},lr={highlighted:2,selected:1,none:0},yr={none:0,highlight:1,zoom:2},nr.getDefaultIcon=function(){return{width:25,height:39,anchor:new i(13,39),textOffset:new i(0,5),url:t.pushpinImageUrl}},nr.prototype={_width:25,_height:39,_draggable:!1,_anchor:null,_calculatedAnchor:new i(13,39),_htmlContent:null,_text:null,_textOffset:new i(0,5),_id:null,_typeName:null,_visible:!0,_zIndex:null,_useTransform3d:!0,_infobox:null,_state:lr.none,setLocation:function(t){this._location=t,n.invoke(this,"entitychanged",{entity:this})},getLocation:function(){return this._location},setOptions:function(t,r){var u=!1;return t&&(typeof t.icon=="string"&&(this._icon=t.icon,u=!0),t.width!==h&&(this._width=t.width>0?t.width:0,u=!0),t.height!==h&&(this._height=t.height>0?t.height:0,u=!0),typeof t.draggable=="boolean"&&(this._draggable=t.draggable,u=!0),t.anchor&&(this._anchor=i.clone(t.anchor),u=!0),typeof t.htmlContent=="string"&&(this._htmlContent=t.htmlContent,u=!0),typeof t.text=="string"&&(this._text=t.text,u=!0),t.textOffset&&(this._textOffset=i.clone(t.textOffset),u=!0),typeof t.id=="string"&&(this._id=t.id,u=!0),typeof t.typeName=="string"&&(this._typeName=t.typeName,u=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,u=!0),isFinite(t.zIndex)&&(this._zIndex=t.zIndex,u=!0),t.infobox&&t.infobox instanceof g&&(this._infobox=t.infobox,this._infobox.getPushpin()!=this&&this._infobox.setOptions({pushpin:this}),u=!0),typeof t.state=="number"&&(this._state=t.state,u=!0),u&&!r&&(this._calculatedAnchor=this._anchor?this._anchor:new i(Math.ceil(this._width/2),this._height),n.invoke(this,"entitychanged",{entity:this}))),u},getIcon:function(){return this._icon},getWidth:function(){return this._width},getHeight:function(){return this._height},getDraggable:function(){return this._draggable},getAnchor:function(){return this._calculatedAnchor},getHtmlContent:function(){return this._htmlContent},getText:function(){return this._text},getTextOffset:function(){return this._textOffset},getId:function(){return this._id},getTypeName:function(){return this._typeName},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},getUseTransform3d:function(){return this._useTransform3d},getInfobox:function(){return this._infobox},getState:function(){return this._state},receiveFocus:function(){n.invoke(this,"focusreceived",{entity:this})},toString:function(){return"[Pushpin]"}},s.EntityState=lr,s.PinFocusBehavior=yr,s.Pushpin=nr,gi.prototype={_strokeColor:new at(255,255,0,0),_strokeThickness:3,_strokeDashArray:"none",_visible:!0,_id:null,_shouldFireEvents:!0,setLocations:function(t){this._locations=t,n.invoke(this,"entitychanged",{entity:this})},getLocations:function(){return this._locations},setOptions:function(t,i){var r=!1;return t&&(t.strokeColor&&(this._strokeColor=at.clone(t.strokeColor),r=!0),isFinite(t.strokeThickness)&&(this._strokeThickness=t.strokeThickness,r=!0),typeof t.strokeDashArray=="string"&&(this._strokeDashArray=t.strokeDashArray,r=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.id=="string"&&(this._id=t.id,r=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getStrokeColor:function(){return this._strokeColor},getStrokeThickness:function(){return this._strokeThickness},getStrokeDashArray:function(){return this._strokeDashArray},getVisible:function(){return this._visible},getId:function(){return this._id},getShouldFireEvents:function(){return this._shouldFireEvents},toString:function(){return"[Polyline]"}},s.Polyline=gi,tr.prototype={_strokeColor:new at(255,255,0,0),_strokeThickness:3,_strokeDashArray:"none",_fillColor:new at(255,0,0,255),_visible:!0,_infobox:null,_shouldFireEvents:!0,_state:lr.none,_id:null,setLocations:function(t){this._locations=t,n.invoke(this,"entitychanged",{entity:this})},getLocations:function(){return this._locations},setOptions:function(t,i){var r=!1;return t&&(t.strokeColor&&(this._strokeColor=at.clone(t.strokeColor),r=!0),isFinite(t.strokeThickness)&&(this._strokeThickness=t.strokeThickness,r=!0),typeof t.strokeDashArray=="string"&&(this._strokeDashArray=t.strokeDashArray,r=!0),t.fillColor&&(this._fillColor=at.clone(t.fillColor),r=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.id=="string"&&(this._id=t.id,r=!0),t.infobox&&t.infobox instanceof s.Infobox&&(this._infobox=t.infobox,this._infobox.getPolygon()!=this&&this._infobox.setOptions({polygon:this}),r=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,r=!0),typeof t.state=="number"&&(this._state=t.state,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getStrokeColor:function(){return this._strokeColor},getStrokeThickness:function(){return this._strokeThickness},getStrokeDashArray:function(){return this._strokeDashArray},getFillColor:function(){return this._fillColor},getVisible:function(){return this._visible},getInfobox:function(){return this._infobox},getShouldFireEvents:function(){return this._shouldFireEvents},getState:function(){return this._state},toString:function(){return"[Polygon]"}},s.Polygon=tr,br={show:"s",hide:"h",auto:"a"},sr.prototype={toString:function(){return"[TileLayer]"}},s.AnimationVisibility=br,s.TileLayer=sr,tu.prototype={toString:function(){return"[TileSource]"}},s.TileSource=tu,s.Globals.disableGeoLocation||(ou=function(n){function w(n,i,r){if(t&&r===t&&n&&n.coords){var u=new p(n.coords.latitude,n.coords.longitude,n.coords.altitude);(!i||i&&i.showAccuracyCircle!=!1)&&f.addAccuracyCircle(u,n.coords.accuracy,a,{displayOnMap:!0}),(!i||i&&i.updateMapView!=!1)&&l(n),i&&i.successCallback&&i.successCallback({center:u,position:n})}t=0}function h(n,i,r){t&&r===t&&i.errorCallback&&i.errorCallback({internalError:n,errorCode:n.code}),t=0}function l(t){if(t)if(t.coords.accuracy<300)n.setView({center:new p(t.coords.latitude,t.coords.longitude,t.coords.altitude),zoom:16});else{var o=e(t.coords.latitude,t.coords.longitude,0,t.coords.accuracy),u=(o.latitude-t.coords.latitude)*2,i=n.getHeight(),r=n.getWidth(),f=i>r?i:r;n.setView({bounds:new ct(new p(t.coords.latitude,t.coords.longitude,t.coords.altitude),u,u),padding:f/3})}}function e(n,t,u,f){var a=c,k=a.degreesToRadians(u),y=(1-r)*Math.tan(a.degreesToRadians(n)),it=Math.cos(k),et=Math.sin(k),v=1/Math.sqrt(1+y*y),rt=v*et,ht=rt*rt,tt=1-ht,ut=Math.atan2(y,Math.cos(k)),l=tt*((o*o-i*i)/(i*i)),st=1+l/16384*(4096+l*(-768+l*(320-175*l))),ft=l/1024*(256+l*(-128+l*(74-47*l))),e=f/(i*st),ct=2*Math.PI,s=Math.sin(e),nt=2*ut+e,h=Math.cos(nt),d;while(Math.abs(e-ct)>1e-12){nt=2*ut+e,h=Math.cos(nt),d=h*h,s=Math.sin(e);var wt=Math.cos(e)*(-1+2*d),pt=ft/6*h*(-3+4*s*s)*(-3+4*d),kt=ft*s*(h+ft/4*(wt-pt));ct=e,e=f/(i*st)+kt}h=Math.cos(2*ut+e),s=Math.sin(e);var w=Math.cos(e),b=y*v,ot=b*s-v*w*it,bt=Math.atan2(b*w+v*s*it,(1-r)*Math.sqrt(ht+ot*ot)),yt=Math.atan2(s*et,v*w-b*s*it),g=r/16*tt*(4+r*(4-3*tt)),vt=e+g*s*(h+g*w*(-1+2*h*h)),at=yt-(1-g)*r*rt*vt,lt=(a.degreesToRadians(t)+at+3*Math.PI)%(2*Math.PI)-Math.PI;return new p(a.radiansToDegrees(bt),a.radiansToDegrees(lt))}var u=null,a=128,y=new at(150,0,163,239),v=new at(25,0,163,239),t=0,s=navigator&&navigator.geolocation,f=this,o=tt.earthRadiusInMeters,i=tt.earthMinorAxisRadiusInMeters,r=tt.flatteningOfEllipsoidWGS84;this.getCurrentPosition=function(n){f.removeAccuracyCircle();if(s&&t===0)t=Math.random(),navigator.geolocation.getCurrentPosition(function(i){w(i,n,t)},function(i){h(i,n,t)},n);else if(n&&n.errorCallback){var i=s?4:5;n.errorCallback({internalError:null,errorCode:i})}},this.cancelCurrentRequest=function(){t=0},this.addAccuracyCircle=function(t,i,r,o){var c=null,s,d,l,w,a;if(t&&r&&i&&t instanceof p&&ai(r)&&ai(i)){var h=[],b=t.latitude,k=t.longitude;for(s=0;s<r;s++)d=s/r*360,l=e(b,k,d,i),h.push(l);w=e(b,k,0,i),h.push(w),a=o.polygonOptions||{fillColor:v,strokeColor:y},c=new tr(h,a),o&&o.displayOnMap!=!1&&(f.removeAccuracyCircle(),u=c,n.entities.push(u))}return c},this.removeAccuracyCircle=function(){u&&(n.entities.remove(u),u=null)}},s.GeoLocationProvider=ou),l.DelayMap=nu,nt=new function(){function i(t,r,u){var e,o,s,f;e=t[r];if(e){o=e.length;while(o--)s=e[o],f=n[s],f&&(f[u]=[],i(f,r,u))}}function f(t,u){var f=n[t],v,o,y,a,e,h,c;if(f){v=f.downloadScript,f.downloadScript=!1,i(f,"suppliesCssFor","styleUrls"),i(f,"suppliesJsFor","scriptUrls");if(f.loaded)r(t,u);else{if(u)for(f.queue.push(u),e=0;e<f.scriptUrls.length;e++)for(o in u)typeof u[o]=="string"&&(y=new RegExp(o+"=[^&]+"),f.scriptUrls[e]=f.scriptUrls[e].replace(y,o+"="+u[o]));if(v&&f.loadOverrideCallback(t,u)!==!0){for(s.InternalNamespaceForDelay=l,a=f.scriptUrls,e=0;e<a.length;e++)h=a[e],h&&(f.jsonDownloadCallback?ei.getObjectAsync(h,f.jsonDownloadCallback):ei.downloadScript(h));for(c=f.styleUrls,e=0;e<c.length;e++)c[e]&&ei.downloadStyles(c[e])}}}}function u(n,t){var i=n.length;while(i--)n[i].indexOf("/")==-1&&(n[i]=t+n[i])}function r(n,t){typeof t.callback=="function"?t.callback(n):t.obj&&t.obj[t.name].apply(t.obj,t.args)}var n={};this.register=function(i,r,f,e){var o=f?f:{},s=n[i]={key:i,downloadScript:!0,loaded:!1,queue:[],scriptUrls:(o.extraScripts||[]).concat(r),styleUrls:o.styleUrls?o.styleUrls:[],jsonDownloadCallback:typeof o.jsonDownloadCallback=="function"?o.jsonDownloadCallback:null,loadOverrideCallback:typeof o.loadOverrideCallback=="function"?o.loadOverrideCallback:function(){return!1},suppliesCssFor:o.suppliesCssFor,suppliesJsFor:o.suppliesJsFor};e!==!1&&(u(s.scriptUrls,t.jsPath),u(s.styleUrls,t.cssPath))},this.add=function(n,t,i,r){f(n,t?{obj:t,name:i,args:r}:null)},this.load=function(n,t){PRF.start(n),f(n,t||{})},this.getRegistration=function(t){return n[t]},this.reset=function(t){var i=n[t];i.downloadScript=!0,i.queue=[],i.loaded=!1},this.done=function(t){var f=n[t],e,i,h,u,o;if(f){for(f.loaded=!0,e=f.queue,i=0;i<e.length;i++)h=e[i],r(t,h);u=0;for(o in n)n.hasOwnProperty(o)&&++u;u===0&&delete s.InternalNamespaceForDelay}}},s.loadModule=nt.load,s.registerModule=function(n,t,i){nt.register(n,t,i,!1)},s.moduleLoaded=nt.done,l.Dynamic=nt,s.Globals.disableDirections===!1&&nt.register("Microsoft.Maps.Directions","veapiDirections.js",{styleUrls:["mapDirections.css"]}),s.Globals.disableStreetside===!1&&nt.register("Microsoft.Maps.Streetside","veapistreetside.js",{styleUrls:["mapstreetside.css"]}),s.Globals.disableVenueMaps===!1&&nt.register("Microsoft.Maps.VenueMaps","veapiVenueMaps.js",{styleUrls:["venuemaps.css"]}),s.Globals.disableMicroPOI===!1&&nt.register("Microsoft.Maps.MicroPOI","veapiMicroPOI.js",{styleUrls:["veapiMicroPOI.css"]}),s.Globals.disableAnalytics===!1&&nt.register("Microsoft.Maps.Analytics","veapiAnalytics.js"),s.Globals.disableSearch===!1&&nt.register("Microsoft.Maps.Search","veapiSearch.js",{styleUrls:["search.css"]}),s.Globals.disableTasks===!1&&nt.register("Microsoft.Maps.Tasks","veapiTasks.js"),s.Globals.disableMyPlaces===!1&&nt.register("Microsoft.Maps.MyPlaces","veapiMyPlaces.js");if(s.Globals.jsonTimeStamp){var kr="en-us",dr="US",gr="__domainname__/mapconfiguration.ashx?name=wwa&v=7.0.1wwa&culture={culture}&homeRegion={homeRegion}";u.useXHR&&(kr=Windows.ApplicationModel.Resources.Core.ResourceManager.current.defaultContext.languages[0],dr=Windows.System.UserProfile.GlobalizationPreferences.homeGeographicRegion),ConfigCache.UpdateCulture(kr,dr),gr=gr.replace("{culture}",kr).replace("{homeRegion}",dr),nt.register("Microsoft.Maps.Map",gr,{jsonDownloadCallback:JsonGlobalsWrapper.parse,loadOverrideCallback:JsonGlobalsWrapper.tryCachedGlobals})}pi="Microsoft.Maps.Overlays",wr=["mapdelay.css"],u.isIE6&&wr.push("iev6.css"),nt.register(pi,"veapidelay.js",{styleUrls:wr}),nu.prototype={showOverlays:function(){nt.add(pi,this,"showOverlays",arguments)},showHotRegions:function(){nt.add(pi,this,"showHotRegions",arguments)},showVenueMapsExplorer:function(){nt.add(pi,this,"showVenueMapsExplorer",arguments)},authenticate:function(){nt.add(pi,this,"authenticate",arguments)},getCredentials:function(){nt.add(pi,this,"getCredentials",arguments)}},nt.register("Microsoft.Maps.Traffic","veapiTraffic.js",{styleUrls:["traffic.css"]}),nt.register("Microsoft.Maps.Overlays.Style","veapiOverlayStyleV2.js",{styleUrls:["veapiOverlayStyleV2.css"],version:"v2"}),nt.register("Microsoft.Maps.Themes.BingTheme","veapiBingTheme.js",{styleUrls:["veapiBingTheme.css"],suppliesCssFor:["Microsoft.Maps.Overlays"]}),nt.register("Microsoft.Maps.AdvancedShapes","veapiAdvancedShapes.js"),c={LOGE2:Math.log(2),ILOGE2:1/Math.log(2),degreesPerRadian:180/Math.PI,radiansPerDegree:Math.PI/180,log2:function(n){return Math.log(n)/c.LOGE2},ceilLog2:function(n){return Math.ceil(Math.log(n)*c.ILOGE2)},lerpDouble:function(n,t,i){return n+i*(t-n)},normalizeDegrees:function(n){return(n%360+360)%360},distanceDegrees:function(n,t){var i=c.normalizeDegrees(n-t);return Math.min(i,360-i)},lerpAngle:function(n,t,i){var r=c.normalizeDegrees(n-t);return r>180&&(r=r-360),t+(1-i)*r},degreesToRadians:function(n){return n*c.radiansPerDegree},radiansToDegrees:function(n){return n*c.degreesPerRadian}},l.VectorMath=c,r.prototype={normalize:function(){var t=this.getLength(),n;return t===0?point:(n=1/t,new r(this.x*n,this.y*n,this.z*n))},isZero:function(){return this.x===0&&this.y===0&&this.z===0},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},toPoint:function(){return new i(this.x,this.y)},clone:function(){return new r(this.x,this.y,this.z)},toString:function(){return"[Point3D "+this.x+","+this.y+","+this.z+"]"}},r.add=function(n,t){return new r(n.x+t.x,n.y+t.y,n.z+t.z)},r.subtract=function(n,t){return new r(n.x-t.x,n.y-t.y,n.z-t.z)},r.multiply=function(n,t){return new r(t*n.x,t*n.y,t*n.z)},r.dot=function(n,t){return n.x*t.x+n.y*t.y+n.z*t.z},r.cross=function(n,t){return new r(n.y*t.z-n.z*t.y,n.z*t.x-n.x*t.z,n.x*t.y-n.y*t.x)},r.distanceSquared=function(n,t){var u=n.x-t.x,r=n.y-t.y,i=n.z-t.z;return u*u+r*r+i*i},r.lerp=function(n,t,i){return new r(n.x+(t.x-n.x)*i,n.y+(t.y-n.y)*i,n.z+(t.z-n.z)*i)},r.areEqual=function(n,t){return n&&t&&n.x===t.x&&n.y===t.y&&n.z===t.z},r.areAlmostEqual=function(n,t){return n&&t&&Math.abs(n.x-t.x)<bt&&Math.abs(n.y-t.y)<bt&&Math.abs(n.z-t.z)<bt},l.Point3D=r,lt.prototype={clone:function(){return new lt(this.width,this.height)},toString:function(){return"[Size "+this.width+","+this.height+"]"}},lt.clone=function(n){return new lt(n.width,n.height)},lt.areEqual=function(n,t){return n&&t&&n.width===t.width&&n.height===t.height},l.Size=lt,pt.prototype={getRight:function(){return this.x+this.width},getBottom:function(){return this.y+this.height},getCenter:function(){return new i(this.x+this.width/2,this.y+this.height/2)},contains:function(n){return n.x>=this.x&&n.y>=this.y&&n.x<=this.getRight()&&n.y<=this.getBottom()},clone:function(){return new pt(this.x,this.y,this.width,this.height)},toString:function(){return"[Rect "+this.x+","+this.y+" "+this.width+","+this.height+"]"}},pt.union=function(){var u=ir(arguments[0])?arguments[0]:arguments,t=u[0],r=t.x,i=t.y,e=t.x+(t.width?t.width:0),f=t.y+(t.height?t.height:0),o=u.length,n;while(o--)n=u[o],r=Math.min(r,n.x),i=Math.min(i,n.y),e=Math.max(e,n.x+(n.width?n.width:0)),f=Math.max(f,n.y+(n.height?n.height:0));return new pt(r,i,e-r,f-i)},pt.intersect=function(n,t){return!(n.getRight()<t.x||t.getRight()<n.x||n.getBottom()<t.y||t.getBottom()<n.y)},pt.areEqual=function(n,t){return},l.Rect=pt,yt.prototype={transform:function(n){return new i(n.x*this.m11+n.y*this.m21+this.offsetX,n.x*this.m12+n.y*this.m22+this.offsetY)},invert:function(){var n=this.m11*this.m22-this.m12*this.m21;if(n===0)throw"matrix cannot be inverted";return new yt(this.m22/n,-1*this.m12/n,-1*this.m21/n,this.m11/n,(this.offsetY*this.m21-this.offsetX*this.m22)/n,(this.offsetX*this.m12-this.offsetY*this.m11)/n)},clone:function(){return new yt(this.m11,this.m12,this.m21,this.m22,this.offsetX,this.offsetY)},toString:function(){return"[Matrix "+this.m11+", "+this.m12+", "+this.m21+", "+this.m22+", "+this.offsetX+", "+this.offsetY+"]"}},yt.multiply=function(n,t){return new yt(n.m11*t.m11+n.m12*t.m21,n.m11*t.m12+n.m12*t.m22,n.m21*t.m11+n.m22*t.m21,n.m21*t.m12+n.m22*t.m22,n.offsetX*t.m11+n.offsetY*t.m21+t.offsetX,n.offsetX*t.m12+n.offsetY*t.m22+t.offsetY)},yt.unitToPoints=function(n,t,i){return new yt(t.x-n.x,t.y-n.y,i.x-n.x,i.y-n.y,n.x,n.y)},yt.conversion=function(n,t,i,r,u,f){var o=yt.unitToPoints(n,t,i).invert(),e=yt.unitToPoints(r,u,f);return yt.multiply(o,e)},l.Matrix=yt,e.prototype={multiplyBy:function(n){var l=this.m11,a=this.m12,h=this.m13,c=this.m14,p=this.m21,w=this.m22,v=this.m23,y=this.m24,r=this.m31,u=this.m32,t=this.m33,i=this.m34,o=this.offsetX,s=this.offsetY,f=this.offsetZ,e=this.m44;this.m11=l*n.m11+a*n.m21+h*n.m31+c*n.offsetX,this.m12=l*n.m12+a*n.m22+h*n.m32+c*n.offsetY,this.m13=l*n.m13+a*n.m23+h*n.m33+c*n.offsetZ,this.m14=l*n.m14+a*n.m24+h*n.m34+c*n.m44,this.m21=p*n.m11+w*n.m21+v*n.m31+y*n.offsetX,this.m22=p*n.m12+w*n.m22+v*n.m32+y*n.offsetY,this.m23=p*n.m13+w*n.m23+v*n.m33+y*n.offsetZ,this.m24=p*n.m14+w*n.m24+v*n.m34+y*n.m44,this.m31=r*n.m11+u*n.m21+t*n.m31+i*n.offsetX,this.m32=r*n.m12+u*n.m22+t*n.m32+i*n.offsetY,this.m33=r*n.m13+u*n.m23+t*n.m33+i*n.offsetZ,this.m34=r*n.m14+u*n.m24+t*n.m34+i*n.m44,this.offsetX=o*n.m11+s*n.m21+f*n.m31+e*n.offsetX,this.offsetY=o*n.m12+s*n.m22+f*n.m32+e*n.offsetY,this.offsetZ=o*n.m13+s*n.m23+f*n.m33+e*n.offsetZ,this.m44=o*n.m14+s*n.m24+f*n.m34+e*n.m44},transform:function(n,t){var u=n.x*this.m11+n.y*this.m21+this.offsetX,e=n.x*this.m12+n.y*this.m22+this.offsetY,f=n.x*this.m13+n.y*this.m23+this.offsetZ,i;return n.z&&(u+=n.z*this.m31,e+=n.z*this.m32,f+=n.z*this.m33),(this.m14!==0||this.m24!==0||this.m34!==0||this.m44!==1)&&(i=n.x*this.m14+n.y*this.m24+(n.z?n.z:0)*this.m34+this.m44,t&&(i=Math.max(t,i)),u/=i,e/=i,f/=i),new r(u,e,f)},invert:function(){var c=this.m11,p=this.m12,w=this.m13,v=this.m14,h=this.m21,a=this.m22,b=this.m23,y=this.m24,l=this.m31,g=this.m32,d=this.m33,k=this.m34,s=this.offsetX,it=this.offsetY,tt=this.offsetZ,nt=this.m44,r=w*y-b*v,i=w*k-d*v,t=w*nt-tt*v,o=b*k-d*y,f=b*nt-tt*y,u=d*nt-tt*k,et=a*i-g*r-p*o,ut=p*f-a*t+it*r,ot=g*t-it*i-p*u,ft=a*u-g*f+it*o,rt=s*et+l*ut+h*ot+c*ft;if(rt===0||!isFinite(rt))throw"InvalidOperation: Matrix3D.invert";var wt=c*o-h*i+l*r,lt=h*t-s*r-c*f,pt=c*u-l*t+s*i,yt=l*f-s*o-h*u;r=c*a-h*p,i=c*g-l*p,t=c*it-s*p,o=h*g-l*a,f=h*it-s*a,u=l*it-s*g;var dt=w*o-b*i+d*r,kt=b*t-tt*r-w*f,bt=w*u-d*t+tt*i,ct=d*f-tt*o-b*u,ht=y*i-k*r-v*o,st=v*f-y*t+nt*r,vt=k*t-nt*i-v*u,at=y*u-k*f+nt*o,n=1/rt;return new e(ft*n,ot*n,ut*n,et*n,yt*n,pt*n,lt*n,wt*n,at*n,vt*n,st*n,ht*n,ct*n,bt*n,kt*n,dt*n)},projectOnPlane:function(n){var t=this,o=n.a*t.m11+n.b*t.m12+n.c*t.m13-n.d*t.m14,f=n.a*t.m21+n.b*t.m22+n.c*t.m23-n.d*t.m24,r=n.a*t.m31+n.b*t.m32+n.c*t.m33-n.d*t.m34,s=n.a*t.offsetX+n.b*t.offsetY+n.c*t.offsetZ-n.d*t.m44,i,u;if(r===0)throw"InvalidOperation: Matrix3D.projectOnPlane";return i=-1/r,u=new e(1,0,o*i,0,0,1,f*i,0,0,0,1,0,0,0,s*i,1),e.multiply(u,this)},clone:function(){return new e(this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.offsetX,this.offsetY,this.offsetZ,this.m44)},toString:function(){return"[Matrix3D "+this.m11+","+this.m12+","+this.m13+","+this.m14+", "+this.m21+","+this.m22+","+this.m23+","+this.m24+", "+this.m31+","+this.m32+","+this.m33+","+this.m34+", "+this.offsetX+","+this.offsetY+","+this.offsetZ+","+this.m44+"]"}},e.multiply=function(){for(var u=arguments.length,r=arguments[0].clone(),i=1;i<u;i++)r.multiplyBy(arguments[i]);return r},e.identity=function(){return new e(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},e.translation=function(n){var t=arguments.length==3;return new e(1,0,0,0,0,1,0,0,0,0,1,0,t?arguments[0]:n.x,t?arguments[1]:n.y,t?arguments[2]:n.z,1)},e.scaling=function(n,t,i){var r=new e(n,0,0,0,0,n,0,0,0,0,n,0,0,0,0,1);return arguments.length==3&&(r.m22=t,r.m33=i),r},e.rotationX=function(n){var r=n*c.radiansPerDegree,i=Math.sin(r),t=Math.cos(r);return new e(1,0,0,0,0,t,i,0,0,-i,t,0,0,0,0,1)},e.rotationY=function(n){var r=n*c.radiansPerDegree,i=Math.sin(r),t=Math.cos(r);return new e(t,0,-i,0,0,1,0,0,i,0,t,0,0,0,0,1)},e.rotationZ=function(n){var r=n*c.radiansPerDegree,i=Math.sin(r),t=Math.cos(r);return new e(t,i,0,0,-i,t,0,0,0,0,1,0,0,0,0,1)},l.Matrix3D=e,ri.prototype={intersectWithLine:function(n,t){var i=r.subtract(t,n),f=this.d-this.a*n.x-this.b*n.y-this.c*n.z,u=this.a*i.x+this.b*i.y+this.c*i.z;if(u===0)throw"InvalidOperation: Plane3D.intersectWithLine";return r.add(n,r.multiply(i,f/u))},clone:function(){return new ri(this.a,this.b,this.c,this.d)},toString:function(){return"[Plane3D]"}},ri.fromPoints=function(n,t,i){var f=r.subtract(i,t),e=r.subtract(t,n),u=r.cross(f,e);return u=u.normalize(),ri.fromNormal(n,u)},ri.fromNormal=function(n,t){return new ri(t.x,t.y,t.z,r.dot(t,n))},ri.areEqual=function(n,t){return n.a===t.a&&n.b===t.b&&n.c===t.c&&n.d===t.d},l.Plane3D=ri,gt.prototype={dot:function(n){return this.x*n.x+this.y*n.y},perp:function(){return new gt(this.y,-this.x)},normalize:function(){var t,n;return t=this.length(),t<MathHelper.zeroTolerance?new gt(0,0):(n=1/t,new gt(this.x*n,this.y*n))},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSquared:function(){return this.x*this.x+this.y*this.y},add:function(n){return new gt(this.x+n.x,this.y+n.y)},subtract:function(n){return new gt(this.x-n.x,this.y-n.y)},multiplyScalar:function(n){return new gt(this.x*n,this.y*n)},equals:function(n){return this.x===n.x&&this.y===n.y},toString:function(){return"["+this.x+", "+this.y+"]"}},l.Vector2=gt,tt={earthRadiusInMeters:6378137,earthCircumferenceInMeters:12756274*Math.PI,northUpHeading:0,eastUpHeading:90,southUpHeading:180,westUpHeading:270,enhancedBirdseyePitch:-c.degreesPerRadian*Math.asin(180/256),earthMinorAxisRadiusInMeters:6356752.3142,flatteningOfEllipsoidWGS84:1/298.2572235631,snapToCardinalHeading:function(n){var t=Math.round(n/90);return t=(t%4+4)%4,t*90},locationRectToMercatorZoom:function(n,i){var f=i.width/360,u=Math.abs(a.latitudeToY(i.getNorth())-a.latitudeToY(i.getSouth())),r=Math.min(n.width/(t.zoomOriginWidth*f),n.height/(t.zoomOriginWidth*u));return c.log2(r)},getMercatorCenter:function(n){var t=n.center;return new p(a.yToLatitude((a.latitudeToY(n.getNorth())+a.latitudeToY(n.getSouth()))/2),t.longitude,t.altitude,t.altitudeReference)},getMercatorFootprint:function(n,t){var f=t.width/2,u=t.height/2,r=[new i(-f,-u),new i(f,-u),new i(f,u),new i(-f,u)],h=n.getViewportToWorld(),s=n.getCrs(),e,o=r.length;while(o--)e=h.transform(r[o]),r[o]=s===a?e:a.fromLocation(s.toLocation(e));return r}},l.MapMath=tt,a={latitudeLimit:85.051128,invFourPi:1/(4*Math.PI),unitsPerMeterAtEquator:1/tt.earthCircumferenceInMeters,toLocation:function(n){var t=a.yToLatitude(n.y);return new p(t,(n.x-.5)*360,n.z?a.unitsToMetersAtLatitude(t,n.z):0,dt.ellipsoid)},fromLocation:function(n){return new r(n.longitude/360+.5,a.latitudeToY(n.latitude),a.metersToUnitsAtLatitude(n.latitude,n.altitude))},wrap:function(n,t){var i=n.x,u=t?t.x:.5;return new r(i<u-.5||i>u+.5?i-Math.floor(i-u+.5):i,n.y,n.z)},getUpVector:function(){return new r(0,0,1)},getNadirMatrix:function(n){return new e(1,0,0,0,0,1,0,0,0,0,-1,0,-n.x,-n.y,n.z,1)},unitsToMeters:function(n,t){var i=a.yToLatitude(n.y);return a.unitsToMetersAtLatitude(i,t)},metersToUnits:function(n,t){var i=a.yToLatitude(n.y);return a.metersToUnitsAtLatitude(i,t)},changeAltitude:function(n,t){var u=a.yToLatitude(n.y),i=a.metersToUnitsAtLatitude(u,t);return new r(n.x,n.y,i)},unitsToMetersAtLatitude:function(n,t){return t===0?0:t*Math.cos(n*c.radiansPerDegree)/a.unitsPerMeterAtEquator},metersToUnitsAtLatitude:function(n,t){return t===0?0:t*a.unitsPerMeterAtEquator/Math.cos(n*c.radiansPerDegree)},yToLatitude:function(n){return 90-2*Math.atan(Math.exp((n*2-1)*Math.PI))*c.degreesPerRadian},latitudeToY:function(n){if(n>=a.latitudeLimit)return 0;if(n<=-a.latitudeLimit)return 1;var t=Math.sin(n*c.radiansPerDegree);return.5-Math.log((1+t)/(1-t))*this.invFourPi}},l.MercatorCube=a,fr=new function(){var t=1/298.257222101,i=t*(2-t),f=1/(1-i),n=tt.earthRadiusInMeters,u=new r(0,0,-n);this.toLocation=function(r){var w=r.x,y=r.y,o=r.z,b,d,e,v,a,s,l=Math.sqrt(w*w+y*y),f=o,u,h,k;d=Math.atan2(y,w),u=l*(1-t),h=1/Math.sqrt(f*f+u*u),b=Math.atan2(f,u),v=f*h,a=u*h,s=n,e=l>1?l/a-s:o>0?o-n*(1-t):-o-n*(1-t),k=3;while(k--)u=l*(1-i*s/(s+e)),h=1/Math.sqrt(f*f+u*u),b=Math.atan2(f,u),v=f*h,a=u*h,s=n/Math.sqrt(1-i*v*v),e=l>1?l/a-s:o>0?o-n*(1-t):-o-n*(1-t);return new p(b*c.degreesPerRadian,d*c.degreesPerRadian,e,dt.ellipsoid)},this.fromLocation=function(t){var o=t.latitude*c.radiansPerDegree,h=t.longitude*c.radiansPerDegree,e=t.altitude,u=Math.sin(o),s=Math.cos(o),l=Math.sin(h),a=Math.cos(h),f=n/Math.sqrt(1-i*u*u);return new r((f+e)*s*a,(f+e)*s*l,(f*(1-i)+e)*u)},this.wrap=function(){return wrap.clone()},this.getUpVector=function(n){return new r(n.x,n.y,n.z*f).normalize()},this.getNadirMatrix=function(n){var t,f=this.getUpVector(n),o=r.multiply(f,-1),s=r.cross(f,r.subtract(u,n)),i;return t=s.isZero()?new r(1,0,0):r.cross(s,f).normalize(),i=r.cross(f,t),e.multiply(e.translation(-n.x,-n.y,-n.z),new e(i.x,t.x,o.x,0,i.y,t.y,o.y,0,i.z,t.z,o.z,0,0,0,0,1))},this.unitsToMeters=function(n,t){return t},this.metersToUnits=function(n,t){return t},this.changeAltitude=function(n,t){var i=self.toLocation(n);return i.altitude=t,self.fromLocation(i)}},rt.prototype={getParent:function(){return new rt(this.levelOfDetail-1,Math.floor(this.x/2),Math.floor(this.y/2))},clone:function(){return new rt(this.levelOfDetail,this.x,this.y)},getSibling:function(n,t){var r=1<<this.levelOfDetail,u=this.x+n,i;return u<0?u+=r:u<r||(u-=r),i=this.y+t,i<0?i=0:i<r||(i=r-1),new rt(this.levelOfDetail,u,i)},toString:function(){return"[TileId "+this.levelOfDetail+" "+this.x+","+this.y+"]"}},rt.areEqual=function(n,t){return n&&t&&n.levelOfDetail===t.levelOfDetail&&n.x===t.x&&n.y===t.y},l.TileId=rt,f.prototype={convertCoordinateReferenceSystem:function(n){if(n!==this.getCrs()){var t=n.fromLocation(this.getCrs().toLocation(this.getLookAt()));return new f(n,t,n.metersToUnits(t,this.getCrs().unitsToMeters(this.getLookAt(),this.getWidth())),this.getHeading(),this.getPitch(),this.getRoll(),this.getDistanceInverse()<bt?0:1/n.metersToUnits(t,this.getCrs().unitsToMeters(this.getLookAt(),1/this.getDistanceInverse())),h,h,this.getZoomOriginWidth())}return this.clone()},clone:function(){return new f(this.getCrs(),this.getLookAt().clone(),this.getWidth(),this.getHeading(),this.getPitch(),this.getRoll(),this.getDistanceInverse(),this.getZoomDelta(),this.getPerspectiveOrigin().clone(),this.getZoomOriginWidth())},toString:function(){return"[MapCamera]"}},f.smallWidthRatioDiff=.1,f.smallAngle=1,f.smallPixelDistance=2,f.simpleGround=new ri(0,0,1,0),f.simpleWorldToFrustumNoZ=e.identity(),f.fromDirectionVector=function(n,t,i,u,o,s){var y,a;var p=n.getNadirMatrix(t),l=p.transform(r.add(t,u)).normalize(),h=0;(l.x!==0||l.y!==0)&&(directionXY=new r(l.x,l.y,0).normalize(),h=Math.acos(r.dot(directionXY,new r(0,-1,0)))*c.degreesPerRadian,directionXY.x<0&&(h=360-h));var w=(Math.PI/2-Math.acos(r.dot(l,new r(0,0,-1))))*c.degreesPerRadian,a=0,b=e.multiply(p,e.rotationZ(-h),e.rotationX(-(w+90))),v=b.transform(r.add(t,o));return(v.x!=0||v.y!=0)&&(y=new r(v.x,v.y,0).normalize(),a=Math.acos(r.dot(y,new r(0,-1,0)))*c.degreesPerRadian,y.x<0&&(a=360-a)),new f(n,t,i,h,w,a,s)},f.mercatorZoomToWidth=function(n,t,i){var r=1/Math.pow(2,n);return t===a?r:t.metersToUnits(i,a.unitsToMeters(a.fromLocation(t.toLocation(i)),r))},f.widthToMercatorZoom=function(n,t,i){var r=t===a?n:a.metersToUnits(a.fromLocation(t.ToLocation(i)),t.unitsToMeters(i,n));return c.log2(1/r)},f.snapSmallDifferences=function(n,i){n.getCrs()!==i.getCrs()&&(n=i.convertCoordinateReferenceSystem(i.getCrs()));var s=Math.max(n.getWidth(),i.getWidth())/t.zoomOriginWidth,e=s*f.smallPixelDistance,u=e*e,o=new f(n.getCrs(),r.distanceSquared(i.getLookAt(),n.getLookAt())>u?n.getLookAt():i.getLookAt(),Math.abs(i.getWidth()/n.getWidth()-1)>f.smallWidthRatioDiff?n.getWidth():i.getWidth(),Math.abs(n.getHeading()-i.getHeading())>f.smallAngle?n.getHeading():i.getHeading(),Math.abs(n.getPitch()-i.getPitch())>f.smallAngle?n.getPitch():i.getPitch(),Math.abs(n.getRoll()-i.getRoll())>f.smallAngle?n.getRoll():i.getRoll(),Math.abs(n.getDistanceInverse()-i.getDistanceInverse())>bt?n.getDistanceInverse():i.getDistanceInverse(),Math.abs(n.getZoomDelta()-i.getZoomDelta())>f.smallWidthRatioDiff?n.getZoomDelta():i.getZoomDelta(),r.distanceSquared(i.getPerspectiveOrigin(),n.getPerspectiveOrigin())>u?n.getPerspectiveOrigin():i.getPerspectiveOrigin(),n.getZoomOriginWidth());return f.areEqual(o,n)?n:o},f.lerp=function(n,t,i){var u=i,e=t.getWidth()/n.getWidth();return Math.abs(e-1)>f.smallWidthRatioDiff&&(u=(Math.pow(e,i)-1)/(e-1)),new f(t.getCrs(),r.lerp(n.getLookAt(),t.getLookAt(),u),c.lerpDouble(n.getWidth(),t.getWidth(),u),c.lerpAngle(n.getHeading(),t.getHeading(),i),c.lerpAngle(n.getPitch(),t.getPitch(),i),c.lerpAngle(n.getRoll(),t.getRoll(),i),c.lerpDouble(n.getDistanceInverse(),t.getDistanceInverse(),i),c.lerpDouble(n.getZoomDelta(),t.getZoomDelta(),i),r.lerp(n.getPerspectiveOrigin(),t.getPerspectiveOrigin(),u),n.getZoomOriginWidth())},f.areAligned=function(n,t){return n&&t&&n.getWidth()===t.getWidth()&&n.getHeading()===t.getHeading()&&n.getPitch()===t.getPitch()&&n.getRoll()===t.getRoll()&&n.getDistanceInverse()===t.getDistanceInverse()},f.areEqual=function(n,t){return n&&t&&(n===t||r.areEqual(n.getLookAt(),t.getLookAt())&&n.getWidth()===t.getWidth()&&n.getHeading()===t.getHeading()&&n.getPitch()===t.getPitch()&&n.getRoll()===t.getRoll()&&n.getDistanceInverse()===t.getDistanceInverse()&&n.getZoomDelta()===t.getZoomDelta()&&r.areEqual(n.getPerspectiveOrigin(),t.getPerspectiveOrigin()))},l.MapCamera=f,ut={mercator:new f(a,new r(.5,.5,0),1),enhancedBirdseyeNorthUp:new f(a,new r(.5,.5,0),1,tt.northUpHeading,tt.enhancedBirdseyePitch),enhancedBirdseyeEastUp:new f(a,new r(.5,.5,0),1,tt.eastUpHeading,tt.enhancedBirdseyePitch),enhancedBirdseyeSouthUp:new f(a,new r(.5,.5,0),1,tt.southUpHeading,tt.enhancedBirdseyePitch),enhancedBirdseyeWestUp:new f(a,new r(.5,.5,0),1,tt.westUpHeading,tt.enhancedBirdseyePitch)},l.StandardMapCameras=ut,l.MemoryCache=yi,d={tileIdToCacheKey:function(n){return n.levelOfDetail+"~"+n.x+"~"+n.y},latLonToMercatorXY:function(n,t){var r=t/360+.5;return r-=Math.floor(r),new i(r,a.latitudeToY(n))},mercatorXYToTileId:function(n,t){var i=1<<t;return new rt(t,Math.floor(n.x*i),Math.floor(n.y*i))},mercatorXYToCacheKey:function(n,t){return d.tileIdToCacheKey(d.mercatorXYToTileId(n,t))},latLonToTileId:function(n,t,i){var r=d.latLonToMercatorXY(n,t);return d.mercatorXYToTileId(r,i)},latLonToCacheKey:function(n,t,i){return d.tileIdToCacheKey(d.latLonToTileId(n,t,i))},tileIdToMercatorXY:function(n){var t=1<<n.levelOfDetail;return new i((n.x+.5)/t,(n.y+.5)/t)},tileIdToLocation:function(n){var t=d.tileIdToMercatorXY(n);return a.toLocation(t)},normalizeMercatorBounds:function(n){n.width<1?n.x-=Math.floor(n.x):(n.x=0,n.width=1);var t=Math.min(n.getBottom(),1);n.y=Math.max(n.y,0),n.height=t-n.y}},l.SpatialCache=d,ft=new function(){function o(){var o,u,y;if(f.length&&a<1&&k){var c=f.shift(),t=c.topLeft,i=c.bottomRight,l=!0,g=t.x,b=i.x,tt=t.y,nt=i.y,r=new rt(t.levelOfDetail,0,0);for(o=tt;o<=nt;o++){for(u=g;u<=b;u++){r.x=u,r.y=o,r=hi.wrapX(r);if(e.get(d.tileIdToCacheKey(r))===h){l=!1;break}}if(!l)break}if(l)n.invoke(c.requestHandle,"downloaded",{cacheHit:!0});else{y=1<<t.levelOfDetail,t.x-=s,t.y=Math.max(0,t.y-s),i.x+=s,i.y=Math.min(y-1,i.y+s);var p=d.tileIdToLocation(t),v=d.tileIdToLocation(i),w=k.replace("{north}",p.latitude.toFixed(6)).replace("{west}",p.longitude.toFixed(6)).replace("{south}",v.latitude.toFixed(6)).replace("{east}",v.longitude.toFixed(6)).replace("{cols}",i.x-t.x+1).replace("{rows}",i.y-t.y+1);a++,ei.getObjectAsync(w,ot,{topLeft:t,bottomRight:i,requestHandle:c.requestHandle})}}}function ot(t,i){var s,f;if(i.success){var h=i.userData.topLeft,p=i.userData.bottomRight,k=h.x,b=p.x,w=h.y,y=p.y,c=t.alt;if(c&&c.length===(y-w+1)*(b-k+1)){var u=new rt(h.levelOfDetail,0,0),r,nt,g=0,v=0;for(s=w;s<=y;s++)for(f=k;f<=b;f++){v+=c[g++],u.x=f,u.y=s,u=hi.wrapX(u),r=u;while(r.levelOfDetail>=h.levelOfDetail-ut){if(e.insert(d.tileIdToCacheKey(r),v))break;r=r.getParent()}}l++,n.invoke(i.userData.requestHandle,"downloaded",{cacheHit:!1})}}a--,o()}function it(n){return Math.floor(Math.min(n+w,ft))}var u=this,k,st=64,w=c.log2(t.zoomOriginWidth/st),v=10+w,ft=20+w,ut=6,e=new yi(5e3),f=[],a=0,l=0,s=4,et=3,ht=new r(0,0,1),g=y+"ellipsoid",nt;this.authenticate=function(n){nt||(nt=!0,n(function(n){n&&(k=t.elevationServiceUrl.replace("{credentials}",n),o())}))},this.getAltitudeAtLatLon=function(n,t){return u.getAltitudeAtMercatorXY(d.latLonToMercatorXY(n,t))},this.getAltitudeForTile=function(n){return e.get(d.tileIdToCacheKey(n))},this.getApproximateAltitudeForTile=function(n){var t=e.get(d.tileIdToCacheKey(n)),r,i;if(t!==h)return t;for(r=-1;r<2;r++)for(i=-1;i<2;i++){t=e.get(d.tileIdToCacheKey(n.getSibling(r,i)),!1);if(t!==h)return t}},this.getAltitudeAtMercatorXY=function(n){var e=d.mercatorXYToTileId(n,ft),f,t;while(e.levelOfDetail>=1){f=u.getApproximateAltitudeForTile(e);if(f!==h){var o=e.levelOfDetail,k=1<<o,r=n.x*k-.5,v=n.y*k-.5,a=Math.floor(r),l=Math.ceil(r),y=Math.floor(v),w=Math.ceil(v),b=u.getAltitudeForTile(new rt(o,a,y)),c=u.getAltitudeForTile(new rt(o,l,y)),p=u.getAltitudeForTile(new rt(o,a,w)),s=u.getAltitudeForTile(new rt(o,l,w)),i;return b!==h?i=c!==h?b*(l-r)+c*(r-a):b:c!==h&&(i=c),p!==h?t=s!==h?p*(l-r)+s*(r-a):p:s!==h&&(t=s),i!==h?f=t!==h?i*(w-v)+t*(v-y):i:t!==h&&(f=t),f}e=e.getParent()}return 0},this.rayToGround=function(n,t,i){if(Math.abs(t.x-i.x)<=bt&&Math.abs(t.y-i.y)<=bt)return n.changeAltitude(t,u.getAltitudeAtMercatorXY(t));var o,r,e,f=t,s=et;while(s--){r=u.getAltitudeAtMercatorXY(f);if(Math.abs(o-r)<1)break;o=r,e=ri.fromNormal(n.changeAltitude(f,r),ht),f=e.intersectWithLine(t,i)}return f},this.toEllipsoid=function(n,t){var i,f,r;if(n.altitudeReference===dt.ellipsoid)return n;if(t)return new p(n.latitude,n.longitude,0,dt.ellipsoid);return i=n[g],i&&i.latitude===n.latitude&&i.longitude===n.longitude&&i.forAltitude===n.altitude&&i.forAltitudeReference===n.altitudeReference&&i.forGeneration===l?i:(f=u.getAltitudeAtLatLon(n.latitude,n.longitude),r=n.altitudeReference===dt.ground?n.altitude+f:f,i=new p(n.latitude,n.longitude,r,dt.ellipsoid),i.forAltitude=n.altitude,i.forAltitudeReference=n.altitudeReference,i.forGeneration=l,n[g]=i,i)},this.isElevationAvailableAtLatLon=function(n,t,i){var e=it(i),r,f;if(e<v)return!0;r=d.latLonToTileId(n,t,e),f=ut;while(f--){if(u.getApproximateAltitudeForTile(r)!==h)return!0;r=r.getParent()}return!1},this.adjustCameraElevation=function(n){var i=n.getLookAt(),t=u.rayToGround(n.getCrs(),i,n.getViewportToWorld().transform(new r(0,0,1)));return r.areAlmostEqual(i,t)?n:n.getAlignedCamera(0,t)},this.downloadElevationData=function(n,t){var u,r;u=it(n.getMercatorZoom());if(u>=v){r=pt.union(tt.getMercatorFootprint(n,t)),d.normalizeMercatorBounds(r);var s=d.mercatorXYToTileId(r,u),h=d.mercatorXYToTileId(new i(r.getRight(),r.getBottom()),u),e={};return f.push({topLeft:s,bottomRight:h,requestHandle:e}),b.dispatch(o),e}},this.downloadElevationDataForLocationRect=function(n,t){t=t||19;if(t>=v){var h=n.getNorth(),s=n.getWest(),e=n.getSouth(),c=n.getEast(),r=d.latLonToTileId(h,s,t),u=d.latLonToTileId(e,c,t),i={};return f.push({topLeft:r,bottomRight:u,requestHandle:i}),b.dispatch(o),i}},this.cancelDownload=function(n){if(n){var t=f.length;while(t--)f[t].requestHandle===n&&f.splice(t,1)}}},l.ElevationService=ft,ht.nativeMercatorCamera=ut.mercator.getAlignedCamera(t.minMercatorZoom),ht.createMercatorScene=function(n,i,r,u){var f=null;return n&&(f=kt.createQuadKeyTilePyramid(t.defaultTileSize,t.defaultTileSize,n,et.horizontal,u),f.projectingCamera=ut.mercator),new ht(ht.nativeMercatorCamera,f,t.maxMercatorZoom-t.minMercatorZoom,i,r)},l.CompositeModeScene=ht,vt.entityRenderers=[],vt.registerEntityRenderer=function(t,i){var r={getRenderer:t,priority:i?i.priority:null};vt.entityRenderers.push(r),vt.entityRenderers._key="k"+li.getNext(),i&&i.priority!==null&&vt.entityRenderers.sort(function(n,t){var r=0,i=n.priority,u=t.priority;return(i!==null||u!==null)&&(r=i!==null&&u!==null?i-u:i!==null?-1:1),r}),n.invoke(vt,"newEntityRenderer")},vt.getEntityRenderer=function(n,t){var f=vt.entityRenderers._key,i=t._cmRd,u,r;if(t._cmRdk!==f){for(i=null,u=vt.entityRenderers,r=0;r<u.length&&!i;r++)i=u[r].getRenderer(n,t);t._cmRd=i,t._cmRdk=f}return i},l.CompositeMode=vt,w=new function(){function r(){var e=k(),r=t.length,u,f,s;while(r--){var o=t[r],c=v.Style.camelize(o),l=v.Style.get_camelized_style_name(o,e);e.style[l]!==h&&(i.Properties[c]=l,i.Attributes[c]=v.Style.get_css_style_name(o,e))}for(r=0;r<n.length;r++){u=n[r];for(f in u)if(f in e.style)for(s in u[f])i.Events[s]=u[f][s]}}var i=this,t,n;this.Properties={},this.Attributes={},this.Events={},t=["transform","transform-origin","transition","transition-delay","transition-property","transition-duration"],n=[{webkitTransition:{transitionEnd:"webkitTransitionEnd"}},{MozTransition:{transitionEnd:"MozTransitionEnd"}}],r()},o={none:0,allowed:1,readyForTarget:2,started:3,pendingCompletion:4},ot.Default=new ot(.25,.1,.25,1),ot.Linear=new ot(0,0,1,1),ot.EaseIn=new ot(.42,0,1,1),ot.EaseOut=new ot(0,0,.58,1),ot.EaseInOut=new ot(.42,0,.58,1),ot.EaseOutIn=new ot(0,.42,1,.58),ot.Flick=new ot(.2,.5,.35,1),ti=function(){function i(n){var i;if(!n[t]){newKey=+new Date;while(newKey in r)newKey++;n[t]=newKey}return i=r[n[t]]||[],r[n[t]]=i,i}function f(n,t,r){var o=i(n),f=!1,e=o.length;while(e--&&!f)f=o[e]===t,f&&r&&(o.splice(e,1),u(n));return f}function u(n){var e=i(n),s=e.length,h=new Date,r="",u="",o=!0,t,f;while(s--)t=e[s],f=h-t.getStartTime(),o||(r+=", ",u+=" "),r+=t.getProperty()+" "+t.getDuration()+"s "+t.getTimingFunction().cssText,u+="-"+f+"ms",o=!1;n.style[w.Properties.transition]=r,n.style[w.Properties.transitionDelay]=u}function e(t,r,e){function y(){var n=t&&r&&e;!n}var s=this,c=t,p=e,a=r,l=new Date(0),o=0,h=null;this.getStartTime=function(){return l},this.getProperty=function(){return c},this.getTimingFunction=function(){return p},this.getDuration=function(){return a},this.setDuration=function(n){o==0&&(a=n)},this.applyAnimation=function(n){if(!n||f(n,s))return;i(n).push(s),o==0&&(l=new Date),o++,v(n).add_event(w.Events.transitionEnd,function(n){n.propertyName==c&&(v(this).remove_event(w.Events.transitionEnd,arguments.callee,!1),s.removeAnimation(this))},!1),u(n)},this.removeAnimation=function(t){t&&t!=h&&f(t,s,!0)&&(o--,h=t,n.invoke(t,"animationsequenceprogress",new pu(s,t,o>0,i(t).length>0)),h=null)},y()}var r={},t=y+"CssAnimationSequenceId";return e}(),ti.prototype={getElapsedTimeAsPercentage:function(){return(new Date-this.getStartTime())/(this.getDuration()*1e3)},getProgress:function(n){n==null&&(n=this.getElapsedTimeAsPercentage());var t=1/(400*this.getDuration());return this.getTimingFunction().getProgress(n,t)},duplicate:function(n,t,i){return new ti(n?n:this.getProperty(),t?t:this.getDuration(),i?i:this.getTimingFunction())}},ti.Transformer=u.allowCssAnimations&&new ti(w.Attributes.transform,.3,ot.EaseInOut),ti.Flicker=u.allowCssAnimations&&ti.Transformer.duplicate(null,null,ot.Flick),ti.TileFader=u.allowCssAnimations&&new ti("opacity",.3,ot.Linear);var pr=function(){function t(){function u(n){if(!r||!r.length)return;var i=r.length,t=!1;while(!t&&i--)t=n(r[i])}function c(n){return n?n[f]:null}function l(n){n&&n.animationSequence&&!e&&u(function(t){if(t===n.animationSequence)return o(c(n.node),t),!0})}function o(i,r){i&&r&&t[i]&&t[i].remaining&&(e=!0,r.removeAnimation(t[i].node),e=!1,t[i].remaining--,t[i].remaining||(n.removeHandler(t[i].handler),t[i].node=null,t[i].handler=null,delete t[i],--s==0&&n.invoke(h,"animationscomplete",!1)))}var h=this,f=y+"CssAnimationGroupId"+ ++i,a=0,r=null,t={},s=0,e=!1;this.manageAnimations=function(n){var t,i;r&&h.removeAllAnimations(),r=n,t=r instanceof Array&&r.length>0;if(t){i=r.length;while(i--&&t)t=r[i]instanceof ti}if(!t)throw"Must pass in a non-empty array of CssAnimationSequence objects";},this.addToGroup=function(i){var u,e;if(!i)return;if(!i[f]){u=+new Date;while(u in t)u++;i[f]=u}e=i[f],t[e]||(s++,t[e]={node:i,handler:n.addHandler(i,"animationsequenceprogress",l),remaining:r.length})},this.applyAllAnimations=function(){u(function(n){for(var i in t)n.applyAnimation(t[i].node)})},this.removeAllAnimations=function(){u(function(n){for(var i in t)o(i,n)})},this.removeAnimations=function(n){u(function(t){o(c(n),t)})},this.hasPendingAnimations=function(){return s>0}}var i=0;return t}(),ni=new function(){function d(){var n=null,r=k(),t=w.Properties.transform,i;if(t&&t in a){i=a[t];try{r.style[t]="matrix(1,0,0,1,0,0)",l=i.p,n=i.f}catch(u){}}"opacity"in r.style&&(y=!0),n==null&&"filter"in r.style&&(n=g,c.requireFlowLayout=!0,v=!0,c.usingIEFilters=!0),n==null&&(n=p),c.setTransformAndOpacity=n}function s(n){if(n.offsetZ){var i=n.invert(),t=3;while(t--)o[t]=i.transform(h[t]);return yt.conversion(o[0],o[1],o[2],h[0],h[1],h[2])}return n.m44==1?n:new yt(n.m11/n.m44,n.m12/n.m44,n.m21/n.m44,n.m22/n.m44,n.offsetX/n.m44,n.offsetY/n.m44)}function e(n){var t={};return t.position="absolute",t["white-space"]="nowrap",t["line-height"]="0",n&&(t.width=n.width.toFixed(0)+"px",t.height=n.height.toFixed(0)+"px"),t}function r(n){var t=[];for(styleKey in n)t.push(styleKey,":",n[styleKey],";");return t.join("")}function g(i,f,o,h){var w,b,a;h=h||{};var l=s(i),y=Math.round(l.m11*n)/n,tt=Math.round(l.m22*n)/n,nt=Math.round(l.m12*n)/n,g=Math.round(l.m21*n)/n,c=h.excludeCommonCss?{}:e(f),v=null,d,k;if(y==1&&nt==0&&g==0&&tt==1)d=l.offsetX.toFixed(0),k=l.offsetY.toFixed(0);else if(u.cssZoomAffectsTopLeft()||y!=tt||nt!=0||g!=0)w=Math.round(f.width/2),b=Math.round(f.height/2),d=-w,k=-b,a=yt.multiply(l,new yt(1,0,0,1,w,b)),v="progid:DXImageTransform.Microsoft.Matrix(FilterType=nearest,  M11="+a.m11.toFixed(t)+", M21="+a.m12.toFixed(t)+", M12="+a.m21.toFixed(t)+", M22="+a.m22.toFixed(t)+", dX="+a.offsetX.toFixed(0)+", dY="+a.offsetY.toFixed(0)+")";else{var p=Math.abs(y-1)>.02?Math.round(y*1e4)/1e4:1,it=l.invert(),rt=it.offsetX,ut=it.offsetY,d=-rt*p,k=-ut*p;p!=1&&(c.zoom=p)}return c.left=d+"px",c.top=k+"px",o<.01?c.display="none":(c.display="block",o<.99&&(v=(v==null?"":v+", ")+"alpha(opacity = "+(o*100).toFixed(0)+")")),v&&(c.filter=v),h.returnStyleObject?c:r(c)}function f(t,i,f,o){var h,v;o=o||{};var k=s(t),a=Math.round(k.m11*n)/n,y=Math.round(k.m22*n)/n,g=Math.round(k.m12*n)/n,d=Math.round(k.m21*n)/n,b=Math.round(k.offsetX*n)/n,p=Math.round(k.offsetY*n)/n,c=o.excludeCommonCss?{}:e(i);return a===1&&g===0&&d===0&&y===1?u.useTransform2d?(c[o.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",c[o.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate("+b+"px,"+p+"px)"):(c.left=b+"px",c.top=p+"px"):(i&&u.isIE9&&a&&y&&d===0&&Math.abs(a-y)<.01&&(h=a-1,v=y-1,h>.0102||h<-.009998||(h>.0079||h<-.0075?h>.009175||h<-.009086?(b+=i.width*h*-.05,p+=i.height*v*-.05,a+=h*.1,y+=v*.1):(a+=h*.17,y+=v*.17,h>0&&a<1.0100995||h<0&&a>.99?(b+=i.width*h*.5,p+=i.height*v*.5):(b+=i.width*h*-.09,p+=i.height*v*-.09)):(b+=i.width*h*.5,p+=i.height*v*.5,a+=h*.2,y+=v*.2))),c[o.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",c[o.returnStyleObject?w.Properties.transform:w.Attributes.transform]="matrix("+a+","+g+","+d+","+y+","+b+l+","+p+l+")"),f<.01?c.display="none":(f>.99||(c.opacity=f.toFixed(2)),c.display="block"),o.returnStyleObject?c:r(c)}function b(t,i,u,f){f=f||{};var s=f.excludeCommonCss?{}:e(i),o=t.m44,b=Math.round(t.m11*n/o)/n,p=Math.round(t.m12*n/o)/n,k=Math.round(t.m14*n/o)/n,g=Math.round(t.m21*n/o)/n,d=Math.round(t.m22*n/o)/n,y=Math.round(t.m24*n/o)/n,c=Math.round(t.m31*n/o)/n,h=Math.round(t.m32*n/o)/n,l=Math.round(t.m34*n/o)/n,v=Math.round(t.offsetX/o),a=Math.round(t.offsetY/o);return b===1&&p===0&&k===0&&g===0&&d===1&&y===0&&c===0&&h===0&&l===0?(s[f.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",s[f.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate3d("+v+"px,"+a+"px,0px)"):(s[f.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",s[f.returnStyleObject?w.Properties.transform:w.Attributes.transform]="matrix3d("+b+","+p+",0,"+k+","+g+","+d+",0,"+y+","+c+","+h+",1,"+l+","+v+","+a+",0,1)"),u>=.01||f.explicitOpacity?((u<=.99||f.explicitOpacity)&&(s.opacity=u.toFixed(2)),s.display="block"):s.display="none",f.returnStyleObject?s:r(s)}function p(n,t,i,u){u=u||{};var o=s(n).invert(),f=u.excludeCommonCss?{}:e(t);return f.left=(-o.offsetX).toFixed(0)+"px",f.top=(-o.offsetY).toFixed(0)+"px",f.display=i>.1?"block":"none",u.returnStyleObject?f:r(f)}var c=this,a={transform:{p:"",f:f},msTransform:{p:"",f:f},webkitTransform:{p:"",f:u.useTransform3d?b:f},MozTransform:{p:"px",f:f},OTransform:{p:"",f:f}},l,t=6,n=Math.pow(10,t),h=[new i(0,0),new i(128,128),new i(-128,128)],o=[],y=!1,v=!1;this.setExactTransformOrHide=function(n,t,i,f){var o,h,l,c;return f=f||{},o=f.excludeCommonCss?{}:e(t),h=s(n).invert(),Math.abs(h.m11-1)<bt&&Math.abs(h.m12-0)<bt&&Math.abs(h.m21-0)<bt&&Math.abs(h.m22-1)<bt&&i>=.01?(l=-Math.round(h.offsetX)+"px",c=-Math.round(h.offsetY)+"px",o.display="block",u.useTransform3dForTranslate?o[f.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate3d("+l+","+c+",0px)":u.useTransform2d?o[f.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate("+l+","+c+")":(o.left=l,o.top=c),i>.99||(y?o.opacity=i.toFixed(2):v&&(o.filter="alpha(opacity = "+(i*100).toFixed(0)+")"))):o.display="none",f.returnStyleObject?o:r(o)},d()},bi=new function(){function p(){for(var e,h,u,s=0;s<i.length;s++){for(e=i[s],h=0;h<e.length;h++){var l=e[h],o=l.url,y=a.getState(o);switch(y){case st.none:case st.timedout:case st.cacheExpired:c<t.maxConcurrentTileDownloads&&(l.basket=e,f[o]||(c++,u=k("img"),f[o]=u,u[r]=l,u.onload=g,u.onerror=v,u.onabort=v,u[d]=window.setTimeout(function(){var n=u;return function(){nt.call(n)}}(),l.timeout),u.src=o));break;case st.downloading:break;default:e.hasNewTiles=!0}}e.hasNewTiles&&(n.invoke(e,"hasnewtiles"),e.hasNewTiles=!1)}}function g(){if(!this[e]){var n=this[r].url;o(this,n),w.insert(n,!0),l.insert(n,this)}}function v(){if(!this[e]){var n=this[r].url;o(this,n),u.useImageDisposer&&(this.src=t.spacerImageUrl),s.insert(n,st.failed)}}function nt(){if(!this[e]){var n=this[r].url;o(this,n),u.useImageDisposer&&(this.src=t.spacerImageUrl),s.insert(n,st.timedout)}}function o(n,t){var o,i,u;n[e]=!0,n.onload=null,n.onerror=null,n.onabort=null,window.clearTimeout(n[d]),o=n[r],i=o.basket,i.hasNewTiles=!0,u=i.length;while(u--)i[u]===o&&i.splice(u,1);c--,delete f[t],b.dispatch(p,-10)}var a=this,i=[],c=0,f={},l=new yi(50),s=new yi(30),w=new yi(200);u.useImageDisposer&&l.useDisposer(function(n){n&&n.src&&(n.src=t.spacerImageUrl)});var r=y+"downloadRequest",d=y+"timeoutid",e=y+"processed";this.getState=function(n){if(l.get(n))return st.ready;if(w.get(n))return st.cacheExpired;var t=s.get(n);return t!==h?t:f[n]?st.downloading:st.none},this.setDownloadBasket=function(n,t){a.removeDownloadBasket(n.basketId),n.length>0&&(t?i.push(n):i.unshift(n),b.dispatch(p,-10))},this.removeDownloadBasket=function(n){for(var t=0;t<i.length;)i[t].basketId===n?i.splice(t,1):t++}},st={none:0,downloading:1,ready:2,failed:3,timedout:4,cacheExpired:5};kt.createQuadKeyTilePyramid=function(n,i,r,u,f,e){var o=Math.pow(2,t.maxMercatorZoom);return new kt(n*o,i*o,n,i,0,0,0,0,kt.createMercatorQuadKeyUrlRetriever(r,n,u,f),kt.createQuadkeyTileReplacementHandler(),e)},kt.createMercatorQuadKeyUrlRetriever=function(n,i,r,u){return kt.createQuadKeyUrlRetriever(n,u,i,r,t.minMercatorZoom,t.maxMercatorZoom)},kt.createQuadKeyUrlRetriever=function(n,t,i,r,u,f,e){var l=c.ceilLog2(i),h,o,s;return typeof n=="string"?(h=n,o=t?t:h):s=n,function(n,t){var v=n.levelOfDetail-l,i,c,a;if(v>=u&&v<=f){i=new rt(v,n.x,n.y),r&et.horizontal&&(i=hi.wrapX(i)),r&et.vertical&&(i=hi.wrapY(i));if(hi.isInBounds(i)){if(s)return s(i);if(i.levelOfDetail===0)if(e)c=hi.fromTileId(i,!0),a=e;else return null;else c=hi.fromTileId(i,!1),a=c.charAt(c.length-1);return t?o.replace("{quadkey}",c).replace("{subdomain}",a):h.replace("{quadkey}",c).replace("{subdomain}",a)}}return null}},kt.createQuadkeyTileReplacementHandler=function(){var n=new yi(200);return function(t){var e=t.toString(),i=n[e],f,u,r;if(i){f=i.toString();while(n[f])i=n[f],f=i.toString();u=n[e],r=u.toString();while(n[r])u=n[r],n[r]=i,r=u.toString()}else i=t.getParent(),n[e]=i;return i}},et={none:0,horizontal:1,vertical:2},l.TilePyramid=kt,l.TilePyramidWrapMethod=et,rr.getBestLevelOfDetail=function(n,t,i){var r,f,u;return r=t.getMaxLevelOfDetail()-c.log2(t.getWidth()/t.projectingCamera.getWidth()/(n.getZoomOriginWidth()/n.getWidth())),f=Math.ceil(r),u=Math.floor(r),f!=u&&(i&&(r=r+i),r=Math.round(r),r=Math.min(f,Math.max(u,r))),r=Math.min(r,t.getMaxLevelOfDetail())},l.TileRenderer=iu,oi=new function(){function n(){s()?(i=1,r=!0,f=!0):h()?(i=2,r=!1,f=!0):o()&&(i=3,r=!0,f=!1),n=function(){}}function s(){var n=!1,t;return document.implementation&&document.implementation.hasFeature?n=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"):document.createElementNS&&(t=document.createElementNS(ns,"svg"),n=typeof t.createSVGRect!="undefined"),s=function(){return n},n}function h(){var t=document.createElement("v:shape"),n;return t.style.behavior="url(#default#VML)",n=typeof t.strokecolor!="undefined",h=function(){return n},n}function o(){var t=document.createElement("canvas"),n=t.getContext&&t.getContext("2d")!==null;return o=function(){return n},n}function e(n){function t(n){this._surface=n,this._paths=[]}return t.prototype={setSize:function(n,t){this._width=n,this._height=t},createPath:function(){},renderPath:function(){},removePath:function(n){var t=this._paths.length;while(t--)if(this._paths[t]===n){this._surface.removeChild(n.nativeShape),this._paths.splice(t,1);break}},clear:function(){var n=this._paths.length;while(n--)this._surface.removeChild(this._paths[n].nativeShape);this._paths=[]}},new t(n)}function a(n){function i(){}function r(){function n(){var r=this,n=document.createElement("v:shape"),t,i;n.style.position="absolute",t=document.createElement("v:stroke"),n.appendChild(t),i=document.createElement("v:fill"),n.appendChild(i),this._stroke=t,this._fill=i,this._initialize(n)}return n.prototype=t,n.prototype.stroke=function(){this.data==null||this.data.length&&this.data.charAt(this.data.length-1)==="E"||(this.data+="E");var n=this.nativeShape;n.strokecolor=this.strokeStyle,n.strokeweight=this.lineWidth+"pt",this.lineCap&&(this._stroke.endcap=this.lineCap.toLowerCase()==="butt"?"flat":path.lineCap,this._stroke.dashstyle=this.dashArray,this._stroke.opacity=this.strokeOpacity),this.fillStyle&&this.fillStyle!=="none"?(this._fill.color=this.fillStyle,this._fill.opacity=this.fillOpacity*100+"%"):n.filled=!1,n.path=this.data},new n}return i.prototype=new e(n),i.prototype.createPath=function(){return new r},i.prototype.renderPath=function(n){var i="url(#default#VML)",r=this._height!=null?this._height:this._surface.offsetHeight,u=this._width!=null?this._width:this._surface.offsetWidth,t=n.nativeShape;this._surface.appendChild(t),t.style.height=r+"px",t.style.width=u+"px",t.style.behavior=i,t.coordsize=u+","+r,n._stroke.style.behavior=i,n._fill.style.behavior=i,this._paths.push(n)},new i}function l(n){function r(){}function o(){function n(){var t=this,n=document.createElementNS(f,"path");n.style.pointerEvents="visiblePainted",this._initialize(n)}return n.prototype=t,n.prototype.stroke=function(){var n=this.nativeShape;n.setAttribute("stroke",this.strokeStyle),n.setAttribute("stroke-width",this.lineWidth),n.setAttribute("stroke-linecap",this.lineCap),n.setAttribute("stroke-dasharray",this.dashArray),n.setAttribute("fill",this.fillStyle),n.setAttribute("fill-opacity",this.fillOpacity),n.setAttribute("fill-rule","evenodd"),n.setAttribute("stroke-opacity",this.strokeOpacity),n.setAttribute("d",this.data)},new n}var f="http://www.w3.org/2000/svg",i=document.createElementNS(f,"svg");return u.safariRenderHack&&(i.style.cssText=u.safariRenderHack),i.setAttribute("width","100%"),i.setAttribute("height","100%"),n.appendChild(i),r.prototype=new e(i),r.prototype.createPath=function(){return new o},r.prototype.renderPath=function(n){var t=n.nativeShape;this._surface.appendChild(t),this._paths.push(n)},new r(n)}function c(n){function i(){}function r(i,r){function u(){var f=this,t=document.createElement("canvas"),u;t.style.cssText="position:absolute;",n.appendChild(t),u=t.getContext("2d"),u.beginPath(),this.context=u,this._initialize(t),this.setSize(i,r)}function o(n,t){if(n.length==7){var i=/^#(\w{2})(\w{2})(\w{2})$/.exec(n);return"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+","+t+")"}return""}var e,f;return u.prototype=t,u.prototype.setSize=function(n,t){e=n,f=t,this.nativeShape.setAttribute("width",e),this.nativeShape.setAttribute("height",f)},u.prototype.beginPath=function(){this.context.beginPath()},u.prototype.moveTo=function(n,t){this.context.moveTo(n,t)},u.prototype.lineTo=function(n,t){this.context.lineTo(n,t)},u.prototype.curveTo=function(n,t,i,r,u,f){this.context.bezierCurveTo(n,t,i,r,u,f)},u.prototype.stroke=function(){var n=this.context;n.clearRect(0,0,e,f),this.fillStyle&&this.fillStyle!=="none"&&(n.fillStyle=o(this.fillStyle,this.fillOpacity),n.fill()),n.strokeStyle=o(this.strokeStyle,this.strokeOpacity),n.lineWidth=this.lineWidth,n.stroke(),this.drawn=!0},new u}return i.prototype=new e(n),i.prototype.setSize=function(n,t){if(this._width!==n||this._height!==t){this._width=n,this._height=t;var i=this._paths.length;while(i--)this._paths[i].setSize(n,t)}},i.prototype.createPath=function(){var t=this._height?this._height:this._surface.offsetHeight,n=this._width?this._width:this._surface.offsetWidth;return new r(n,t)},i.prototype.renderPath=function(n){var t=n.nativeShape;this._surface.appendChild(t),this._paths.push(n)},new i(n)}var r,f,i,t;this.isClipped=function(){return n(),r},this.isEventsSupported=function(){return n(),f},this.getContext=function(t){if(!t.harmonyContext){n();var r;switch(i){case 1:r=new l(t);break;case 2:r=new a(t);break;case 3:r=new c(t)}t.harmonyContext=r}return t.harmonyContext},this.destroyContext=function(n){n.harmonyContext&&(n.harmonyContext.clear(),n.harmonyContext=null)},t={nativeShape:null,_events:null,id:null,data:"",strokeStyle:"#000",strokeOpacity:"1",dashArray:"solid",fillStyle:"#000",fillOpacity:"1",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"#000000ff",beginPath:function(){this.data=""},moveTo:function(n,t){this.data+="M"+Math.round(n)+","+Math.round(t)+" "},lineTo:function(n,t){this.data+="L"+Math.round(n)+","+Math.round(t)+" "},curveTo:function(n,t,i,r,u,f){this.data+="C"+Math.round(n)+","+Math.round(t)+" "+Math.round(i)+","+Math.round(r)+" "+Math.round(u)+","+Math.round(f)+" "},stroke:function(){},onMouseDown:function(n){this._events.mousedown.push(n)},onMouseUp:function(n){this._events.mouseup.push(n)},onClick:function(n){this._events.click.push(n)},onMouseMove:function(n){this._events.mousemove.push(n)},onMouseOver:function(n){this._events.mouseover.push(n)},onMouseOut:function(n){this._events.mouseout.push(n)},_dispatchEvent:function(n,t){var i=this._events[n].length;while(i--)this._events[n][i].call(this,t)},_initialize:function(n){function i(n){n=n||window.event,t._dispatchEvent(n.type,n)}var t=this;t._events={mousedown:[],mouseup:[],mousemove:[],mouseover:[],mouseout:[],click:[]},n.onmousedown=n.onmouseup=n.onclick=n.onmousemove=n.onmouseover=n.onmouseout=i,this.nativeShape=n}}},l.Harmony=oi,er.ensureVmlNamespace=function(){er.ensureVmlNamespace=function(){};try{document.namespaces&&document.namespaces.add&&document.namespaces.add("v","urn:schemas-microsoft-com:vml")}catch(n){}},l.CompositeModeEntityRenderer=er,new function(){var n=[],t=[],i=function(i,r){var u=null,f;if(r instanceof gi||r instanceof tr){f=n.length;while(f--)n[f]===i&&(u=t[f]);u||(u=new bu(i),n.push(i),t.push(u))}return u};vt.registerEntityRenderer(i)},du=new function(){function r(t,r){var c=r.userData,o=null,l,e,f,s,u,a;if(r&&r.success&&t&&t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&t.resourceSets[0].resources[0].imageryProviders){o=[],l=t.resourceSets[0].resources[0].imageryProviders,u=l.length;while(u--){var v=l[u],h=v.coverageAreas,p={attribution:v.attribution,coverageAreas:[]},y=h?h.length:0;while(y--)e=h[y],f=e.bbox,p.coverageAreas.push({zoomMax:e.zoomMax,zoomMin:e.zoomMin,boundingBox:ct.fromEdges(f[2],f[1],f[0],f[3])});o.push(p)}i[c]=o}s=n[c],delete n[c],u=s.length;while(u--)a=s[u],a.callback(o,a.userData)}var i={},n={};this.getCachedImageryProviders=function(n){return i[n]},this.getImageryProviders=function(u,f,e,o){if(i[u])e(i[u],o);else if(n[u])n[u].push({callback:e,userData:o});else if(t.imageryMetadataUrl){n[u]=[],n[u].push({callback:e,userData:o});var s=t.imageryMetadataUrl.replace(/{imagerySet}/,u).replace(/{credentials}/,f);ei.getObjectAsync(s,r,u)}else e(null,o)}},ru=new function(){function u(t,i){var u,e,o,f;i&&i.success&&t&&t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&t.resourceSets[0].resources[0].imageryProviders&&(u=i.userData,e=t.resourceSets[0].resources[0],r=e.displayCombinedLogo,o=[ii.defaultCopyright.text].concat(e.imageryProviders),n[u]&&(f=n[u].callback,delete n[u],n[u]=null,f&&f(o,r)))}var i=0,n=[],r=!1;this.getCopyrights=function(f,e,o,s,h,c){if(f&&e&&o&&h&&c){var l=t.imageryCopyrightUrl.replace(/{imagerySet}/,f).replace(/{zoom}/,parseInt(o)).replace(/{minLat}/,e.getSouth()).replace(/{minLon}/,e.getWest()).replace(/{maxLat}/,e.getNorth()).replace(/{maxLon}/,e.getEast()).replace(/{heading}/,parseInt(s)).replace(/{credentials}/,h);n[i]={callback:c},ei.getObjectAsync(l,u,i),i=++i%10}else c([ii.defaultCopyright.text],r)}},l.ModeEventHandler=su,l.ModeEventHandlerComposite=eu,hu=new function(){function n(n,u,f,e,o,s){var h=kt.createQuadKeyTilePyramid(r,i,u,f,s);return h.projectingCamera=n,new ht(n.getAlignedCamera(t.minMercatorZoom),h,t.maxMercatorZoom-t.minMercatorZoom,"EnhancedBirdseye",e)}var u=this,r=256,i=180;this.createContributor=function(t){var s=t.credentialsProvider,r=t.urlFormat,f=t.urlWithLabelsFormat,o=new fi("Synth",s),e=new fi("SynthWithLabels",s),u={},i;return i={},u[tt.northUpHeading]=i,i[it.hidden]=n(ut.enhancedBirdseyeNorthUp,r.replace("{dir}","dir_n"),et.horizontal,o),i[it.visible]=n(ut.enhancedBirdseyeNorthUp,f.replace("{dir}","dir_n"),et.horizontal,e,r.replace("{dir}","dir_n")),i={},u[tt.westUpHeading]=i,i[it.hidden]=n(ut.enhancedBirdseyeWestUp,r.replace("{dir}","dir_w"),et.vertical,o),i[it.visible]=n(ut.enhancedBirdseyeWestUp,f.replace("{dir}","dir_w"),et.vertical,e,r.replace("{dir}","dir_w")),i={},u[tt.southUpHeading]=i,i[it.hidden]=n(ut.enhancedBirdseyeSouthUp,r.replace("{dir}","dir_s"),et.horizontal,o),i[it.visible]=n(ut.enhancedBirdseyeSouthUp,f.replace("{dir}","dir_s"),et.horizontal,e,r.replace("{dir}","dir_s")),i={},u[tt.eastUpHeading]=i,i[it.hidden]=n(ut.enhancedBirdseyeEastUp,r.replace("{dir}","dir_e"),et.vertical,o),i[it.visible]=n(ut.enhancedBirdseyeEastUp,f.replace("{dir}","dir_e"),et.vertical,e,r.replace("{dir}","dir_e")),{priority:30,minZoomLevel:0,getScene:function(n,t,i,r,f,e){return r>this.minZoomLevel?u[tt.snapToCardinalHeading(f)][e]:null}}}},wt.mercator="m",wt.auto="auto",t.allowOrdnanceSurvey&&(wt.ordnanceSurvey="os"),t.allowCollinsBart&&(wt.collinsBart="cb"),n.addHandler(or,"mapcreationstart",function(n){var u=n.map,s=n.options,r=s&&s.credentials?function(n){return n.replace(/{key}/,s.credentials)}:function(n){return n},f=u.getCredentials,i=new vt,ut=ht.createMercatorScene(r(t.roadUriFormat),"Road",new fi("Road",f),r(t.roadUnlabeledUriFormat)),o={priority:10,getScene:function(){return ut}},a={},w,b,tt,v,nt,y,h,p,l,g,k;a[it.hidden]=ht.createMercatorScene(r(t.aerialUriFormat),"Aerial",new fi("Aerial",f)),a[it.visible]=ht.createMercatorScene(r(t.aerialWithLabelsUriFormat),"Aerial",new fi("AerialWithLabels",f),r(t.aerialUriFormat));var e={priority:20,maxZoomLevel:4.5,getScene:function(n,t,i,r,u,f){return r<this.maxZoomLevel?a[f]:null}},c=hu.createContributor({credentialsProvider:f,urlFormat:r(t.enhancedBirdseyeUriFormat),urlWithLabelsFormat:r(t.enhancedBirdseyeWithLabelsUriFormat)}),d=new yu({credentialsProvider:f,urlFormat:r(t.nativeBirdseyeUriFormat),urlWithLabelsFormat:r(t.nativeBirdseyeWithLabelsUriFormat)}),rt=new ci(wt.mercator,i);rt.activated=function(){i.setSceneContributors([])},w=new ci(wt.road,i),w.activated=function(){i.setSceneContributors([o])},b=new ci(wt.aerial,i),b.activated=function(){e.maxZoomLevel=1e3,i.setSceneContributors([e])},t.allowCollinsBart&&(tt=new fu(ht.createMercatorScene(r(t.collinsBartUriFormat),"CollinsBart",new fi("CollinsBart",f)),t.collinsBartMinZoom-.5,t.collinsBartMaxZoom+.5,t.collinsBartBounds,15),v=new ci(wt.collinsBart,i),v.activated=function(){i.setSceneContributors([o,tt])},u.registerMapType(v)),t.allowOrdnanceSurvey&&(nt=new fu(ht.createMercatorScene(r(t.ordnanceSurveyUriFormat),"OrdnanceSurvey",new fi("OrdnanceSurvey",f)),t.ordnanceSurveyMinZoom-.5,t.ordnanceSurveyMaxZoom+.5,t.ordnanceSurveyBounds,15),y=new ci(wt.ordnanceSurvey,i),y.activated=function(){i.setSceneContributors([o,nt])},u.registerMapType(y)),h=new ci(wt.auto,i),h.activated=s.disableBirdseye!==!0&&t.defaultAerialTiltOn===!0?function(){e.maxZoomLevel=4.5,c.minZoomLevel=16.5,i.setSceneContributors([o,e,c,d])}:function(){var n={priority:20,maxZoomLevelBand1:4.5,minZoomLevelBand2:16.5,getScene:function(n,t,i,r,u,f){return r<this.maxZoomLevelBand1||r>this.minZoomLevelBand2?a[f]:null}};i.setSceneContributors([n,o])},p=new ci(wt.birdseye,i),p.activated=function(){s.disableBirdseye!==!0?(e.maxZoomLevel=1e3,c.minZoomLevel=12.5,i.setSceneContributors([e,c,d])):(e.maxZoomLevel=1e3,i.setSceneContributors([e]))},u.registerMapType(rt),u.registerMapType(h),u.registerMapType(w),u.registerMapType(b),u.registerMapType(p),l={},l[it.hidden]=ht.createMercatorScene(r(t.fbUnlabeledUriFormat),"Road",new fi("Road",f)),l[it.visible]=ht.createMercatorScene(r(t.fbUriFormat),"Road",new fi("Road",f),r(t.fbUnlabeledUriFormat)),g={priority:10,getScene:function(n,t,i,r,u,f){return l[f]}},k=new ci("fb",i),k.activated=function(){i.setSceneContributors([g])},u.registerMapType(k)}),delete window[$MapsNamespace].Maps.initMapCode,PRF.end("Map core initialized","mapcore"),hr=t.onloadcallback,hr&&typeof window[hr]=="function"&&window[hr].apply()},window[$MapsNamespace].Maps.Globals&&window[$MapsNamespace].Maps.initMapCode&&window[$MapsNamespace].Maps.initMapCode()